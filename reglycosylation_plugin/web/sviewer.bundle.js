!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=14)}([function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var n=r(1),i=r(4);function a(){this.clear()}a.prototype={toString:function(){return"[object MixedTupleMap]"},_hash:function(e){if(e===this._lastTuple)return this._lastHash;for(var t=e.length,r=[],n=[],i=[],a=0;a<t;a++){var o=e[a],s=typeof o;null===s||"object"!==s&&"function"!==s?(r.push("string"===s?'"'+o+'"':""+o),n.push(a)):i.push(a)}if(0===i.length)throw new Error("Tuple must have at least one non-primitive part");return r.push("["+i.concat(n).join()+"]"),this._lastTuple=e,this._lastHash={nonPrimOrder:i,primHash:r.join("/<[MI_SEP]>/")},this._lastHash},has:function(e){for(var t=this._cache,r=this._hash(e),n=r.nonPrimOrder.length,i=0;i<n;i++){var a=e[r.nonPrimOrder[i]];if(!t.has||!t.has(a))return!1;t=t.get(a)}return!!t.has&&t.has(r.primHash)},set:function(e,t){for(var r=this._cache,n=this._hash(e),i=n.nonPrimOrder.length,a=!1,o=0;o<i;o++){var s=e[n.nonPrimOrder[o]];!a&&r.has(s)?r=r.get(s):(a=!0,r.set(s,r=o<i-1?new WeakMap:new Map))}return r.set(n.primHash,t),this},get:function(e){for(var t=this._cache,r=this._hash(e),n=r.nonPrimOrder.length,i=0;i<n;i++){var a=e[r.nonPrimOrder[i]],o=t.get&&t.get(a);if(void 0===o)return o;t=o}return t.get&&t.get(r.primHash)},clear:function(){this._cache=new WeakMap,delete this._lastTuple,delete this._lastHash}};var o=a,s=Symbol("template_sugar"),l=Symbol("last_residue"),c=Symbol("min_repeats"),h=Symbol("max_repeats"),d=Symbol("identifier"),u=Symbol("active_mode"),f=Symbol("MODE_EXPAND"),p=Symbol("MODE_MINIMAL"),g=Symbol("parent"),v=Symbol("sort_order"),m=Symbol("child_residue"),y=Symbol("repeat"),b=Symbol("counter"),w=new o,x={};class _{constructor(){}static get(e){return x[e]||(x[e]=new _),x[e]}}var k,O=(e,t,r,n,i)=>{var a=[t,_.get(i),r];return w.has(a)||w.set(a,new e(r,n,t,i)),w.get(a)},S=(e,t)=>{Object.defineProperty(e,"parent",{configurable:!0,enumerable:!0,get:()=>{var e=t.mode===f?t.max:t.mode===p?t.min:1;return O(t.constructor.Monosaccharide,t,t[l],null,e)}})};class M extends i.a{constructor(e,t,r,n){return super(e),this[g]=t,this[y]=r,this[b]=n,this}static is_wrapped(e){return e instanceof M}static is_not_wrapped(e){return!M.is_wrapped(e)}clone(){var e=new this.constructor(this.original,this[g],this[y].clone(),this[b]);return e.copyTagsFrom(this),e}get repeat(){return this[y]}get counter(){return this[b]}balance(){var e=this.children.map(e=>({link:this.linkageOf(e),res:e}));e.sort((e,t)=>e.link-t.link);var t=e.map(e=>e.res);(t=Object.freeze(Object(n.a)(t))).forEach((e,t)=>{e[v]=t+1})}addChild(e,t){if(this.repeat.mode===f&&(!this.endsRepeatUnit||this.counter<this.repeat.max))return super.addChild(e,t);this.repeat[m].children.indexOf(t)<0&&(this.repeat[m].addChild(e,t),S(t,this.repeat))}donateChildrenTo(e){if(this.counter===this.repeat.max&&this.endsRepeatUnit)for(var t of this.repeat.children)delete t.parent,e.graft(t);else k(this,e)}replaceChild(e,t,r){return this.repeat.mode===f?super.replaceChild(e,t,r):e instanceof M?(this.repeat[l]===e.original&&(this.repeat[l]=t),this.original.replaceChild(e.original,t,r)):super.replaceChild(e,t,r)}removeChild(e,t){if(this.repeat.mode===f){if(this.endsRepeatUnit&&this.counter===this.repeat.max)return this.repeat[m].removeChild(e,t);if(t instanceof M){for(var r=this;r&&r instanceof M&&!r.endsRepeatUnit;)r=r.parent;var n=new(0,this.original.constructor)("temp_root"),i=k(r,n,t);i.get(this)||i.set(this,this);var a=i.get(this);if(a!==this&&(this.balance=()=>a.balance(),a.renderer=this.renderer),r instanceof M)r.repeat.max=r.counter,r.repeat.children=[...n.children];else{for(var o of r.children.filter(e=>e instanceof M))r.removeChild(r.linkageOf(o),o);for(var s of n.children)r.graft(s)}return a}return super.removeChild(e,t)}if(this.repeat.mode===p){if(t instanceof M)return t.endsRepeatUnit?(t.original.parent.removeChild(t.original.parent.linkageOf(t.original),t.original),void t.repeat.root.parent.replaceChild(t.repeat.root,t.repeat.root.original)):void t.original.parent.removeChild(t.original.parent.linkageOf(t.original),t.original);if(this.repeat.children.indexOf(t)>=0)return this.repeat[m].removeChild(e,t),void delete t.parent;throw new Error("REPEAT_UNREACHABLE")}if(!this.endsRepeatUnit)throw new Error("Removing a child that isnt at the end of a repeat")}get endsRepeatUnit(){return this.original===this.repeat[l]}get parent(){return this[g]?this[g]:super.parent}linkageOf(e){return e instanceof M&&e.repeat===this.repeat?this.endsRepeatUnit&&e.repeat===this.repeat&&e.counter!==this.counter&&e.original===this.repeat.root.original?this.repeat.root.parent.linkageOf(this.repeat.root):this.original.linkageOf(e.original):this.endsRepeatUnit&&this.repeat.children.indexOf(e)>=0?this.repeat[m].linkageOf(e):new n.b(" ").linkageOf.call(this,e)}get child_linkages(){var e=super.child_linkages,t=new Map;for(var r of e.keys()){for(var n of e.get(r).filter(M.is_wrapped)){var i=n.original.parent.linkageOf(n.original);t.set(i,(t.get(i)||[]).concat(n))}for(var a of e.get(r).filter(M.is_not_wrapped))t.set(r,(t.get(r)||[]).concat(a))}return t}get children(){var e=this.repeat.mode===f?this.repeat.max:this.repeat.mode===p?this.repeat.min:1,t=this.original.children,r=super.children,n=[];this.repeat.mode===p&&(r=[]),this.endsRepeatUnit&&this.counter>=e&&(n=this.repeat.children);var i=[];this.endsRepeatUnit&&this.counter<e&&i.push(O(this.constructor,this.repeat,this.repeat.root.original,this,this.counter+1));var a=t.map(e=>O(this.constructor,this.repeat,e,this,this.counter)),o=Object.freeze([r,n,i].reduce((e,t)=>e.concat(t),a));return o.length>0&&o.every(e=>e[v])?Object.freeze(o.slice().sort((e,t)=>e[v]-t[v])):o}}k=(e,t,r)=>{var n=e.children.filter(e=>e!==r),i=new Map;for(var a of(n.forEach(((e,t)=>{var r=t.parent,n=r.linkageOf(t),a=t instanceof M?t.original.clone():t;r instanceof M&&r.repeat[m].children.indexOf(t)>=0&&(r.repeat[m].removeChild(n,t),delete t.parent),i.set(t,a),e.children.indexOf(a)<0&&e.addChild(n,a)}).bind(null,t)),n))i=new Map([...i,...k(a,i.get(a),r)]);return i};class C{constructor(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this[s]=e;var a=e.leaves()[0];if("Root"===e.root.identifier&&(e.root=e.root.children[0]),this[l]=a,t)this[l]="string"!=typeof t||t instanceof n.b?t:e.locate_monosaccharide(t);else if(1!==e.leaves.length)throw new Error("Too many leaves on repeat without defined attachment site");"string"!=typeof t&&(t=e.location_for_monosaccharide(this[l])),this[c]=r,this[h]=i,this[m]=new n.b("Root")}clone(){var e=new this.constructor(this[s],this[l],this.min,this.max);return e.identifier=this.identifier,this.mode&&(e.mode=this.mode),e}get off_main(){return this[l]!==this[s].leaves()[0]}static get Monosaccharide(){return M}static addToSugar(e,t,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;t instanceof n.b||"string"!=typeof t||(t=e.locate_monosaccharide(t)),r instanceof n.b||"string"!=typeof r||(r=e.locate_monosaccharide(r));var s=new n.b("Root");for(var l of r.children)s.graft(l);var c=t.parent,h=c.linkageOf(t);if(c.removeChild(h,t),c instanceof M){var d=t.clone();for(var u of t.children)d.graft(u);t=d}var f=new e.constructor;f.root=new n.b("Root"),f.root.addChild(h,t);var p=new C(f,r,a,o);for(var g of(p.mode=i,s.children))p[m].graft(g),S(g,p);return c.addChild(h,p.root),p}static get MODE_EXPAND(){return f}static get MODE_MINIMAL(){return p}get template(){return this[s]}get root(){var e=O(M,this,this[s].root,null,this.min);if(this[s].root.parent&&!e.parent){var t=this[s].root.parent.linkageOf(this[s].root),r=this[s].root.parent.clone();r.removeChild(t,this[s].root),r.addChild(t,e)}return e}get attachment(){return this.template.location_for_monosaccharide(this[l])}get identifier(){return this[d]||""}set identifier(e){this[d]=e}get mode(){return this[u]}set mode(e){if([p,f].indexOf(e)<0)throw new Error("Invalid mode");this[u]=e}get min(){return this[c]}get max(){return this[h]}set max(e){this[h]=e}get children(){return this[m].children}set children(e){var t=this[m];for(var r of t.children.filter(t=>e.indexOf(t)<0))t.removeChild(t.linkageOf(r),r);for(var n of e.filter(e=>t.children.indexOf(e)<0))n.parent?t.graft(n):t.addChild(0,n),S(n,this)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return y}));var n={O:-100,N:-200},i=Symbol("anomer"),a=Symbol("identifier"),o=Symbol("parent_linkage"),s=Symbol("parent"),l=Symbol("unknown_count"),c=(e,t,r)=>r.indexOf(e)===t,h=function(e){return 0==e.children.length?[e]:Array.prototype.concat.apply([],e.children.map(h))},d=function(e,t){for(var r=[t];e.indexOf(r[0])<0;)r.unshift(r[0].parent);return r},u=function(e,t){return e.parent.linkageOf(e)!==t.parent.linkageOf(t)?e.parent.linkageOf(e)-t.parent.linkageOf(t):e.identifier!==t.identifier?e.identifier.toUpperCase()<t.identifier.toUpperCase()?-1:1:0},f=function(e,t){for(var r=[].concat(e),n=[].concat(t);r.length>0&&n.length>0;){var i=r.shift(),a=n.shift(),o=u(i,a);if(o)return o}return-1*(r.length-n.length)},p=function(e){var t=[];for(var r of e)t=t.concat(h(r));return t.map(d.bind(null,e)).sort(f).map(e=>e[0]).filter(c)},g=new WeakMap,v=new WeakMap,m=new WeakMap;class y{static get LINKAGES(){return n}constructor(e){if(!e)throw new Error("Missing identifier");this[a]=e}get depth(){for(var e=this,t=1;e.parent;)t++,e=e.parent;return t}get identifier(){return this[a]}get anomer(){return this[i]}set anomer(e){this[i]=e}get parent_linkage(){return this[o]}set parent_linkage(e){this[o]=e}get parent(){return this[s]}get children(){return Object.freeze([].concat(v.get(this)||[]))}get child_linkages(){var e=new Map;return this.children.forEach(t=>{var r=g.get(t),n=r;r>100&&(n=0);var i=e.get(n);i||(i=[],e.set(n,i)),i.push(t)}),e}get siblings(){var e=this;return this.parent?this.parent.children.filter(t=>t!==e):[]}balance(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(Object.isFrozen(this))throw new TypeError("Cannot balance child ordering of frozen monosaccharide");var t=p(this.children);this[l]=0;var r=0;for(var n of t)g.get(n)>100&&(r+=1,g.set(n,101+r));this[l]=r,v.set(this,t);var i=this;if(e)for(;i&&i.parent;){var a=i.parent.linkageOf(i);i.parent.child_linkages.get(a).length>0&&i.parent.balance(!1),i=i.parent}}addChild(e,t){if(Object.isFrozen(this)||Object.isFrozen(t))throw new TypeError("Cannot add child on frozen monosaccharide");if("number"!=typeof e)throw new Error("Linkage must be number");if(e>100)throw new Error("Cannot set defined linkage greater than ".concat(100));if(0==e){this[l]=this[l]||0;var r=this[l];this[l]=r+1,e=101+r}var n=0;for(var i of this.children){if(!(g.get(i)<=e))break;n+=1}g.set(t,e);var a=v.get(this)||[];a.splice(n,0,t),v.set(this,a),t[s]=this}removeChild(e,t){if(Object.isFrozen(this))throw new TypeError("Cannot remove child on frozen monosaccharide");var r=v.get(this),n=t=>{r.splice(r.indexOf(t),1),g.delete(t),t[s]=null,0==e&&(this[l]-=1)},i=e=>!t||e===t;for(var[a,o]of this.child_linkages)e==a&&o.filter(i).forEach(n)}donateChildrenTo(e){if(Object.isFrozen(this)||Object.isFrozen(e))throw new TypeError("Cannot adopt children on frozen monosaccharide");for(var[,t]of this.child_linkages)for(var r of t)e.graft(r)}replaceChild(e,t,r){if(Object.isFrozen(this)||Object.isFrozen(t)||Object.isFrozen(e))throw new TypeError("Cannot replace child on frozen monosaccharide");var n=this.linkageOf(e),i=e.parent_linkage,a=e.anomer,o=this.removeChild(n,e),s=o||this;t.parent_linkage=i,t.anomer=a,void 0!==r?s.addChild(r,t):s.addChild(n,t)}linkageOf(e){var t,r=this.child_linkages.entries();for(t of r)if(t[1].indexOf(e)>=0)return t[0]}graft(e){if(Object.isFrozen(this)||Object.isFrozen(e))throw new TypeError("Cannot graft child on frozen monosaccharide");var t=e.parent,r=t.linkageOf(e);t.removeChild(r,e),this.addChild(r,e)}childAt(e){var t=this.child_linkages.get(e);return t?t[0]:t}toString(){return this.identifier}valueOf(){return this.identifier}setTag(e,t){m.has(this)||m.set(this,new Map);var r=m.get(this),n="symbol"==typeof e?e:Symbol(e);return r.set(n,void 0===t||t),null===t&&r.delete(n),n}getTags(){return m.has(this)?[...m.get(this).keys()]:[]}getTag(e){if(m.has(this))return m.get(this).get(e)}copyTagsFrom(e){m.has(this)||m.set(this,new Map);var t=m.get(this);for(var r of(m.get(e)||new Map).keys())t.set(r,m.get(e).get(r))}clone(){var e=new this.constructor(this.identifier);return e[i]=this[i],e[o]=this[o],e.copyTagsFrom(this),e}toSugar(e){var t=new e;t.root=this;var r=t.clone();return t.root=null,r}}var b=e=>class extends e{addChild(e,t){return this.childAt(e)&&this.removeChild(e),super.addChild(e,t)}};b(y)},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=r(3)},function(e,t,r){var n=r(15),i={};function a(e,t,r,a){var o=Reflect.get(e,t,r)||Reflect.get(n,t,r);return o&&o!==n?o:(a&&(t="".concat(a,":").concat(t)),i[t]||(i[t]=s(t)))}var o=(e,t,r)=>Reflect.set(n,t,r),s=new Proxy((function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return new Proxy(n(e,...r),{get:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return a(...r,e)},set:o})}),{get:a,set:o});e.exports=s},function(e,t,r){"use strict";r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return c})),r.d(t,"a",(function(){return o}));var n=r(2),i=r(1),a=Object(n.a)("glycanjs:tracing");class o extends i.b{constructor(e){return super(e.identifier),this.original=e,this}get anomer(){return this.original.anomer}get parent_linkage(){return this.original.parent_linkage}get identifier(){return this.original.identifier}set anomer(e){}set parent_linkage(e){}set identifier(e){}linkageOf(e){return this.original.linkageOf(e.original)}clone(){var e=new this.constructor(this.original);return e.original=this.original,e.copyTagsFrom(this),e}}var s=(e,t,r,n,i)=>{var a=function(e,t,r){var n=e.clone();t=n.composition().filter(e=>e.original===t.original)[0];var i=new e.constructor.Monosaccharide(r);return t.addChild(t.original.linkageOf(r),i),{sugar:n,child:i}}(e,t,i);return a.child.copyTagsFrom(n),r.push(i),a.sugar},l=(e,t)=>e.composition().filter(e=>t.indexOf(e.original)>=0),c=function(e,t){var r=new Map,n=new t;for(var i of(n.root=new t.Monosaccharide(e.root),r.set(e.root,n.root),e.breadth_first_traversal()))if(i!==e.root){var a=new t.Monosaccharide(i);a=Object.assign(a,i),r.set(i,a),r.get(i.parent).addChild(i.parent.linkageOf(i),a)}return n};class h{static trace(e,t,r,n){var i=e.constructor;return function(e,t,r,n,i){var o=new WeakMap,c=[],h=new WeakMap;a.info("Tracing",n.sequence,"onto",t.sequence,"moving cursor over template");var d=[...n.breadth_first_traversal(n.root,t=>{if(a.info("Template cursor is positioned at",t.identifier),h=new WeakMap,!t.parent)return a.info("The cursor is at the root - the search sugar is at",r.identifier),c.push((n=new e,d=r,u=n.constructor.Monosaccharide,n.root=new u(d),n)),o.set(t,[c[0].composition()[0].original]),c[0].composition()[0].copyTagsFrom(t),a.info("Done with this cursor",t.identifier),c.length>0;var n,d,u;o.set(t,[]),a.info("Residues in the search tree that correspond to the cursor parent are",o.get(t.parent).map(e=>e.identifier));var f=t.parent.linkageOf(t);c=c.filter(e=>l(e,o.get(t.parent)).length>0),a.info("Current sets of sugars are",c);var p=c.map(e=>{var r=l(e,o.get(t.parent));if(r.length>1)throw new Error("Tracing mapped a template residue to more than one residue in the search sugar");return h.set(r[0],e),r[0]});for(var g of(c=[],a.info("We need to find children of the attachment points linked via a",f,"linkage"),p)){var v=g.original;a.info("Attachment point is a wrapped residue with identifier",v.identifier);var m=0==f?v.children:v.child_linkages.get(f);a.info("We want to find a match for the cursor from within",(m||[]).length,"possible child residues");var y=[].concat(m).filter(i.bind(null,t)).filter(e=>e);if(y.length>=1){var b=s.bind(null,h.get(g),g,o.get(t),t);a.info("Valid children in search sugar are",y.map(e=>e.identifier));var w=y.map(b);c=c.concat(w)}}return c.length>0})];return a.info("We mapped",d.length,"out of",n.composition().length,"residues"),a.info(c.map(e=>e.sequence)),c}(class extends i{static get Monosaccharide(){return o}},e,t,r,n)}}},function(e,t,r){(function(e,r){!function(t){"use strict";function n(e){var t=u.indexOf(e);-1<t&&u.splice(t,1),u.push(e),m=0,p&&!f&&(s=v(x),f=!0)}function i(e){for(var t=0;t<u.length;t++)if(e===u[t])return u[t];return null}function a(){return f}function o(){return b}var s,l="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:this||(void 0!==t?t:{}),c=l.requestAnimationFrame||function(e){return l.setTimeout(e,50/3)},h=l.cancelAnimationFrame||function(e){return l.clearTimeout(e)},d=function(){if(void 0===r||void 0===r.hrtime||r.versions&&void 0!==r.versions.electron){if(void 0!==l.performance&&void 0!==l.performance.now)return l.performance.now.bind(l.performance);var e=l.performance&&l.performance.timing&&l.performance.timing.navigationStart?l.performance.timing.navigationStart:Date.now();return function(){return Date.now()-e}}return function(){var e=r.hrtime();return 1e3*e[0]+e[1]/1e6}}(),u=[],f=!1,p=!1,g=[],v=c,m=0,y=120,b=!0,w=function(e){var t=u.indexOf(e);-1!==t&&u.splice(t,1),0===u.length&&(h(s),f=!1)},x=function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:d(),r=1<arguments.length?arguments[1]:void 0;if(y<=m&&b)return f=!1,m=0,h(s),!1;p&&f?s=v(e):function(){for(var e=0;e<g.length;e++)g[e]()}(),u.length||m++;for(var n=0,i=u.length;n<i;)u[n++].update(t,r),i>u.length&&n--,i=u.length;return!0},_={},k={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return Math.pow(e,2)},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*Math.pow(e,2):-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return Math.pow(e,3)},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*Math.pow(e,3):.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return Math.pow(e,4)},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*Math.pow(e,4):-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return Math.pow(e,5)},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*Math.pow(e,5):.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}},Back:{In:function(e){return e*e*(2.70158*e-1.70158)},Out:function(e){return--e*e*(2.70158*e+1.70158)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((1+t)*e-t)*.5:.5*((e-=2)*e*((1+t)*e+t)+2)}},Bounce:{In:function(e){return 1-k.Bounce.Out(1-e)},Out:function(e){var t=2.75,r=7.5625;return e<1/t?r*e*e:e<2/t?r*(e-=1.5/t)*e+.75:e<2.5/t?r*(e-=2.25/t)*e+.9375:r*(e-=2.625/t)*e+.984375},InOut:function(e){return e<.5?.5*k.Bounce.In(2*e):.5*k.Bounce.Out(2*e-1)+.5}},Stepped:{steps:function(e){return function(t){return(t*e|0)/e}}}};function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function C(e,t,r){return t&&M(e.prototype,t),r&&M(e,r),e}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){var n,i,a;n=e,a=r[i=t],i in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?P(e):t}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var I=50/3,N="_chainedTweens",H="Callback",F="update",j="complete",D="start",B="repeat",z="reverse",G="restart",W="STRING_PROP",V=/\s+|([A-Za-z?().,{}:""[\]#%]+)|([-+]=+)?([-+]+)?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]=?\d+)?/g;function U(e){if(e&&e.nodeType||void 0===e||"object"!==O(e))return e;if(Array.isArray(e))return[].concat(e);if("object"!==O(e))return e;var t={};for(var r in e)t[r]=U(e[r]);return t}var X=/^#([0-9a-f]{6}|[0-9a-f]{3})$/gi,Y=function(e,t){var r,n,i;3===t.length&&(t=(r=t[0])+r+(n=t[1])+n+(i=t[2])+i);var a=parseInt(t,16);return"rgb("+(r=a>>16&255)+", "+(n=a>>8&255)+", "+(i=255&a)+")"};function Z(e){if(e&&e.splice&&e.isString)return e;if("string"!=typeof e)return e;if("="===e.charAt(1))return e;var t=e.replace(X,Y).match(V).map((function(e){return function(e){return isNaN(+e)||("+"===e[0]||"-"===e[0])&&"="===e[1]||""===e||" "===e}(e)?e:+e}));return t.isString=!0,t}function K(e,t,r,n){var i=r[e],a=n[e];if(i===a)return!0;if(Array.isArray(i)&&Array.isArray(a)&&i.length===a.length)for(var o=0,s=a.length;o<s;o++){var l=i[o],c=a[o];l===c||"number"==typeof l&&"number"==typeof c||K(o,t[e],i,a)}if(!("number"==typeof i&&"number"==typeof a||i&&i.splice&&i.isString&&a&&a.splice&&a.isString)){if("string"==typeof i&&Array.isArray(a)){var h=Z(i),d=a.map(Z);return r[e]=h,n[e]=d,!0}if("string"==typeof i||"string"==typeof a){var u=Array.isArray(i)&&i[0]===W?i:Z(i),f=Array.isArray(a)&&a[0]===W?a:Z(a);if(void 0===u)return;for(var p=1;p<u.length;)u[p]===f[p]&&"string"==typeof u[p-1]?(u.splice(p-1,2,u[p-1]+u[p]),f.splice(p-1,2,f[p-1]+f[p])):p++;return u[p=0]===W&&u.shift(),f[0]===W&&f.shift(),r[e]=u,n[e]=f,!0}if("object"===O(i)&&"object"===O(a)){if(Array.isArray(i)&&!i.isString)return i.map((function(r,n){return K(n,t[e],i,a)}));for(var g in a)K(g,t[e],i,a);return!0}}return!1}var $="rgba(",Q=function(e,t,r){var n=2<arguments.length&&void 0!==r?r:"rgb(";return"number"==typeof e[t]&&(e[t-1]===n||e[t-3]===n||e[t-5]===n)};function J(e,t,r,n,i,a,o){var s=o?r:r[e],l=o?n:n[e];if(void 0===l)return s;if(void 0===s||"string"==typeof s||s===l)return l;if("object"===O(s)&&"object"===O(l)){if(!s||!l)return t[e];if("object"===O(s)&&s&&s.isString&&l&&l.splice&&l.isString){for(var c="",h=0,d=s.length;h<d;h++)if(s[h]!==l[h]||"number"!=typeof s[h]||"number"==typeof l[h]){var u="number"==typeof s[h]&&"string"==typeof l[h]&&"="===l[h][1],f="number"!=typeof s[h]?s[h]:u?s[h]+parseFloat(l[h][0]+l[h].substr(2))*i:s[h]+(l[h]-s[h])*i;(Q(s,h)||Q(s,h,$))&&(f|=0),c+=f,u&&1===a&&(s[h]=s[h]+parseFloat(l[h][0]+l[h].substr(2)))}else c+=s[h];return o||(t[e]=c),c}if(Array.isArray(s)&&s[0]!==W)for(var p=0,g=s.length;p<g;p++)s[p]!==l[p]&&"string"!=typeof t[e]&&J(p,t[e],s,l,i,a);else if("object"===O(s)&&s&&!s.isString)for(var v in s)s[v]!==l[v]&&J(v,t[e],s,l,i,a)}else if("number"==typeof s){var m="string"==typeof l;t[e]=m?s+parseFloat(l[0]+l.substr(2))*i:s+(l-s)*i,m&&1===a&&(r[e]=t[e])}else"function"==typeof l&&(t[e]=l(i));return t[e]}function ee(e,t){var r=e[t],n=t.replace(ie,"").split(ne),i=n.length-1,a=Array.isArray(e),o="object"===O(e)&&!a;return o?(e[t]=null,delete e[t]):a&&e.splice(t,1),n.reduce((function(e,t,s){a&&"."!==t&&"["!==t&&(t*=1);var l="["===n[s+1];if("."===t||"["===t)return"."===t?a=!(o=!0):"["===t&&(a=!(o=!1)),e;if(void 0===e[t]){if(a||o)return e[t]=s===i?r:a||l?[]:o?{}:null,o=a=!1,e[t]}else if(void 0!==e[t])return s===i&&(e[t]=r),e[t];return e}),e)}function te(e){if("object"===O(e)&&e)for(var t in e)if(-1!==t.indexOf(".")||-1!==t.indexOf("["))ee(e,t);else if("object"===O(e[t])&&e[t]){var r=e[t];for(var n in r)if(-1!==n.indexOf(".")||-1!==n.indexOf("["))ee(r,n);else if("object"===O(r[n])&&r[n]){var i=r[n];for(var a in i)-1===a.indexOf(".")&&-1===a.indexOf("[")||ee(i,a)}}return e}var re,ne=/([.[])/g,ie=/\]/g,ae=Object.freeze({__proto__:null,FRAME_MS:I,TOO_LONG_FRAME_MS:250,CHAINED_TWEENS:N,EVENT_CALLBACK:H,EVENT_UPDATE:F,EVENT_COMPLETE:j,EVENT_START:D,EVENT_REPEAT:B,EVENT_REVERSE:z,EVENT_PAUSE:"pause",EVENT_PLAY:"play",EVENT_RESTART:G,EVENT_STOP:"stop",EVENT_SEEK:"seek",STRING_PROP:W,NUM_REGEX:V,deepCopy:U,decomposeString:Z,decompose:K,RGB:"rgb(",RGBA:$,isRGBColor:Q,recompose:J,SET_NESTED:te}),oe={Linear:function(e,t,r){var n=e.length-1,i=n*t,a=Math.floor(i),o=oe.Utils.Linear;return t<0?o(e[0],e[1],i,r):1<t?o(e[n],e[n-1],n-i,r):o(e[a],e[n<a+1?n:a+1],i-a,r)},Bezier:function(e,t,r){for(var n=oe.Utils.Reset(r),i=e.length-1,a=Math.pow,o=oe.Utils.Bernstein,s=Array.isArray(n),l=0;l<=i;l++)if("number"==typeof n)n+=a(1-t,i-l)*a(t,l)*e[l]*o(i,l);else if(s)for(var c=0,h=n.length;c<h;c++)"number"==typeof n[c]?n[c]+=a(1-t,i-l)*a(t,l)*e[l][c]*o(i,l):n[c]=e[l][c];else if("object"===O(n))for(var d in n)"number"==typeof n[d]?n[d]+=a(1-t,i-l)*a(t,l)*e[l][d]*o(i,l):n[d]=e[l][d];else if("string"==typeof n){for(var u="",f=e[Math.round(i*t)],p=1,g=f.length;p<g;p++)u+=f[p];return u}return n},CatmullRom:function(e,t,r){var n=e.length-1,i=n*t,a=Math.floor(i),o=oe.Utils.CatmullRom;return e[0]===e[n]?(t<0&&(a=Math.floor(i=n*(1+t))),o(e[(a-1+n)%n],e[a],e[(a+1)%n],e[(a+2)%n],i-a,r)):t<0?o(e[1],e[1],e[0],e[0],-t,r):1<t?o(e[n-1],e[n-1],e[n],e[n],(0|t)-t,r):o(e[a?a-1:0],e[a],e[n<a+1?n:a+1],e[n<a+2?n:a+2],i-a,r)},Utils:{Linear:function(e,t,r,n){if(e===t||"string"==typeof e){if(t.length&&t.splice&&t.isString){t="";for(var i=0,a=e.length;i<a;i++)t+=e[i]}return t}if("number"==typeof e)return"function"==typeof e?e(r):e+(t-e)*r;if("object"===O(e)){if(void 0!==e.length){var o="string"==typeof e[0]||e.isString;if(o||e[0]===W){for(var s="",l=o?0:1,c=e.length;l<c;l++){var h=0===r?e[l]:1!==r&&"number"==typeof e[l]?e[l]+(t[l]-e[l])*r:t[l];(0<r&&r<1&&Q(e,l)||Q(e,l,$))&&(h|=0),s+=h}return s}if(n&&n.length&&n.splice)for(var d=0,u=n.length;d<u;d++)n[d]=oe.Utils.Linear(e[d],t[d],r,n[d])}else for(var f in n)n[f]=oe.Utils.Linear(e[f],t[f],r,n[f]);return n}},Reset:function(e){if(Array.isArray(e)){for(var t=0,r=e.length;t<r;t++)e[t]=oe.Utils.Reset(e[t]);return e}if("object"!==O(e))return"number"==typeof e?0:e;for(var n in e)e[n]=oe.Utils.Reset(e[n]);return e},Bernstein:function(e,t){var r=oe.Utils.Factorial;return r(e)/r(t)/r(e-t)},Factorial:(re=[1],function(e){var t=1;if(re[e])return re[e];for(var r=e;1<r;r--)t*=r;return re[e]=t}),CatmullRom:function(e,t,r,n,i,a){if("string"==typeof e)return t;if("number"==typeof e){var o=.5*(r-e),s=.5*(n-t),l=i*i;return(2*t-2*r+o+s)*(i*l)+(-3*t+3*r-2*o-s)*l+o*i+t}if("object"===O(e)){if(void 0!==e.length){if(e[0]===W){for(var c="",h=1,d=e.length;h<d;h++){var u="number"==typeof e[h]?oe.Utils.CatmullRom(e[h],t[h],r[h],n[h],i):n[h];(Q(e,h)||Q(e,h,$))&&(u|=0),c+=u}return c}for(var f=0,p=a.length;f<p;f++)a[f]=oe.Utils.CatmullRom(e[f],t[f],r[f],n[f],i,a[f])}else for(var g in a)a[g]=oe.Utils.CatmullRom(e[g],t[g],r[g],n[g],i,a[g]);return a}}}},se={};function le(e,t,r){if(!e||!e.nodeType)return t;var n=e.queueID||"q_"+Date.now();e.queueID||(e.queueID=n);var i=se[n];if(i){if(i.object===t&&e===i.tween.node&&r._startTime===i.tween._startTime)w(i.tween);else if("object"===O(t)&&t&&i.object){for(var a in t)a in i.object&&(r._startTime===i.tween._startTime?delete i.object[a]:i.propNormaliseRequired=!0);Object.assign(i.object,t)}return i.object}return"object"===O(t)&&t?(se[n]={tween:r,object:t,propNormaliseRequired:!1},se[n].object):t}function ce(e,t,r){return t?e?"undefined"!=typeof window&&e===window||"undefined"!=typeof document&&e===document?[e]:"string"==typeof e?!!document.querySelectorAll&&document.querySelectorAll(e):Array.isArray(e)?e:e.nodeType?[e]:r?e:[]:null:e?"undefined"!=typeof window&&e===window||"undefined"!=typeof document&&e===document?e:"string"==typeof e?!!document.querySelector&&document.querySelector(e):Array.isArray(e)?e[0]:e.nodeType||r?e:null:null}var he=0,de=k.Linear.None,ue=function(){function e(t,r){return S(this,e),this.id=he++,!t||"object"!==O(t)||r||t.nodeType?t&&(t.nodeType||t.length||"string"==typeof t)&&(t=this.node=ce(t),r=this.object=le(t,r,this)):(r=this.object=t,t=null),this._valuesEnd=null,this._valuesStart=Array.isArray(r)?[]:{},this._duration=1e3,this._easingFunction=de,this._easingReverse=de,this._interpolationFunction=oe.Linear,this._startTime=0,this._initTime=0,this._delayTime=0,this._repeat=0,this._r=0,this._isPlaying=!1,this._yoyo=!1,this._reversed=!1,this._onStartCallbackFired=!1,this._pausedTime=null,this._isFinite=!0,this._maxListener=15,this._chainedTweensCount=0,this._prevTime=null,this}return C(e,null,[{key:"fromTo",value:function(t,r,n,i){var a=3<arguments.length&&void 0!==i?i:{};a.quickRender=a.quickRender?a.quickRender:!n;var o=new e(t,r).to(n,a);return a.quickRender&&(o.render().update(o._startTime),o._rendered=!1,o._onStartCallbackFired=!1),o}},{key:"to",value:function(t,r,n){return e.fromTo(t,null,r,n)}},{key:"from",value:function(t,r,n){return e.fromTo(t,r,null,n)}}]),C(e,[{key:"setMaxListener",value:function(e){var t=0<arguments.length&&void 0!==e?e:15;return this._maxListener=t,this}},{key:"on",value:function(e,t){for(var r=this._maxListener,n=e+H,i=0;i<r;i++){var a=n+i;if(!this[a]){this[a]=t;break}}return this}},{key:"once",value:function(e,t){for(var r=this,n=this._maxListener,i=e+H,a=function(e){var n=i+e;if(!r[n])return r[n]=function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];t.apply(r,i),r[n]=null},"break"},o=0;o<n&&"break"!==a(o);o++);return this}},{key:"off",value:function(e,t){for(var r=this._maxListener,n=e+H,i=0;i<r;i++){var a=n+i;this[a]===t&&(this[a]=null)}return this}},{key:"emit",value:function(e,t,r,n){var i=this._maxListener,a=e+H;if(!this[a+0])return this;for(var o=0;o<i;o++){var s=a+o;this[s]&&this[s](t,r,n)}return this}},{key:"isPlaying",value:function(){return this._isPlaying}},{key:"isStarted",value:function(){return this._onStartCallbackFired}},{key:"reverse",value:function(e){var t=this._reversed;return this._reversed=void 0!==e?e:!t,this}},{key:"reversed",value:function(){return this._reversed}},{key:"pause",value:function(){return this._isPlaying?(this._isPlaying=!1,w(this),this._pausedTime=d(),this.emit("pause",this.object)):this}},{key:"play",value:function(){return this._isPlaying?this:(this._isPlaying=!0,this._startTime+=d()-this._pausedTime,this._initTime=this._startTime,n(this),this._pausedTime=d(),this.emit("play",this.object))}},{key:"restart",value:function(){return this._repeat=this._r,this.reassignValues(),n(this),this.emit(G,this.object)}},{key:"seek",value:function(e,t){var r=this._duration,n=this._initTime,i=this._startTime,a=this._reversed,o=n+e;return this._isPlaying=!0,o<i&&n<=i&&(this._startTime-=r,this._reversed=!a),this.update(e,!1),this.emit("seek",e,this.object),t?this:this.pause()}},{key:"duration",value:function(e){return this._duration="function"==typeof e?e(this._duration):e,this}},{key:"to",value:function(e,t){var r=1<arguments.length&&void 0!==t?t:1e3;if(this._valuesEnd=e,"number"==typeof r||"function"==typeof r)this._duration="function"==typeof r?r(this._duration):r;else if("object"===O(r))for(var n in r)if("function"==typeof this[n]){var i=R(Array.isArray(r[n])?r[n]:[r[n]],4),a=i[0],o=void 0===a?null:a,s=i[1],l=void 0===s?null:s,c=i[2],h=void 0===c?null:c,d=i[3],u=void 0===d?null:d;this[n](o,l,h,u)}return this}},{key:"render",value:function(){if(this._rendered)return this;var t=this._valuesStart,r=this._valuesEnd,n=this.object,i=this.node,a=this.InitialValues;if(te(n),te(r),i&&i.queueID&&se[i.queueID]){var o=se[i.queueID];if(o.propNormaliseRequired&&o.tween!==this){for(var s in r)o.tween._valuesEnd[s];o.normalisedProp=!0,o.propNormaliseRequired=!1}}if(i&&a&&(n&&0!==Object.keys(n).length?r&&0!==Object.keys(r).length||(r=this._valuesEnd=a(i,n)):n=this.object=le(i,a(i,r),this)),!t.processed){for(var l in r){var c=n&&n[l]&&U(n[l]),h=r[l];if(!(_[l]&&_[l].init&&(_[l].init.call(this,c,h,l,n),void 0===c&&t[l]&&(c=t[l]),_[l].skipProcess)||"number"==typeof c&&isNaN(c)||null===c||null===h||!1===c||!1===h||void 0===c||void 0===h||c===h)){if(t[l]=c,Array.isArray(h))if(Array.isArray(c))h.isString&&n[l].isString&&!c.isString?c.isString=!0:K(l,n,t,r);else{h.unshift(c);for(var d=0,u=h.length;d<u;d++)"string"==typeof h[d]&&(h[d]=Z(h[d]))}else K(l,n,t,r);"number"!=typeof c||"string"!=typeof h||h[1]}}t.processed=!0}return e.Renderer&&this.node&&e.Renderer.init&&(e.Renderer.init.call(this,n,t,r),this.__render=!0),this._rendered=!0,this}},{key:"start",value:function(e){return this._startTime=void 0!==e?"string"==typeof e?d()+parseFloat(e):e:d(),this._startTime+=this._delayTime,this._initTime=this._prevTime=this._startTime,this._onStartCallbackFired=!1,this._rendered=!1,this._isPlaying=!0,n(this),this}},{key:"stop",value:function(){var e=this._isPlaying,t=this._isFinite,r=this.object,n=this._startTime,i=this._duration,a=this._r,o=this._yoyo,s=this._reversed;if(!e)return this;var l=t?(a+1)%2==1:!s;return this._reversed=!1,o&&l?this.update(n):this.update(n+i),w(this),this.emit("stop",r)}},{key:"delay",value:function(e){return this._delayTime="function"==typeof e?e(this._delayTime):e,this}},{key:"chainedTweens",value:function(){if(this._chainedTweensCount=arguments.length,!this._chainedTweensCount)return this;for(var e=0,t=this._chainedTweensCount;e<t;e++)this[N+e]=arguments[e];return this}},{key:"repeat",value:function(e){return this._repeat=this._duration?"function"==typeof e?e(this._repeat):e:0,this._r=this._repeat,this._isFinite=isFinite(e),this}},{key:"reverseDelay",value:function(e){return this._reverseDelayTime="function"==typeof e?e(this._reverseDelayTime):e,this}},{key:"yoyo",value:function(e,t){return this._yoyo="function"==typeof e?e(this._yoyo):null===e?this._yoyo:e,e||(this._reversed=!1),this._easingReverse=t||null,this}},{key:"easing",value:function(e){return this._easingFunction=e,this}},{key:"interpolation",value:function(e){return"function"==typeof e&&(this._interpolationFunction=e),this}},{key:"reassignValues",value:function(e){var t=this._valuesStart,r=this.object,i=this._delayTime;for(var a in this._isPlaying=!0,this._startTime=void 0!==e?e:d(),this._startTime+=i,this._reversed=!1,n(this),t){var o=t[a];r[a]=o}return this}},{key:"update",value:function(t,r,n){var i,s,l,c=this._onStartCallbackFired,h=this._easingFunction,u=this._interpolationFunction,f=this._easingReverse,p=this._repeat,g=this._delayTime,v=this._reverseDelayTime,m=this._yoyo,y=this._reversed,b=this._startTime,x=this._prevTime,k=this._duration,O=this._valuesStart,S=this._valuesEnd,M=this.object,C=this._isFinite,E=this._isPlaying,A=this.__render,T=this._chainedTweensCount,L=0;if(k){var P=(t=void 0!==t?t:d())-x;if(this._prevTime=t,250<P&&a()&&o()&&(t-=P-I),!E||t<b&&!n)return!0;i=1<(i=(t-b)/k)?1:i,i=y?1-i:i}else i=1,p=0;if(c||(this._rendered||(this.render(),this._rendered=!0),this.emit(D,M),this._onStartCallbackFired=!0),s=y&&f||h,!M)return!0;for(l in S){var q=O[l];if(null!=q||_[l]&&_[l].update){var R=S[l],H=s[l]?s[l](i):("function"==typeof s?s:de)(i),G=u[l]?u[l]:"function"==typeof u?u:oe.Linear;"number"==typeof R?M[l]=q+(R-q)*H:!Array.isArray(R)||R.isString||Array.isArray(q)?R&&R.update?R.update(H):"function"==typeof R?M[l]=R(H):"string"==typeof R&&"number"==typeof q?M[l]=q+parseFloat(R[0]+R.substr(2))*H:J(l,M,O,S,H,i):M[l]=G(R,H,M[l]),_[l]&&_[l].update&&_[l].update.call(this,M[l],q,R,H,i,l),L++}}if(!L)return w(this),!1;if(A&&e.Renderer&&e.Renderer.update&&e.Renderer.update.call(this,M,i),this.emit(F,M,i,t),1===i||y&&0===i){if(0<p&&0<k){if(C&&this._repeat--,m)this._reversed=!y;else for(l in S){var W=S[l];"string"==typeof W&&"number"==typeof O[l]&&(O[l]+=parseFloat(W[0]+W.substr(2)))}return this.emit(m&&!y?z:B,M),this._startTime=y&&v?t-v:t+g,!0}if(r||(this._isPlaying=!1,w(this),he--),this.emit(j,M),this._repeat=this._r,T)for(var V=0;V<T;V++)this[N+V].start(t+k);return!1}return!0}}]),e}(),fe=function(){function e(){S(this,e),this.totalTime=0,this.labels=[],this.offsets=[]}return C(e,[{key:"parseLabel",value:function(e,t){var r=this.offsets,n=this.labels,i=n.indexOf(e);if("string"==typeof e&&-1!==e.indexOf("=")&&!t&&-1===i){var a=e.substr(e.indexOf("=")-1,2),o=e.split(a);t=2===o.length?a+o[1]:null,e=o[0],i=n.indexOf(e)}if(-1!==i&&e){var s=r[i]||0;if("number"==typeof t)s=t;else if("string"==typeof t&&-1!==t.indexOf("=")){var l=t.charAt(0);t=Number(t.substr(2)),"+"===l||"-"===l?s+=parseFloat(l+t):"*"===l?s*=t:"/"===l?s/=t:"%"===l&&(s*=t/100)}return s}return"number"==typeof t?t:0}},{key:"addLabel",value:function(e,t){return this.labels.push(e),this.offsets.push(this.parseLabel(e,t)),this}},{key:"setLabel",value:function(e,t){var r=this.labels.indexOf(e);return-1!==r&&this.offsets.splice(r,1,this.parseLabel(e,t)),this}},{key:"eraseLabel",value:function(e){var t=this.labels.indexOf(e);return-1!==t&&(this.labels.splice(t,1),this.offsets.splice(t,1)),this}}]),e}(),pe=0,ge=function(){function e(t){var r;return S(this,e),(r=q(this,T(e).call(this)))._duration=0,r._startTime=t&&void 0!==t.startTime?t.startTime:d(),r._tweens=[],r.elapsed=0,r._id=pe++,r._defaultParams=t,r.position=new fe,r.position.addLabel("afterLast",r._duration),r.position.addLabel("afterInit",r._startTime),r._onStartCallbackFired=!1,q(r,P(r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(e,ue),C(e,[{key:"mapTotal",value:function(e){return e.call(this,this._tweens),this}},{key:"timingOrder",value:function(e){var t=e(this._tweens.map((function(e){return e._startTime})));return this._tweens.map((function(e,r){e._startTime=t[r]})),this}},{key:"getTiming",value:function(e,t,r,n){var i=3<arguments.length&&void 0!==n?n:0;if("reverse"===e){var a=r.stagger,o=(a||0)*(t.length-1);return t.map((function(e,t){return o-(a||0)*t+i}))}if("async"===e)return t.map((function(e){return i}));if("sequence"===e||"delayed"===e){var s=r.stagger;return s=s||(r.duration||1e3)/(t.length-1),t.map((function(e,t){return s*t+i}))}if("oneByOne"===e)return t.map((function(e){return r.duration}));if("shuffle"===e){var l=r.stagger;return function(e){var t,r,n;for(n=e.length;n;--n)t=Math.floor(Math.random()*n),r=e[n-1],e[n-1]=e[t],e[t]=r;return e}(t.map((function(e,t){return(l||0)*t+i})))}var c=r.stagger;return t.map((function(e,t){return(c||0)*t+i}))}},{key:"fromTo",value:function(e,t,r,n){if((e=ce(e,!0,!0))&&e.length){this._defaultParams&&(n=n?A({},this._defaultParams,{},n):this._defaultParams);for(var i,a=n.label,o="number"==typeof a?a:this.position.parseLabel(void 0!==a?a:"afterLast",null),s=this.getTiming(n.mode,e,n,o),l=0,c=e.length;l<c;l++)i=e[l],this.add(ue.fromTo(i,"function"==typeof t?t(l,e.length):"object"===O(t)&&t?A({},t):null,"function"==typeof r?r(l,e.length):r,"function"==typeof n?n(l,e.length):n),s[l])}return this.start()}},{key:"from",value:function(e,t,r){return this.fromTo(e,t,null,r)}},{key:"to",value:function(e,t,r){return this.fromTo(e,null,t,r)}},{key:"addLabel",value:function(e,t){return this.position.addLabel(e,t),this}},{key:"map",value:function(e){for(var t=0,r=this._tweens.length;t<r;t++){var n=this._tweens[t];e(n,t),this._duration=Math.max(this._duration,n._duration+n._startTime)}return this}},{key:"add",value:function(e,t){var r=this;if(Array.isArray(e))return e.map((function(e){r.add(e,t)})),this;"object"!==O(e)||e instanceof ue||(e=new ue(e.from).to(e.to,e));var n=this._defaultParams,i=this._duration;if(n)for(var a in n)"function"==typeof e[a]&&e[a](n[a]);var o="number"==typeof t?t:this.position.parseLabel(void 0!==t?t:"afterLast",null);return e._startTime=Math.max(this._startTime,e._delayTime,o),e._delayTime=o,e._isPlaying=!0,this._duration=Math.max(i,Math.max(e._startTime+e._delayTime,e._duration)),this._tweens.push(e),this.position.setLabel("afterLast",this._duration),this}},{key:"restart",value:function(){return this._startTime+=d(),n(this),this.emit(G)}},{key:"easing",value:function(e){return this.map((function(t){return t.easing(e)}))}},{key:"interpolation",value:function(e){return this.map((function(t){return t.interpolation(e)}))}},{key:"update",value:function(e){var t,r=this._tweens,n=this._duration,i=this._reverseDelayTime,s=this._startTime,l=this._reversed,c=this._yoyo,h=this._repeat,u=this._isFinite,f=this._isPlaying,p=this._prevTime,g=this._onStartCallbackFired,v=(e=void 0!==e?e:d())-p;if(this._prevTime=e,250<v&&a()&&o()&&(e-=v-I),!f||e<s)return!0;t=1<(t=(e-s)/n)?1:t,t=l?1-t:t,this.elapsed=t,g||(this.emit(D),this._onStartCallbackFired=!0);for(var m=e-s,y=l?n-m:m,b=0;b<r.length;)r[b].update(y),b++;if(this.emit(F,t,m),1===t||l&&0===t){if(h){for(u&&this._repeat--,this.emit(l?z:B),c&&(this._reversed=!l,this.timingOrder((function(e){return e.reverse()}))),this._startTime=l&&i?e+i:e,b=0;b<r.length;)r[b].reassignValues(e),b++;return!0}return this.emit(j),this._repeat=this._r,w(this),this._isPlaying=!1}return!0}},{key:"progress",value:function(e){return void 0!==e?this.update(e*this._duration):this.elapsed}}]),e}();t.Easing=k,t.FrameThrottle=function(e){y=1.05*(0<arguments.length&&void 0!==e?e:120)},t.Interpolation=oe,t.Interpolator=function(e,t){var r=Array.isArray(e)&&!e.isString,n="string"==typeof e?e:r?e.slice():A({},e);if(r)for(var i=0,a=e.length;i<a;i++)e[i]===t[i]&&"number"==typeof e[i]&&"number"!=typeof t[i]||K(i,n,e,t);else if("object"===O(e))for(var o in e)e[o]===t[o]&&"number"==typeof e[o]&&"number"!=typeof t[o]||K(o,n,e,t);else if("string"==typeof e){e=Z(e),t=Z(t);for(var s=1;s<e.length;)e[s]===t[s]&&"string"==typeof e[s-1]?(e.splice(s-1,2,e[s-1]+e[s]),t.splice(s-1,2,t[s-1]+t[s])):s++}return function(i){if(r)for(var a=0,o=e.length;a<o;a++)J(a,n,e,t,i);else if("object"===O(n))for(var s in e)J(s,n,e,t,i);else"string"==typeof n&&(n=J(0,0,e,t,i,i,!0));return n}},t.Plugins=_,t.Selector=ce,t.Timeline=ge,t.ToggleLagSmoothing=function(e){b=!(0<arguments.length&&void 0!==e)||e},t.Tween=ue,t.add=n,t.autoPlay=function(e){p=e},t.get=i,t.getAll=function(){return u},t.has=function(e){return null!==i(e)},t.isRunning=a,t.now=d,t.onRequestTick=function(e){g.push(e)},t.onTick=function(e){return u.push({update:e})},t.remove=w,t.removeAll=function(){u.length=0,h(s),f=!1},t.update=x,t.utils=ae,Object.defineProperty(t,"__esModule",{value:!0})}(t)}).call(this,r(18),r(8))},function(e,t,r){"use strict";var n=r(2),i=Object(n.a)("glycanjs:svgcanvas"),a="http://www.w3.org/2000/svg",o=e=>e.toFixed(1);t.a=class{constructor(e){i.info("Creating canvas element");var t="DEFS"===e.nodeName;this.canvas=this.createElement(t?"symbol":"svg",e.ownerDocument),this.canvas.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),e.appendChild(this.canvas)}createElement(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.canvas.ownerDocument).createElementNS(a,e)}appendChild(e){this.canvas.appendChild(e)}group(e){return e||(e=this.canvas.ownerDocument.createElementNS(a,"g"),this.appendChild(e)),Object.create(this,{appendChild:{value:t=>e.appendChild(t)},setAttribute:{value:(t,r)=>e.setAttribute(t,r)},setAttributeNS:{value:(t,r,n)=>e.setAttributeNS(t,r,n)},element:{value:e}})}use(e,t,r,n,i){var s=this.canvas.ownerDocument.createElementNS(a,"use");return s.setAttribute("x",o(t)),s.setAttribute("y",o(r)),s.setAttribute("width",o(n)),s.setAttribute("height",o(i)),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e),this.appendChild(s),s}rect(e,t,r,n){var i=this.canvas.ownerDocument.createElementNS(a,"rect");return i.setAttribute("x",o(e)),i.setAttribute("y",o(t)),i.setAttribute("width",o(r)),i.setAttribute("height",o(n)),this.appendChild(i),i}line(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=this.canvas.ownerDocument.createElementNS(a,"line");for(var l of(s.setAttribute("x1",o(e)),s.setAttribute("y1",o(t)),s.setAttribute("x2",o(r)),s.setAttribute("y2",o(n)),Object.keys(i)))s.setAttribute(l,i[l]);var[c,h,d]=[i.fill?"fill: var(--fill-color,".concat(i.fill,");"):"",i.stroke?"stroke: var(--stroke-color,".concat(i.stroke,");"):"",i["stroke-width"]?"stroke-width: var(--stroke-width,".concat(i["stroke-width"],")"):""];return s.setAttribute("style","".concat(c).concat(h).concat(d)),s.setAttribute("stroke-linecap","round"),this.appendChild(s),s}text(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=this.canvas.ownerDocument.createElementNS(a,"text"),s=this.canvas.ownerDocument.createElementNS(a,"tspan");for(var l of("string"!=typeof r?i.appendChild(r):(i.appendChild(s),s.textContent=r,s.setAttribute("dy","0")),i.style.fontFamily="Helvetica, Verdana, Arial, Sans-serif",i.setAttribute("x",o(e)),i.setAttribute("y",o(t)),["font-size","text-anchor"]))n[l]&&i.setAttribute(l,n[l]);for(var c of["dy","dx"])n[c]&&s.setAttribute(c,n[c]);return this.appendChild(i),i}sendToBack(e){e.element&&(e=e.element);var t=e.parentNode;return t.insertBefore(e,t.firstChild),e}sendToFront(e){return e.element&&(e=e.element),e.parentNode.insertBefore(e,null),e}}},function(e,t,r){"use strict";var n=r(2),i=r(1),a=r(0),o=Object(n.a)("glycanjs:renderer"),s=Symbol("canvas"),l=Symbol("cached_layout"),c=Symbol("layout"),h=Symbol("rendered_sugars"),d=Symbol("rendered_elements"),u=Symbol("group_tag"),f=Symbol("rotate"),p=e=>e.toFixed(1),g=e=>e.height,v=e=>e.width,m=function(e,t,r,n,i){var a=this.rotate,o=this.leftToRight,s=a?v:g,l=a?g:v,c="?";"b"===e&&(c="β"),"a"===e&&(c="α"),(t=t||"?")<0&&(t="");var[h,d,u,f]=[r.x+r.width/2,r.y+r.height/2,n.x+n.width/2,n.y+n.height/2],p=a?h-u:d-f,m=a?d-f:h-u,y=s(r)+s(n),b=a?f:u,w=a?r.x:r.y,x=a?r.y-n.y:r.x-n.x,_=a?r.x-n.x:r.y-n.y,k=m/p;isFinite(k)||(k=-1,x>0&&(k=1));var O=p,S=1*O;Math.abs(O)>=y/2?S=1*(O-=y/2)+s(n)/2:0==O&&(S=.425*Math.abs(m));var M=k*S;0===M&&(M+=l(r)/10);var C=100*(b+M),E=100*(w+(o?0:1)*s(r));0===_&&(E=100*(w+s(r)/8))>25&&(E=25);var A=this.renderLinkageLabel(i,a?E:C,a?C:E,c+t,a,M,Math.abs(k)<1&&o);return i.sendToBack(A),A},y=(e,t,r,n,i)=>[(1-i)*e+i*r,(1-i)*t+i*n],b=(e,t,r,n,i)=>{var a=t-n,o=r-e,s=i/Math.hypot(a,o);return[e+(a*=s),t+(o*=s),e-a,t-o]},w=(e,t,r,n,i)=>{var a=t-n,o=r-e,s=i/Math.hypot(a,o);return[e-(a*=s),t-(o*=s),e,t]},x=function(e,t,r,n,i,o){var s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];if(t){var l=[100*(e.x+e.width/2),100*(e.y+e.height/2),100*(t.x+t.width/2),100*(t.y+t.height/2)],c=this.renderLinkageGroup(o,i,r);o.sendToBack(c),c.line(...l,{"stroke-width":p(1),stroke:"#333"}),s&&m.call(this,r.anomer,n.linkageOf(r),e,t,c);var h=r instanceof a.a.Monosaccharide&&r.repeat.mode!==a.a.MODE_EXPAND,d=n instanceof a.a.Monosaccharide&&n.repeat.mode!==a.a.MODE_EXPAND,u=h&&d&&r.repeat!==n.repeat;if(h&&r.endsRepeatUnit&&0===r.children.filter(e=>["Fuc","HSO3"].indexOf(e.identifier)<0).length){var f=[100*(e.x+e.width/2),100*(e.y+e.height/2),100*(t.x+t.width/2),100*(t.y+t.height/2)],g=-1,v=.25;e.x-t.x!=0&&e.y-t.y!=0&&(v=1/4);var x=y(...f,-.5),_=b(x[0],x[1],f[2],f[3],100*e.width*v),k=w(..._,100*g*e.width/8),O=w(_[2],_[3],_[0],_[1],-1*g*100*e.width/8);c.line(..._,{"stroke-width":p(5),stroke:"#999"}),c.line(...k,{"stroke-width":p(5),stroke:"#999"}),c.line(...O,{"stroke-width":p(5),stroke:"#999"})}if(h?!d||u:d){var S=[100*(e.x+e.width/2),100*(e.y+e.height/2),100*(t.x+t.width/2),100*(t.y+t.height/2)],M=h?1:-1,C=.25;e.x-t.x!=0&&e.y-t.y!=0&&(C=1/4);var E=y(...S,M>0?.55:.5),A=b(E[0],E[1],S[2],S[3],100*e.width*C),T=w(...A,100*M*e.width/8),L=w(A[2],A[3],A[0],A[1],-1*M*100*e.width/8);c.line(...A,{"stroke-width":p(5),stroke:"#999"}),c.line(...T,{"stroke-width":p(5),stroke:"#999"}),c.line(...L,{"stroke-width":p(5),stroke:"#999"}),h&&c.text(T[2],T[3],r.repeat.identifier,{"font-size":p(Math.floor(100/3)),"text-anchor":this.rotate?"middle":"end",dy:this.rotate?"1em":"0.25em",dx:(this.rotate,"-0.25em")})}return c}},_=function(e){var t=new Set(e);for(var r of this.rendered.keys())if(r instanceof i.b&&!t.has(r)){var n=this.rendered.get(r);this.removeRendered(n),this.rendered.delete(r)}},k=function(e,t){if(t){o.info("Laying out",e.sequence);var r=t.PerformLayout(e);return r.calculateIdentifier=t.CalculateIdentifier,r}o.info("No layout engine specified, skipping layout")},O=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.composition(),n=[],i=[],a=this.rendered.get(e),o=this.rotate,s=this.leftToRight;if(a=this.setupContainer(a,e),!(r.length<1)){var l=[];for(var h of t?r:[]){var d=t.get(h),u=d.x,f=d.y;o&&(d.x=s?-1*(f+d.height):f,d.y=s?u:-1*(u+d.width)),n.push(d.x),n.push(d.x+d.width),i.push(d.y),i.push(d.y+d.height);var p=null,g=this.rendered.get(h);g?p=g.residue:(g={residue:p=this.renderIcon(a,t.calculateIdentifier(h),h,e),linkage:null},this.rendered.set(h,g)),1!==d.z&&l.push({z:d.z,icon:p});var v=1==this[c].LINKS;g.linkage&&this.removeRendered({linkage:g.linkage}),g.linkage=this.renderLinkage(d,h.parent?t.get(h.parent):void 0,h,h.parent,e,a,v&&"HSO3"!==h.identifier);var m=0;d.rotate&&(m=d.rotate),o&&!d.keep_horizontal&&(m-=s?-90:90),this.setIconPosition(p,100*d.x,100*d.y,100*d.width,100*d.height,m)}var y=l.map(e=>e.icon.element).map(e=>[...e.parentNode.children].indexOf(e)).map((e,t,r)=>e-(r[t-1]||0)).map(e=>e>=0).reduce((e,t)=>e&&t,!0);if(!y)for(var b of l.sort((e,t)=>e.z-t.z))a.sendToFront(b.icon);if(this.groupTag&&a.tagGroup){var w=[];for(var x of e.composition_for_tag(this.groupTag)){var _=this.rendered.get(x);_&&(_.linkage&&a.tagGroup.appendChild(_.linkage),w.push(_.residue))}for(var k of w)a.tagGroup.appendChild(k.element)}return a}};t.a=class{constructor(e,t){e&&t&&(this[c]=t,this[l]=new WeakMap),this[h]=[],this[d]=new Map}get LayoutEngine(){return this[c]}set LayoutEngine(e){this[c]=e}static get GLOBAL_SCALE(){return 100}get element(){return this[s]}set element(e){this[s]=e}get rendered(){return this[d]}set groupTag(e){e!==this[u]&&this.resetTags(),this[u]=e}get groupTag(){return this[u]}addSugar(e){this[h].push(e)}get sugars(){return Object.freeze([].concat(this[h]))}layoutFor(e){if(this.global_layout.has(e)){var{x:t,y:r,width:n,height:i}=this.global_layout.get(e);return{x:t,y:r,width:n,height:i}}}refresh(){for(var e of(_.bind(this)(Array.prototype.concat(...this[h].map(e=>e.composition()))),this.global_layout=new WeakMap,this[h])){var t=k(e,this[c]);if(t)for(var r of[e,...e.composition()])this.global_layout.set(r,t.get(r));var n=e.composition();O.bind(this)(e,t,n)}return Promise.resolve()}setupContainer(){}resetTags(){}removeRendered(){}renderIcon(){}renderLinkageLabel(){}renderLinkage(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return x.call(this,...t)}get horizontal(){return this[f]}set horizontal(e){this[f]=!!e}}},function(e,t){var r,n,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var l,c=[],h=!1,d=-1;function u(){h&&l&&(h=!1,l.length?c=l.concat(c):d=-1,c.length&&f())}function f(){if(!h){var e=s(u);h=!0;for(var t=c.length;t;){for(l=c,c=[];++d<t;)l&&l[d].run();d=-1,t=c.length}l=null,h=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new p(e,t)),1!==c.length||h||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){"use strict";var n=Symbol("torender");var i=function(e){var t=e.getContext("2d");t.font="".concat(this.options["font-size"]||25,"px Helvetica"),t.textAlign="left",this.options["text-anchor"]&&(t.textAlign=this.options["text-anchor"]),t.textBaseline="top",this.options.dy&&(t.textBaseline="middle"),t.fillStyle="#111",t.fillText(this.text,this.x,this.y)},a=function(e){var t=e.getContext("2d");this.options["stroke-width"]&&(t.lineWidth=this.options["stroke-width"]),this.options.stroke&&(t.strokeStyle=this.options.stroke),t.beginPath(),t.moveTo(this.x,this.y),t.lineTo(this.x2,this.y2),t.stroke()},o=new Map,s=function(e){var t=e.getContext("2d"),r=o.get(this.src);r||((r=new Image).src=this.src,r.loaded=new Promise(e=>{r.addEventListener("load",e)})),o.set(this.src,r),r.loaded.then(()=>{t.drawImage(r,this.x,this.y,this.width,this.height)})};class l extends class{constructor(){this[n]=[]}get torender(){return this[n]}appendChild(e){e.parent&&e.parent.torender.splice(e.parent.torender.indexOf(e),1),e.parent=this,this.torender.push(e)}sendToBack(e){return e.parent.torender.unshift(e.parent.torender.splice(e.parent.torender.indexOf(e),1)[0]),e}sendToFront(e){return e.parent.torender.push(e.parent.torender.splice(e.parent.torender.indexOf(e),1)[0]),e}remove(e){this.torender.splice(this.torender.indexOf(e),1)}}{constructor(e){super(),e&&(this.canvas=e)}createElement(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.canvas.ownerDocument).createElement(e)}group(e){return e||(e=new l,this.appendChild(e)),e}use(e,t,r,n,i){var a={icon:e,x:t,y:r,width:n,height:i,render:s};return this.appendChild(a),a}rect(){}line(e,t,r,n){var i={x:e,y:t,x2:r,y2:n,options:arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},render:a};return this.appendChild(i),i}text(e,t,r){var n={x:e,y:t,text:r,options:arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},render:i};return this.appendChild(n),n}}t.a=l},function(e,t,r){"use strict";(function(e){var n,i=r(2),a=r(6),o=r(7),s=Object(i.a)("glycanjs:svgrenderer"),l=Symbol("document_container"),c="https://glycocode.com/glycanjs",h={side:1,top:1},d="object"!=typeof e||"object"!=typeof e.versions||void 0===e.versions.node?r(11).default:"",u=e=>e.toFixed(1),f=function(e,t){for(var r of"mousemove mousedown mouseup click touchstart touchend touchmove drop dragover".split(" "))e.addEventListener(r,t,{passive:!0,capture:!0})},p=function(e,t){var r=this.rotate;if(t.clientX){var n=e.createSVGPoint();n.x=t.clientX,n.y=t.clientY;var i=n.matrixTransform(e.getScreenCTM().inverse()),a=i.x/100,o=i.y/100;t.sugarX=r?-1*o+1:a,t.sugarY=r?a:o}};class g extends o.a{constructor(e,t){s("SVGRenderer"),super(e,t),e&&t&&(this[l]=e,this.element=new a.a(e),this.element.canvas.setAttribute("xmlns:glycanjs",c),f(this.element.canvas,p.bind(this,this.element.canvas)))}static get SYMBOLS(){return d}static get GLOBAL_SCALE(){return 100}appendSymbols(){this.constructor.AppendSymbols(this)}static AppendSymbols(e){e instanceof g&&(e=e.element.canvas);var t=Promise.resolve(this.SYMBOLS).then(e=>(new DOMParser).parseFromString(e,"image/svg+xml")).then(e=>e.querySelectorAll("svg defs"));if(!(e instanceof SVGDefsElement)){var r=e.ownerDocument.createElementNS("http://www.w3.org/2000/svg","defs");e.appendChild(r),e=r}return t.then(t=>{for(var r of(console.log(t),t))e.appendChild(r.cloneNode(!0))})}static fromSVGElement(e,t){var r=new n;r[l]=e.parentNode,r.element=new a.a(e),r.element.canvas=e,((e,t)=>{var r=e.ownerDocument.createElement("div");r.innerHTML=t.replace(/<\?.*\?>/,"");var n=[...r.querySelectorAll("defs symbol")].map(e=>e.getAttribute("id"));for(var i of e.querySelectorAll("symbol"))n.indexOf(i.getAttribute("id"))>=0&&i.parentNode.removeChild(i);for(var a of r.querySelectorAll("defs"))e.appendChild(a)})(e,g.SYMBOLS),(e=>{for(var t of e.querySelectorAll("symbol *[fill]")){var r=t.getAttribute("fill"),n=t.getAttribute("stroke-width"),i=t.getAttribute("stroke");r&&(t.style.fill="var(--fill-color,".concat(r,")")),n&&(t.style.strokeWidth="var(--stroke-width,".concat(n,")")),i&&(t.style.stroke="var(--stroke-color,".concat(i,")"))}for(var a of e.querySelectorAll("g[*|location] line")){var o=a.getAttribute("stroke-width"),s=a.getAttribute("stroke");o&&(a.style.strokeWidth="var(--stroke-width,".concat(o,")")),s&&(a.style.stroke="var(--stroke-color,".concat(s,")"))}})(e),f(e,p.bind(r,e));var i=e.querySelectorAll("g");for(var o of i)if(o.hasAttribute("glycanjs:sequence")){var s=new t;for(var c of(s.sequence=o.getAttribute("glycanjs:sequence"),r.addSugar(s),r.rendered.set(s,r.element.group(o)),o.querySelectorAll("use")))if(c.hasAttribute("glycanjs:location")){var h={residue:{element:c}};c.parentNode!==o&&o.appendChild(c),r.rendered.set(s.locate_monosaccharide(c.getAttribute("glycanjs:location")),h)}for(var d of o.querySelectorAll("g"))if(d.hasAttribute("glycanjs:location")){d.parentNode!==o&&(o.appendChild(d),r.element.sendToBack(d));var u=r.rendered.get(s.locate_monosaccharide(d.getAttribute("glycanjs:location")));u?u.linkage=d:console.log("ERROR loading linkage for ",s.sequence,"missing residue at",d.getAttribute("glycanjs:location"))}}return r}resetTags(){for(var e of this.sugars){var t=this.rendered.get(e);if(t.tagGroup)for(var r of[...t.tagGroup.element.childNodes])t.appendChild(r)}}setupContainer(e,t){var r=this.element;if(e||((e=r.group()).setAttributeNS(null,"pointer-events","none"),this.rendered.set(t,e)),e.setAttributeNS(c,"glycanjs:sequence",t.sequence),this.groupTag&&!e.tagGroup&&(e.tagGroup=e.group(),e.tagGroup.element.setAttribute("class","tagged")),e.tagGroup){for(var n of e.tagGroup.element.childNodes)e.appendChild(n);var i=e.tagGroup.element.ownerDocument.defaultView.getComputedStyle(e.tagGroup.element);if(i){var a=i.getPropertyValue("--zindex").trim()||0;a=parseInt(a);var o=e.tagGroup.element.parentElement;a<0&&o.insertBefore(e.tagGroup.element,o.firstChild),a>0&&o.insertBefore(e.tagGroup.element,null)}}return e}renderLinkageGroup(e,t,r){var n=e.group(),i=t.location_for_monosaccharide(r);return n.element.setAttributeNS(c,"glycanjs:location",i),n.element.setAttribute("part","linkage_".concat(i)),n}renderLinkageLabel(e,t,r,n,i,a,o){var s=e.text(t,r,n);return s.setAttribute("font-size",u(Math.floor(100/3))),s.firstChild.setAttribute("dy","0.75em"),!i&&a<0&&s.setAttribute("text-anchor","end"),i&&o&&s.setAttribute("text-anchor","end"),i&&a<0&&s.firstChild.setAttribute("dy","0em"),s}removeRendered(e){e.residue&&e.residue.element.parentNode.removeChild(e.residue.element),e.linkage&&(e.linkage.element?e.linkage.element.parentNode.removeChild(e.linkage.element):e.linkage.parentNode.removeChild(e.linkage))}renderIcon(e,t,r,n){var i=this.icon_prefix?"".concat(this.icon_prefix,"_"):"",a=e.use("#".concat(i).concat(t),0,0,1,1),o=n.location_for_monosaccharide(r);return a.setAttributeNS(c,"glycanjs:identifier",r.identifier),a.setAttributeNS(c,"glycanjs:location",o),a.setAttributeNS(c,"glycanjs:parent",r.parent?n.location_for_monosaccharide(r.parent):""),a.setAttribute("part","residue_location_".concat(o)),{element:a}}setIconPosition(e,t,r,n,i,a){var o="";0!==a&&(o="rotate(".concat(u(a),",").concat(u(t+n/2),",").concat(u(r+i/2),")"));var s="".concat(o," translate(").concat(u(t),",").concat(u(r),") scale(").concat(u(n),",").concat(u(i),")");e.element.setAttribute("transform",s)}screenCoordinatesFromLayout(e){var t=this.element.canvas,r=t.createSVGPoint(),n=e.x+e.width,i=e.y+e.height;r.x=100*e.x,r.y=100*e.y;var a=r.matrixTransform(t.getScreenCTM());return e.x=a.x,e.y=a.y,r.x=100*n,r.y=100*i,a=r.matrixTransform(t.getScreenCTM()),e.width=a.x-e.x,e.height=a.y-e.y,e}scaleToFit(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=this.element.canvas,r=t.getBBox(),n=[r.x-100*e.side,r.y-100*e.top,r.width+200*e.side,r.height+200*e.top];t.setAttribute("viewBox",n.join(" ")),t.setAttribute("preserveAspectRatio","xMidYMid meet")}}n=class extends g{layoutFor(e){var{x:t,y:r,width:n,height:i}=this.rendered.get(e).residue.element.getBoundingClientRect();return{x:t,y:r,width:n,height:i}}screenCoordinatesFromLayout(e){return e}},g.DEFAULT_PADDING=h,t.a=g}).call(this,r(8))},function(e,t,r){"use strict";r.r(t),t.default='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="50 50 500 1300">\n\x3c!--\nRGB settings for SNFG\nWhite  #fff\nBlue  #0090bc\nGreen  #00a651\nYellow  #ffd400\nLight blue  #8fcce9\nPink  #f69ea1\nPurple  #a54399\nBrown  #a17a4d\nOrange  #f47920\nRed  #ed1c24\n--\x3e\n  <defs>\n    <symbol id="hexnac_base" viewBox="0 0 100 100">\n      <rect x="10" y="10" width="80" height="80" style="fill: var(--fill-color); stroke: var(--stroke-color); stroke-width: var(--stroke-width);" />\n    </symbol>\n    <symbol id="hex_base" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" r="40" style="fill: var(--fill-color); stroke: var(--stroke-color); stroke-width: var(--stroke-width);"/>\n    </symbol>\n    <symbol id="sia_base" viewBox="0 0 100 100">\n      <path d="M50,5 95,50 50,95 5,50 z" style="fill: var(--fill-color); stroke: var(--stroke-color); stroke-width: var(--stroke-width);"/>\n    </symbol>\n    <symbol id="hexnac" viewBox="0 0 100 100">\n      <rect x="10" y="10" width="80" height="80" fill="#fff" stroke-width="3" stroke="#000"/>\n    </symbol>\n    <symbol id="galnac" viewBox="0 0 100 100">\n      <rect x="10" y="10" width="80" height="80" fill="#ffd400" stroke-width="1" stroke="#000"/>\n    </symbol>\n    <symbol id="glcnac" viewBox="0 0 100 100">\n      <rect x="10" y="10" width="80" height="80" fill="#0090bc" stroke-width="1" stroke="#000"/>\n    </symbol>\n    <symbol id="mannac" viewBox="0 0 100 100">\n      <rect x="10" y="10" width="80" height="80" fill="#00a651" stroke-width="1" stroke="#000"/>\n    </symbol>\n    <symbol id="man" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" fill="#00a651" r="40" stroke-width="1" stroke="#000"/>\n    </symbol>\n    <symbol id="man6p" viewBox="0 0 100 100">\n      <circle cx="50" cy="75" fill="#00a651" r="20" stroke-width="1" stroke="#000"/>\n      <text x="50" y="25" text-anchor="middle" stroke="#000" stroke-width="2" dy=".35em" dx="0.05em" font-size="25">P</text>\n    </symbol>\n    <symbol id="glc" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" fill="#0090bc" r="40" stroke-width="1" stroke="#000"/>\n    </symbol>\n    <symbol id="gal" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" fill="#ffd400" r="40" stroke-width="1" stroke="#000"/>\n    </symbol>\n    <symbol id="hex" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" fill="#fff" r="40" stroke-width="3" stroke="#000"/>\n    </symbol>\n    <symbol id="l-hex" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" fill="#fff" r="40" stroke-width="3" stroke="#000"/>\n      <path d="M28.6,36.92h2.75l-3.8,23.85h10.29l-.51,3.23h-13.04l4.31-27.08Z" fill="#fff"/>\n    </symbol>\n    <symbol id="d-hex" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" fill="#fff" r="40" stroke-width="3" stroke="#000"/>\n      <path d="M26.37,36.92h8.23c2.79,0,4.75,1.32,5.86,3.96,1,2.38,1.19,5.44.59,9.16-.45,2.88-1.27,5.47-2.46,7.8-2.07,4.1-4.85,6.16-8.34,6.16h-8.2l4.31-27.08ZM30.23,60.87c.93,0,1.71-.13,2.35-.39,1.14-.48,2.17-1.4,3.07-2.76.72-1.09,1.33-2.49,1.84-4.2.3-1.02.53-1.96.66-2.84.53-3.35.45-5.95-.26-7.81s-2.17-2.78-4.39-2.78h-4.88l-3.3,20.77h4.91Z" fill="#fff"/>\n    </symbol>\n    <symbol id="neu" viewBox="0 0 100 100">\n      <path d="M50,5 95,50 50,95 5,50 z" fill="#ed1c24" stroke="#000" stroke-width="1"/>\n    </symbol>\n    <symbol id="neuac" viewBox="0 0 100 100">\n      <path d="M50,5 95,50 50,95 5,50 z" fill="#a54399" stroke="#000" stroke-width="1"/>\n    </symbol>\n    <symbol id="neugc" viewBox="0 0 100 100">\n      <path d="M50,5 95,50 50,95 5,50 z" fill="#8fcce9" stroke="#000" stroke-width="1"/>\n    </symbol>\n    <symbol id="fuc" viewBox="0 0 100 100">\n      <path d="M50,15 90,90 10,90 z" fill="#ed1c24" stroke="#000" stroke-width="1"/>\n    </symbol>\n    <symbol id="d-fuc" viewBox="0 0 100 100">\n      <path d="M50,15 90,90 10,90 z" fill="#ed1c24" stroke="#000" stroke-width="1"/>\n        <path d="M32.37,48.92h8.23c2.79,0,4.75,1.32,5.86,3.96,1,2.38,1.19,5.44.59,9.16-.45,2.88-1.27,5.47-2.46,7.8-2.07,4.1-4.85,6.16-8.34,6.16h-8.2l4.31-27.08ZM36.23,72.87c.93,0,1.71-.13,2.35-.39,1.14-.48,2.17-1.4,3.07-2.76.72-1.09,1.33-2.49,1.84-4.2.3-1.02.53-1.96.66-2.84.53-3.35.45-5.95-.26-7.81s-2.17-2.78-4.39-2.78h-4.88l-3.3,20.77h4.91Z" fill="#fff"/>\n    </symbol>\n    <symbol id="fucnac" viewBox="0 0 100 100">\n      <path d="M50,15 90,90 50,90 z" fill="#ed1c24" stroke="#000" stroke-width="1"/>\n      <path d="M50,15 50,90 10,90 z" fill="#fff" stroke="#000" stroke-width="1"/>\n    </symbol>\n    <symbol id="rha" viewBox="0 0 100 100">\n      <path d="M50,15 90,90 10,90 z" fill="#00a651" stroke="#000" stroke-width="1"/>\n    </symbol>\n    <symbol id="d-rha" viewBox="0 0 100 100">\n      <path d="M50,15 90,90 10,90 z" fill="#00a651" stroke="#000" stroke-width="1"/>\n        <path d="M32.37,48.92h8.23c2.79,0,4.75,1.32,5.86,3.96,1,2.38,1.19,5.44.59,9.16-.45,2.88-1.27,5.47-2.46,7.8-2.07,4.1-4.85,6.16-8.34,6.16h-8.2l4.31-27.08ZM36.23,72.87c.93,0,1.71-.13,2.35-.39,1.14-.48,2.17-1.4,3.07-2.76.72-1.09,1.33-2.49,1.84-4.2.3-1.02.53-1.96.66-2.84.53-3.35.45-5.95-.26-7.81s-2.17-2.78-4.39-2.78h-4.88l-3.3,20.77h4.91Z" fill="#fff"/>\n    </symbol>\n    <symbol id="ara" viewBox="0 0 100 100">\n<polyline fill="#00a651" stroke="#000" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="\n  67.802,60.462 78.803,94.32 50.001,69.823 21.196,94.322 32.199,60.462 3.386,39.531 38.999,39.534 50,5.678 61.002,39.536 96.615,39.539 67.804,60.462 "/>\n    </symbol>\n    <symbol id="d-ara" viewBox="0 0 100 100">\n      <polyline fill="#00a651" stroke="#000" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="\n  67.802,60.462 78.803,94.32 50.001,69.823 21.196,94.322 32.199,60.462 3.386,39.531 38.999,39.534 50,5.678 61.002,39.536 96.615,39.539 67.804,60.462 "/>\n      <path d="M32.37,48.92h8.23c2.79,0,4.75,1.32,5.86,3.96,1,2.38,1.19,5.44.59,9.16-.45,2.88-1.27,5.47-2.46,7.8-2.07,4.1-4.85,6.16-8.34,6.16h-8.2l4.31-27.08ZM36.23,72.87c.93,0,1.71-.13,2.35-.39,1.14-.48,2.17-1.4,3.07-2.76.72-1.09,1.33-2.49,1.84-4.2.3-1.02.53-1.96.66-2.84.53-3.35.45-5.95-.26-7.81s-2.17-2.78-4.39-2.78h-4.88l-3.3,20.77h4.91Z" fill="#fff"/>\n    </symbol>\n    <symbol id="d-araf" viewBox="0 0 100 100">\n<polyline fill="#00a651" stroke="#000" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="\n  67.802,60.462 78.803,94.32 50.001,69.823 21.196,94.322 32.199,60.462 3.386,39.531 38.999,39.534 50,5.678 61.002,39.536 96.615,39.539 67.804,60.462 "/>\n    <path stroke="#fff" fill="#fff" stroke-width="0" d="M51.2,39.9L50.3,44h-3.6L46,47.5h3.6L44.8,70h4.3l4.8-22.6h4.4l0.7-3.5h-4.3c0.6-2.8,1.1-4.6,1.5-5.3\n      c0.4-0.7,1.3-1,2.6-1c0.2,0,0.4,0,0.6,0c0.2,0,0.5,0,1,0.1l0.9-4c-0.4,0-0.7-0.1-1-0.1c-0.3,0-0.6,0-0.9,0c-2.9,0-5.1,0.7-6.4,2.2\n      C52.3,36.8,51.7,38.1,51.2,39.9z"/>\n      <path d="M32.37,48.92h8.23c2.79,0,4.75,1.32,5.86,3.96,1,2.38,1.19,5.44.59,9.16-.45,2.88-1.27,5.47-2.46,7.8-2.07,4.1-4.85,6.16-8.34,6.16h-8.2l4.31-27.08ZM36.23,72.87c.93,0,1.71-.13,2.35-.39,1.14-.48,2.17-1.4,3.07-2.76.72-1.09,1.33-2.49,1.84-4.2.3-1.02.53-1.96.66-2.84.53-3.35.45-5.95-.26-7.81s-2.17-2.78-4.39-2.78h-4.88l-3.3,20.77h4.91Z" fill="#fff"/>\n    </symbol>\n    <symbol id="araf" viewBox="0 0 100 100">\n<polyline fill="#00a651" stroke="#000" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="\n  67.802,60.462 78.803,94.32 50.001,69.823 21.196,94.322 32.199,60.462 3.386,39.531 38.999,39.534 50,5.678 61.002,39.536 96.615,39.539 67.804,60.462 "/>\n    <path stroke="#fff" fill="#fff" stroke-width="0" d="M51.2,39.9L50.3,44h-3.6L46,47.5h3.6L44.8,70h4.3l4.8-22.6h4.4l0.7-3.5h-4.3c0.6-2.8,1.1-4.6,1.5-5.3\n      c0.4-0.7,1.3-1,2.6-1c0.2,0,0.4,0,0.6,0c0.2,0,0.5,0,1,0.1l0.9-4c-0.4,0-0.7-0.1-1-0.1c-0.3,0-0.6,0-0.9,0c-2.9,0-5.1,0.7-6.4,2.2\n      C52.3,36.8,51.7,38.1,51.2,39.9z"/>\n    </symbol>\n    <symbol id="galf" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" fill="#ffd400" r="40" stroke-width="1" stroke="#000"/>\n      <path stroke="#fff" fill="#fff" stroke-width="0" d="M51.2,39.9L50.3,44h-3.6L46,47.5h3.6L44.8,70h4.3l4.8-22.6h4.4l0.7-3.5h-4.3c0.6-2.8,1.1-4.6,1.5-5.3\n        c0.4-0.7,1.3-1,2.6-1c0.2,0,0.4,0,0.6,0c0.2,0,0.5,0,1,0.1l0.9-4c-0.4,0-0.7-0.1-1-0.1c-0.3,0-0.6,0-0.9,0c-2.9,0-5.1,0.7-6.4,2.2\n        C52.3,36.8,51.7,38.1,51.2,39.9z"/>\n    </symbol>\n    <symbol id="d-galf" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" fill="#ffd400" r="40" stroke-width="1" stroke="#000"/>\n      <path stroke="#fff" fill="#fff" stroke-width="0" d="M51.2,39.9L50.3,44h-3.6L46,47.5h3.6L44.8,70h4.3l4.8-22.6h4.4l0.7-3.5h-4.3c0.6-2.8,1.1-4.6,1.5-5.3\n        c0.4-0.7,1.3-1,2.6-1c0.2,0,0.4,0,0.6,0c0.2,0,0.5,0,1,0.1l0.9-4c-0.4,0-0.7-0.1-1-0.1c-0.3,0-0.6,0-0.9,0c-2.9,0-5.1,0.7-6.4,2.2\n        C52.3,36.8,51.7,38.1,51.2,39.9z"/>\n      <path d="M26.37,36.92h8.23c2.79,0,4.75,1.32,5.86,3.96,1,2.38,1.19,5.44.59,9.16-.45,2.88-1.27,5.47-2.46,7.8-2.07,4.1-4.85,6.16-8.34,6.16h-8.2l4.31-27.08ZM30.23,60.87c.93,0,1.71-.13,2.35-.39,1.14-.48,2.17-1.4,3.07-2.76.72-1.09,1.33-2.49,1.84-4.2.3-1.02.53-1.96.66-2.84.53-3.35.45-5.95-.26-7.81s-2.17-2.78-4.39-2.78h-4.88l-3.3,20.77h4.91Z" fill="#fff"/>\n    </symbol>\n    <symbol id="xyl" viewBox="0 0 100 100">\n<polyline fill="#f47920" stroke="#000" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="\n  67.802,60.462 78.803,94.32 50.001,69.823 21.196,94.322 32.199,60.462 3.386,39.531 38.999,39.534 50,5.678 61.002,39.536 96.615,39.539 67.804,60.462 "/>\n    </symbol>\n    <symbol id="rib" viewBox="0 0 100 100">\n<polyline fill="#f69ea1" stroke="#000" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="\n  67.802,60.462 78.803,94.32 50.001,69.823 21.196,94.322 32.199,60.462 3.386,39.531 38.999,39.534 50,5.678 61.002,39.536 96.615,39.539 67.804,60.462 "/>\n    </symbol>\n    <symbol id="rbo" viewBox="0 0 100 100">\n<polyline fill="#f69ea1" stroke="#000" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="\n  67.802,60.462 78.803,94.32 50.001,69.823 21.196,94.322 32.199,60.462 3.386,39.531 38.999,39.534 50,5.678 61.002,39.536 96.615,39.539 67.804,60.462 "/>\n    <path stroke="#fff" fill="#fff" d="M52.7,48.3c-0.9-1.1-2.2-1.7-3.9-1.7c-1.9,0-3.5,0.7-4.9,2c-1.4,1.3-2.3,3.1-2.8,5.2\n      c-0.4,2.1-0.2,3.7,0.5,4.9c0.8,1.2,2.1,1.8,3.9,1.8c2.2,0,3.9-0.7,5.2-2.1c1.3-1.4,2.2-3.1,2.6-5.2C53.8,51.1,53.6,49.4,52.7,48.3\n      z M49.4,57c-0.8,1.1-1.9,1.7-3.4,1.7c-1.3,0-2.2-0.5-2.6-1.4c-0.4-0.9-0.5-2.1-0.2-3.5c0.3-1.4,0.9-2.7,1.7-3.7\n      c0.8-1,1.9-1.5,3.3-1.5c1.5,0,2.5,0.6,2.8,1.8c0.2,0.8,0.2,1.8,0,3C50.7,54.7,50.2,55.9,49.4,57z"/>\n    <path stroke="#fff" fill="#fff" d="M54.6,60.1h2.2l3.8-17.9h-2.2L54.6,60.1z"/>\n    </symbol>\n    <symbol id="hexa" viewBox="0 0 100 100">\n      <polyline transform="rotate(90,50,50)" fill="#fff" stroke="#000" stroke-width="1" points="50,5 95,50 5,50 50,5"/>\n      <polyline transform="rotate(90,50,50)" fill="#fff" stroke="#000" stroke-width="1" points="50,95 95,50 5,50 50,95"/>\n    </symbol>\n    <symbol id="glca" viewBox="0 0 100 100">\n      <polyline transform="rotate(90,50,50)" fill="#0090bc" stroke="#000" stroke-width="1" points="50,5 95,50 5,50 50,5"/>\n      <polyline transform="rotate(90,50,50)" fill="#fff" stroke="#000" stroke-width="1" points="50,95 95,50 5,50 50,95"/>\n    </symbol>\n    <symbol id="gala" viewBox="0 0 100 100">\n      <polyline transform="rotate(90,50,50)" fill="#ffd400" stroke="#000" stroke-width="1" points="50,5 95,50 5,50 50,5"/>\n      <polyline transform="rotate(90,50,50)" fill="#fff" stroke="#000" stroke-width="1" points="50,95 95,50 5,50 50,95"/>\n    </symbol>\n    <symbol id="glcn" viewBox="0 0 100 100">\n      <polyline fill="#0090bc" stroke="#000" stroke-width="1" points="10,10 90,10 90,90 10,10"/>\n      <polyline fill="#fff" stroke="#000" stroke-width="1" points="10,10 90,90 10,90 10,10"/>\n    </symbol>\n    <symbol id="idoa" viewBox="0 0 100 100">\n      <polyline transform="rotate(90,50,50)" fill="#fff" stroke="#000" stroke-width="1" points="50,5 95,50 5,50 50,5"/>\n      <polyline transform="rotate(90,50,50)" fill="#a17a4d" stroke="#000" stroke-width="1" points="50,95 95,50 5,50 50,95"/>\n    </symbol>\n    <symbol id="cer" viewBox="0 0 100 100">\n      <path fill="#fff" stroke="#000" stroke-width="4" stroke-linecap="round" d="M35.8,15 64.2,15 75.5,27.2 64.2,38.3 75.5,50 64.2,61.1 75.5,72 64.2,83 75.5,94 L75.5,110 L35.8,110"/>\n      <path fill="#fff" stroke="#999" stroke-width="4" stroke-linecap="round"  d="M35.8,15 24.5,27.2 35.8,38.3 24.5,50 35.8,61.1 24.5,72 35.8,83 24.5,94"/>\n    </symbol>\n    \x3c!--\n    <symbol id="man(a1-2)man" viewBox="0 0 100 100">\n      <svg viewBox="0 0 100 100" x="0" y="0" width="100" height="50">\n        <circle cx="50" cy="50" fill="#00a651" r="40" stroke-width="1" stroke="#000"/>\n      </svg>\n      <svg viewBox="0 0 100 100" x="0" y="50" width="100" height="50">\n        <circle cx="50" cy="50" fill="#00a651" r="40" stroke-width="1" stroke="#000"/>\n      </svg>\n    </symbol>\n    <symbol id="neuac(a2-3)gal(b1-3)galnac" viewBox="0 0 100 100">\n      <svg viewBox="0 0 100 100" x="0" y="0" width="100" height="33">\n        <rect x="17" y="17" transform="rotate(45,50,50)" fill="#a54399" stroke="#000" stroke-width="1" width="66" height="66"/>\n      </svg>\n      <svg viewBox="0 0 100 100" x="0" y="33" width="100" height="33">\n        <circle cx="50" cy="50" fill="#ffd400" r="40" stroke-width="1" stroke="#000"/>\n      </svg>\n      <svg viewBox="0 0 100 100" x="0" y="66" width="100" height="33">\n        <rect x="10" y="10" width="80" height="80" fill="#ffd400" stroke-width="1" stroke="#000"/>\n      </svg>\n    </symbol>\n    <symbol id="gal(b1-3)galnac" viewBox="0 0 100 100">\n      <svg viewBox="0 0 100 100" x="0" y="0" width="100" height="50">\n        <circle cx="50" cy="50" fill="#ffd400" r="40" stroke-width="1" stroke="#000"/>\n      </svg>\n      <svg viewBox="0 0 100 100" x="0" y="50" width="100" height="50">\n        <rect x="10" y="10" width="80" height="80" fill="#ffd400" stroke-width="1" stroke="#000"/>\n      </svg>\n    </symbol>\n    <symbol id="glcnac(b1-4)glcnac" viewBox="0 0 100 100">\n      <svg viewBox="0 0 100 100" x="0" y="0" width="100" height="50">\n        <rect x="10" y="10" width="80" height="80" fill="#0090bc" stroke-width="1" stroke="#000"/>\n      </svg>\n      <svg viewBox="0 0 100 100" x="0" y="50" width="100" height="50">\n        <rect x="10" y="10" width="80" height="80" fill="#0090bc" stroke-width="1" stroke="#000"/>\n      </svg>\n    </symbol>\n    <symbol id="man(a1-3)[man(a1-6)]man(b1-4)glcnac(b1-4)glcnac" viewBox="0 0 100 100">\n      <svg viewBox="0 0 100 100" x="50" y="0" width="25" height="25">\n        <circle cx="50" cy="50" fill="#00a651" r="40" stroke-width="1" stroke="#000"/>\n      </svg>\n      <svg viewBox="0 0 100 100" x="25" y="0" width="25" height="25">\n        <circle cx="50" cy="50" fill="#00a651" r="40" stroke-width="1" stroke="#000"/>\n      </svg>\n      <svg viewBox="0 0 100 100" x="37.5" y="25" width="25" height="25">\n        <circle cx="50" cy="50" fill="#00a651" r="40" stroke-width="1" stroke="#000"/>\n      </svg>\n      <svg viewBox="0 0 100 100" x="37.5" y="50" width="25" height="25">\n        <rect x="10" y="10" width="80" height="80" fill="#0090bc" stroke-width="1" stroke="#000"/>\n      </svg>\n      <svg viewBox="0 0 100 100" x="37.5" y="75" width="25" height="25">\n        <rect x="10" y="10" width="80" height="80" fill="#0090bc" stroke-width="1" stroke="#000"/>\n      </svg>\n    </symbol>\n    <symbol id="glcnac(b1-4)glcnac.potential" viewBox="0 0 100 100">\n      <svg viewBox="0 0 100 100" x="0" y="0" width="100" height="50">\n        <rect x="10" y="10" width="80" height="80" fill="#67a2fc" stroke-width="0" stroke="#000"/>\n      </svg>\n      <svg viewBox="0 0 100 100" x="0" y="50" width="100" height="50">\n        <rect x="10" y="10" width="80" height="80" fill="#67a2fc" stroke-width="0" stroke="#000"/>\n      </svg>\n    </symbol>\n    --\x3e\n    <symbol id="phospho" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" fill="#fff" r="48" stroke-width="3" stroke="#000"/>\n      <text x="50" y="50" text-anchor="middle" stroke="#000" stroke-width="2" dy=".35em" dx="0.05em" font-size="50">P</text>\n    </symbol>\n    <symbol id="hso3" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" fill="#fdbbbb" r="35" stroke-width="4" stroke="#aa3030"/>\n      <path fill="#aa3030" stroke="none" stroke-width="2" d="M38.8,62.4c1.2,1.9,3,3.3,5.2,4.3c2.2,0.9,4.9,1.4,8.1,1.4c2.6,0,4.9-0.5,6.9-1.4c2-0.9,3.6-2.2,4.7-3.9\n        c1.1-1.7,1.6-3.5,1.6-5.4c0-1.9-0.5-3.6-1.5-5.1c-1-1.5-2.5-2.7-4.6-3.6c-1.4-0.7-4.1-1.4-7.9-2.3c-3.8-0.9-6.2-1.7-7.1-2.6\n        c-0.9-0.8-1.4-1.9-1.4-3.2c0-1.5,0.7-2.7,2-3.8c1.3-1,3.4-1.6,6.3-1.6c2.8,0,4.8,0.6,6.2,1.7c1.4,1.2,2.2,2.9,2.5,5.1l4.5-0.3\n        c-0.1-2.1-0.7-4-1.8-5.6c-1.1-1.7-2.6-2.9-4.7-3.8s-4.4-1.3-7-1.3c-2.4,0-4.6,0.4-6.6,1.2c-2,0.8-3.5,2-4.5,3.6\n        c-1,1.6-1.5,3.3-1.5,5.1c0,1.6,0.4,3.1,1.3,4.5c0.8,1.3,2.1,2.4,3.8,3.3c1.3,0.7,3.6,1.4,6.9,2.2c3.3,0.8,5.4,1.4,6.4,1.7\n        c1.5,0.6,2.6,1.3,3.2,2.1c0.7,0.8,1,1.8,1,2.9c0,1.1-0.3,2.1-1,3.1c-0.7,0.9-1.7,1.7-3.1,2.2c-1.4,0.5-3,0.8-4.8,0.8\n        c-2,0-3.9-0.4-5.5-1.1c-1.6-0.7-2.8-1.6-3.6-2.8c-0.8-1.1-1.3-2.6-1.5-4.4L36.8,56C36.9,58.4,37.5,60.5,38.8,62.4z"/>\n    </symbol>\n    <symbol id="hso3.2" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" fill="#fdbbbb" r="35" stroke-width="4" stroke="#aa3030"/>\n      <path fill="#aa3030" stroke="none" stroke-width="2" d="M36.9,58.1c0.3-0.5,0.7-1,1.1-1.4s1.5-1.4,3-2.7c1.9-1.6,3.2-2.9,4.1-3.8s1.4-1.8,1.8-2.6s0.5-1.7,0.5-2.5\n        c0-1.7-0.6-3.1-1.8-4.2S42.8,39,40.7,39c-2,0-3.7,0.5-4.9,1.6s-1.9,2.6-2.1,4.6l2.7,0.3c0-1.3,0.4-2.4,1.2-3.2s1.8-1.1,3-1.1\n        c1.2,0,2.2,0.4,2.9,1.1s1.1,1.6,1.1,2.6c0,1-0.4,2.1-1.2,3.2s-2.4,2.6-4.7,4.5c-1.5,1.2-2.7,2.3-3.5,3.3s-1.4,1.9-1.7,2.9\n        c-0.2,0.6-0.3,1.2-0.3,1.8h14.2v-2.5H36.9z"/>\n      <path fill="#aa3030" stroke="none" stroke-width="2" d="M51.5,57.6c0.7,1.1,1.8,2,3.1,2.6s2.9,0.8,4.9,0.8c1.5,0,2.9-0.3,4.1-0.8s2.2-1.3,2.8-2.4s1-2.1,1-3.2\n        c0-1.2-0.3-2.2-0.9-3.1s-1.5-1.6-2.8-2.2c-0.9-0.4-2.4-0.8-4.8-1.4s-3.7-1-4.3-1.5c-0.6-0.5-0.8-1.1-0.8-1.9\n        c0-0.9,0.4-1.6,1.2-2.3s2-0.9,3.8-0.9c1.7,0,2.9,0.3,3.7,1s1.3,1.7,1.5,3.1l2.7-0.2c0-1.3-0.4-2.4-1.1-3.4S64.2,40,63,39.5\n        s-2.6-0.8-4.2-0.8c-1.4,0-2.8,0.2-3.9,0.7s-2.1,1.2-2.7,2.1s-0.9,2-0.9,3c0,1,0.3,1.9,0.8,2.7s1.3,1.5,2.3,2\n        c0.8,0.4,2.2,0.9,4.1,1.3s3.2,0.8,3.8,1c0.9,0.3,1.5,0.8,1.9,1.3s0.6,1.1,0.6,1.8c0,0.7-0.2,1.3-0.6,1.8s-1,1-1.9,1.3\n        s-1.8,0.5-2.9,0.5c-1.2,0-2.3-0.2-3.3-0.6s-1.7-1-2.2-1.7s-0.8-1.6-0.9-2.6l-2.7,0.2C50.4,55.1,50.8,56.4,51.5,57.6z"/>\n    </symbol>\n    <symbol id="hso3.3" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" fill="#fdbbbb" r="35" stroke-width="4" stroke="#aa3030"/>\n      <path fill="#aa3030" stroke="none" stroke-width="2" d="M35.7,59.3c1.2,1.1,2.8,1.7,4.7,1.7c2.1,0,3.8-0.7,5.2-2s2.1-2.9,2.1-4.8c0-1.4-0.4-2.5-1.1-3.5\n        s-1.7-1.5-3-1.8c1-0.4,1.7-1.1,2.2-1.8s0.7-1.6,0.7-2.5c0-1-0.3-1.9-0.8-2.8s-1.3-1.6-2.3-2.1S41.5,39,40.3,39\n        c-1.7,0-3.1,0.5-4.3,1.5s-1.9,2.3-2.2,4.1l2.6,0.5c0.2-1.3,0.6-2.3,1.3-2.9s1.5-1,2.6-1c1,0,1.9,0.3,2.5,1s1,1.4,1,2.4\n        c0,1.2-0.4,2.1-1.3,2.7s-1.9,0.9-3,0.9c-0.1,0-0.2,0-0.4,0l-0.3,2.3c0.7-0.2,1.4-0.3,1.9-0.3c1.2,0,2.2,0.4,3,1.2s1.2,1.8,1.2,3\n        c0,1.3-0.4,2.3-1.3,3.2s-1.9,1.3-3.1,1.3c-1,0-1.9-0.3-2.7-1s-1.2-1.7-1.5-3.2l-2.6,0.4C33.8,56.7,34.5,58.2,35.7,59.3z"/>\n      <path fill="#aa3030" stroke="none" stroke-width="2" d="M51.5,57.6c0.7,1.1,1.8,2,3.1,2.6s2.9,0.8,4.9,0.8c1.5,0,2.9-0.3,4.1-0.8s2.2-1.3,2.8-2.4s1-2.1,1-3.2\n        c0-1.2-0.3-2.2-0.9-3.1s-1.5-1.6-2.8-2.2c-0.9-0.4-2.4-0.8-4.8-1.4s-3.7-1-4.3-1.5c-0.6-0.5-0.8-1.1-0.8-1.9\n        c0-0.9,0.4-1.6,1.2-2.3s2-0.9,3.8-0.9c1.7,0,2.9,0.3,3.7,1s1.3,1.7,1.5,3.1l2.7-0.2c0-1.3-0.4-2.4-1.1-3.4S64.2,40,63,39.5\n        s-2.6-0.8-4.2-0.8c-1.4,0-2.8,0.2-3.9,0.7s-2.1,1.2-2.7,2.1s-0.9,2-0.9,3c0,1,0.3,1.9,0.8,2.7s1.3,1.5,2.3,2\n        c0.8,0.4,2.2,0.9,4.1,1.3s3.2,0.8,3.8,1c0.9,0.3,1.5,0.8,1.9,1.3s0.6,1.1,0.6,1.8c0,0.7-0.2,1.3-0.6,1.8s-1,1-1.9,1.3\n        s-1.8,0.5-2.9,0.5c-1.2,0-2.3-0.2-3.3-0.6s-1.7-1-2.2-1.7s-0.8-1.6-0.9-2.6l-2.7,0.2C50.4,55.1,50.8,56.4,51.5,57.6z"/>\n    </symbol>\n    <symbol id="hso3.4" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" fill="#fdbbbb" r="35" stroke-width="4" stroke="#aa3030"/>\n      <path fill="#aa3030" stroke="none" stroke-width="2" d="M44.6,60.6v-5.1h2.9V53h-2.9V39.1h-2.2L32.7,53v2.4H42v5.1H44.6z M35.3,53l6.7-9.7V53H35.3z"/>\n      <path fill="#aa3030" stroke="none" stroke-width="2" d="M51.5,57.5c0.7,1.1,1.8,2,3.1,2.6s2.9,0.8,4.9,0.8c1.5,0,2.9-0.3,4.1-0.8c1.2-0.6,2.2-1.3,2.8-2.4\n        s1-2.1,1-3.2c0-1.2-0.3-2.2-0.9-3.1s-1.5-1.6-2.8-2.2c-0.9-0.4-2.4-0.8-4.8-1.4c-2.3-0.5-3.7-1-4.3-1.5c-0.6-0.5-0.8-1.1-0.8-1.9\n        c0-0.9,0.4-1.6,1.2-2.3s2-0.9,3.8-0.9c1.7,0,2.9,0.3,3.7,1s1.3,1.7,1.5,3.1l2.7-0.2c0-1.3-0.4-2.4-1.1-3.4s-1.6-1.8-2.8-2.3\n        s-2.6-0.8-4.2-0.8c-1.4,0-2.8,0.2-3.9,0.7s-2.1,1.2-2.7,2.1s-0.9,2-0.9,3c0,1,0.3,1.9,0.8,2.7s1.3,1.5,2.3,2\n        c0.8,0.4,2.2,0.9,4.1,1.3s3.2,0.8,3.8,1c0.9,0.3,1.5,0.8,1.9,1.3s0.6,1.1,0.6,1.8c0,0.7-0.2,1.3-0.6,1.8s-1,1-1.9,1.3\n        s-1.8,0.5-2.9,0.5c-1.2,0-2.3-0.2-3.3-0.6s-1.7-1-2.2-1.7s-0.8-1.6-0.9-2.6l-2.7,0.2C50.4,55.1,50.8,56.4,51.5,57.5z"/>\n    </symbol>\n    <symbol id="hso3.6" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" fill="#fdbbbb" r="35" stroke-width="4" stroke="#aa3030"/>\n      <path fill="#aa3030" stroke="none" stroke-width="2" d="M45.4,40.4c-1.1-0.9-2.5-1.4-4.2-1.4c-2.3,0-4.1,0.8-5.4,2.5c-1.5,1.9-2.3,4.9-2.3,9.1c0,3.7,0.7,6.4,2.1,8\n        s3.2,2.4,5.4,2.4c1.3,0,2.4-0.3,3.5-0.9s1.8-1.5,2.4-2.7s0.9-2.4,0.9-3.8c0-2.1-0.6-3.7-1.9-5s-2.7-1.9-4.5-1.9\n        c-1,0-2,0.2-2.9,0.7s-1.7,1.2-2.3,2.2c0-2.1,0.3-3.8,0.7-5s1.1-2,2-2.7c0.6-0.5,1.4-0.7,2.2-0.7c1,0,1.9,0.4,2.6,1.1\n        c0.4,0.5,0.8,1.2,1,2.3l2.6-0.2C47.1,42.7,46.5,41.4,45.4,40.4z M37.8,50.2c0.8-0.9,1.8-1.3,3-1.3c1.2,0,2.2,0.4,3,1.3\n        s1.2,2,1.2,3.5c0,1.5-0.4,2.8-1.2,3.7s-1.8,1.3-2.9,1.3c-0.8,0-1.5-0.2-2.2-0.7s-1.2-1.1-1.6-1.9s-0.6-1.7-0.6-2.6\n        C36.5,52.2,37,51.1,37.8,50.2z"/>\n      <path fill="#aa3030" stroke="none" stroke-width="2" d="M51.6,57.5c0.7,1.1,1.8,2,3.1,2.6s2.9,0.8,4.9,0.8c1.5,0,2.9-0.3,4.1-0.8c1.2-0.6,2.2-1.3,2.8-2.4\n        s1-2.1,1-3.2c0-1.2-0.3-2.2-0.9-3.1s-1.5-1.6-2.8-2.2c-0.9-0.4-2.4-0.8-4.8-1.4s-3.7-1-4.3-1.5c-0.6-0.5-0.8-1.1-0.8-1.9\n        c0-0.9,0.4-1.6,1.2-2.3s2-0.9,3.8-0.9c1.7,0,2.9,0.3,3.7,1s1.3,1.7,1.5,3.1l2.7-0.2c0-1.3-0.4-2.4-1.1-3.4S64.2,40,63,39.5\n        c-1.2-0.5-2.6-0.8-4.2-0.8c-1.4,0-2.8,0.2-3.9,0.7s-2.1,1.2-2.7,2.1s-0.9,2-0.9,3c0,1,0.3,1.9,0.8,2.7s1.3,1.5,2.3,2\n        c0.8,0.4,2.2,0.9,4.1,1.3s3.2,0.8,3.8,1c0.9,0.3,1.5,0.8,1.9,1.3c0.4,0.5,0.6,1.1,0.6,1.8c0,0.7-0.2,1.3-0.6,1.8\n        c-0.4,0.6-1,1-1.9,1.3s-1.8,0.5-2.9,0.5c-1.2,0-2.3-0.2-3.3-0.6s-1.7-1-2.2-1.7s-0.8-1.6-0.9-2.6l-2.7,0.2\n        C50.5,55.1,50.9,56.4,51.6,57.5z"/>\n    </symbol>\n    <symbol id="hso3.N" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" fill="#fdbbbb" r="35" stroke-width="4" stroke="#aa3030"/>\n      <path fill="#aa3030" stroke="none" stroke-width="2" d="M34.9,60.6V43.7l11.3,16.9H49V39.1h-2.7v16.9L35,39.1h-2.9v21.5H34.9z"/>\n      <path fill="#aa3030" stroke="none" stroke-width="2" d="M54,57.5c0.7,1.1,1.8,2,3.1,2.6s2.9,0.8,4.9,0.8c1.5,0,2.9-0.3,4.1-0.8s2.2-1.3,2.8-2.4s1-2.1,1-3.2\n        c0-1.2-0.3-2.2-0.9-3.1s-1.5-1.6-2.8-2.2c-0.9-0.4-2.4-0.8-4.8-1.4s-3.7-1-4.3-1.5c-0.6-0.5-0.8-1.1-0.8-1.9\n        c0-0.9,0.4-1.6,1.2-2.3s2-0.9,3.8-0.9c1.7,0,2.9,0.3,3.7,1s1.3,1.7,1.5,3.1l2.7-0.2c0-1.3-0.4-2.4-1.1-3.4s-1.6-1.8-2.8-2.3\n        s-2.6-0.8-4.2-0.8c-1.4,0-2.8,0.2-3.9,0.7s-2.1,1.2-2.7,2.1s-0.9,2-0.9,3c0,1,0.3,1.9,0.8,2.7s1.3,1.5,2.3,2\n        c0.8,0.4,2.2,0.9,4.1,1.3s3.2,0.8,3.8,1c0.9,0.3,1.5,0.8,1.9,1.3s0.6,1.1,0.6,1.8c0,0.7-0.2,1.3-0.6,1.8s-1,1-1.9,1.3\n        c-0.8,0.3-1.8,0.5-2.9,0.5c-1.2,0-2.3-0.2-3.3-0.6s-1.7-1-2.2-1.7s-0.8-1.6-0.9-2.6l-2.7,0.2C52.9,55.1,53.3,56.4,54,57.5z"/>\n    </symbol>\n    <symbol id="me" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" r="35" fill="#f47920" stroke="#994a16" stroke-miterlimit="10" stroke-width="4"/>\n      <g>\n        <path d="M27.65,36.18h5.01l7.43,21.83,7.37-21.83h4.98v25.82h-3.34v-15.24c0-.53.01-1.4.04-2.62s.04-2.53.04-3.92l-7.37,21.78h-3.47l-7.44-21.78v.79c0,.63.02,1.6.05,2.89s.05,2.25.05,2.86v15.24h-3.34v-25.82Z" fill="#994a16"/>\n        <path d="M68.93,43.69c1.25.63,2.2,1.44,2.85,2.43.63.95,1.05,2.06,1.26,3.32.19.87.28,2.25.28,4.15h-13.69c.06,1.92.51,3.45,1.34,4.61.84,1.16,2.13,1.74,3.89,1.74,1.64,0,2.95-.55,3.92-1.64.55-.63.93-1.37,1.16-2.21h3.11c-.08.69-.35,1.46-.82,2.31s-.98,1.54-1.55,2.08c-.95.94-2.13,1.57-3.54,1.9-.76.19-1.61.28-2.56.28-2.33,0-4.3-.85-5.92-2.56-1.62-1.71-2.43-4.09-2.43-7.16s.82-5.48,2.45-7.37c1.63-1.89,3.76-2.83,6.39-2.83,1.33,0,2.61.31,3.86.94ZM70.07,51.08c-.13-1.37-.42-2.47-.89-3.29-.86-1.52-2.29-2.29-4.3-2.29-1.44,0-2.65.52-3.62,1.57-.98,1.05-1.49,2.38-1.55,4h10.37Z" fill="#994a16"/>\n      </g>\n    </symbol>\n    <symbol id="me.2" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" r="35" fill="#f47920" stroke="#994a16" stroke-miterlimit="10" stroke-width="4"/>\n      <path d="M24.63,55.59c.61-1.25,1.79-2.39,3.56-3.41l2.63-1.52c1.18-.69,2.01-1.27,2.48-1.76.75-.76,1.12-1.63,1.12-2.61,0-1.14-.34-2.05-1.03-2.73s-1.6-1.01-2.74-1.01c-1.69,0-2.86.64-3.51,1.92-.35.69-.54,1.64-.58,2.86h-2.51c.03-1.71.34-3.1.95-4.18,1.07-1.9,2.96-2.85,5.66-2.85,2.25,0,3.89.61,4.93,1.82,1.04,1.22,1.56,2.57,1.56,4.06,0,1.57-.55,2.91-1.66,4.03-.64.65-1.79,1.43-3.44,2.36l-1.88,1.04c-.9.49-1.6.96-2.11,1.41-.91.79-1.49,1.68-1.73,2.64h10.72v2.33h-13.47c.09-1.69.44-3.16,1.05-4.41Z" fill="#994a16"/>\n      <path d="M40.38,39.87h3.91l5.79,17.02,5.75-17.02h3.88v20.13h-2.6v-11.88c0-.41,0-1.09.03-2.04.02-.95.03-1.97.03-3.06l-5.75,16.98h-2.7l-5.8-16.98v.62c0,.49.01,1.24.04,2.25.03,1.01.04,1.75.04,2.23v11.88h-2.6v-20.13Z" fill="#994a16"/>\n      <path d="M72.56,45.73c.97.49,1.71,1.12,2.22,1.9.49.74.82,1.6.98,2.59.15.68.22,1.75.22,3.23h-10.67c.04,1.49.39,2.69,1.05,3.59s1.66,1.35,3.03,1.35c1.28,0,2.3-.43,3.06-1.28.43-.5.73-1.07.91-1.72h2.43c-.06.54-.28,1.14-.64,1.8-.36.66-.76,1.2-1.21,1.62-.74.73-1.66,1.22-2.76,1.48-.59.15-1.26.22-2,.22-1.82,0-3.35-.66-4.62-1.99-1.26-1.33-1.89-3.19-1.89-5.58s.64-4.27,1.91-5.74c1.27-1.47,2.93-2.21,4.98-2.21,1.04,0,2.04.24,3.01.73ZM73.45,51.49c-.1-1.07-.33-1.92-.69-2.56-.67-1.19-1.79-1.78-3.36-1.78-1.12,0-2.07.41-2.83,1.23-.76.82-1.16,1.86-1.21,3.12h8.08Z" fill="#994a16"/>\n    </symbol>\n    <symbol id="me.3" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" r="35" fill="#f47920" stroke="#994a16" stroke-miterlimit="10" stroke-width="4"/>\n      <path d="M24.94,58.62c-1.05-1.27-1.57-2.83-1.57-4.65h2.58c.11,1.27.35,2.19.71,2.77.64,1.03,1.8,1.55,3.47,1.55,1.3,0,2.34-.35,3.12-1.04.79-.69,1.18-1.59,1.18-2.69,0-1.35-.41-2.3-1.24-2.84s-1.98-.81-3.45-.81c-.16,0-.33,0-.5,0-.17,0-.34.01-.51.02v-2.18c.26.03.47.05.64.05.17,0,.36.01.56.01.92,0,1.68-.15,2.27-.44,1.04-.51,1.56-1.42,1.56-2.74,0-.98-.35-1.73-1.04-2.26-.69-.53-1.5-.79-2.43-.79-1.64,0-2.78.55-3.41,1.64-.35.6-.54,1.46-.59,2.58h-2.44c0-1.46.29-2.7.88-3.73,1-1.83,2.77-2.74,5.3-2.74,2,0,3.55.45,4.65,1.34,1.1.89,1.64,2.18,1.64,3.87,0,1.21-.32,2.18-.97,2.93-.4.47-.92.83-1.56,1.1,1.03.28,1.84.83,2.42,1.64.58.81.87,1.8.87,2.97,0,1.87-.62,3.4-1.85,4.58s-2.98,1.77-5.25,1.77-4-.64-5.05-1.91Z" fill="#994a16"/>\n      <path d="M40.38,39.87h3.91l5.79,17.02,5.75-17.02h3.88v20.13h-2.6v-11.88c0-.41,0-1.09.03-2.04.02-.95.03-1.97.03-3.06l-5.75,16.98h-2.7l-5.8-16.98v.62c0,.49.01,1.24.04,2.25.03,1.01.04,1.75.04,2.23v11.88h-2.6v-20.13Z" fill="#994a16"/>\n      <path d="M72.56,45.73c.97.49,1.71,1.12,2.22,1.9.49.74.82,1.6.98,2.59.15.68.22,1.75.22,3.23h-10.67c.04,1.49.39,2.69,1.05,3.59s1.66,1.35,3.03,1.35c1.28,0,2.3-.43,3.06-1.28.43-.5.73-1.07.91-1.72h2.43c-.06.54-.28,1.14-.64,1.8-.36.66-.76,1.2-1.21,1.62-.74.73-1.66,1.22-2.76,1.48-.59.15-1.26.22-2,.22-1.82,0-3.35-.66-4.62-1.99-1.26-1.33-1.89-3.19-1.89-5.58s.64-4.27,1.91-5.74c1.27-1.47,2.93-2.21,4.98-2.21,1.04,0,2.04.24,3.01.73ZM73.45,51.49c-.1-1.07-.33-1.92-.69-2.56-.67-1.19-1.79-1.78-3.36-1.78-1.12,0-2.07.41-2.83,1.23-.76.82-1.16,1.86-1.21,3.12h8.08Z" fill="#994a16"/>\n    </symbol>\n    <symbol id="me.4" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" r="35" fill="#f47920" stroke="#994a16" stroke-miterlimit="10" stroke-width="4"/>\n      <path d="M32.02,60v-4.8h-8.61v-2.41l8.99-12.47h2.08v12.73h2.89v2.15h-2.89v4.8h-2.47ZM31.98,53.05v-8.91l-6.29,8.91h6.29Z" fill="#994a16"/>\n      <path d="M40.38,39.87h3.91l5.79,17.02,5.75-17.02h3.88v20.13h-2.6v-11.88c0-.41,0-1.09.03-2.04.02-.95.03-1.97.03-3.06l-5.75,16.98h-2.7l-5.8-16.98v.62c0,.49.01,1.24.04,2.25.03,1.01.04,1.75.04,2.23v11.88h-2.6v-20.13Z" fill="#994a16"/>\n      <path d="M72.56,45.73c.97.49,1.71,1.12,2.22,1.9.49.74.82,1.6.98,2.59.15.68.22,1.75.22,3.23h-10.67c.04,1.49.39,2.69,1.05,3.59s1.66,1.35,3.03,1.35c1.28,0,2.3-.43,3.06-1.28.43-.5.73-1.07.91-1.72h2.43c-.06.54-.28,1.14-.64,1.8-.36.66-.76,1.2-1.21,1.62-.74.73-1.66,1.22-2.76,1.48-.59.15-1.26.22-2,.22-1.82,0-3.35-.66-4.62-1.99-1.26-1.33-1.89-3.19-1.89-5.58s.64-4.27,1.91-5.74c1.27-1.47,2.93-2.21,4.98-2.21,1.04,0,2.04.24,3.01.73ZM73.45,51.49c-.1-1.07-.33-1.92-.69-2.56-.67-1.19-1.79-1.78-3.36-1.78-1.12,0-2.07.41-2.83,1.23-.76.82-1.16,1.86-1.21,3.12h8.08Z" fill="#994a16"/>\n    </symbol>\n    <symbol id="p" viewBox="0 0 100 100">\n      <circle cx="50" cy="50" fill="#bbe5fa" r="35" stroke-width="4" stroke="#2f5fac"/>\n      <path fill="#2f5fac" stroke="none" stroke-width="2" d="M43.1,67.5V53h9.2c5.1,0,8.6-1.1,10.5-3.2c1.9-2.1,2.9-4.7,2.9-7.7c0-1.8-0.4-3.4-1.1-4.9\n        c-0.7-1.5-1.7-2.6-2.9-3.5c-1.2-0.8-2.7-1.4-4.4-1.7c-1.3-0.2-3.1-0.3-5.4-0.3H38.4v35.8H43.1z M43.1,36h9.2\n        c2.1,0,3.6,0.1,4.4,0.3c1.2,0.3,2.2,1,3,2.1c0.8,1.1,1.1,2.3,1.1,3.8c0,2.1-0.6,3.7-1.9,4.8c-1.3,1.1-3.5,1.7-6.5,1.7h-9.3V36z"/>\n    </symbol>\n    <symbol id="ser" viewBox="0 0 100 100">\n      <path d="M20,50 a1,1 0 0,0 30,0 a1,1 0 0,1 30,0" fill="none" stroke="#000" stroke-width="1"/>\n      <path d="M22.2,88.5c1,1.5,2.4,2.7,4.1,3.4c1.8,0.8,3.9,1.1,6.5,1.1c2,0,3.9-0.4,5.5-1.1c1.6-0.7,2.9-1.8,3.8-3.1\n        c0.9-1.3,1.3-2.8,1.3-4.3c0-1.5-0.4-2.9-1.2-4.1c-0.8-1.2-2-2.2-3.7-2.9c-1.1-0.5-3.3-1.1-6.3-1.8c-3.1-0.7-5-1.4-5.7-2\n        c-0.7-0.7-1.1-1.5-1.1-2.5c0-1.2,0.5-2.2,1.6-3c1-0.8,2.7-1.3,5-1.3c2.2,0,3.9,0.5,5,1.4c1.1,0.9,1.8,2.3,2,4.1l3.6-0.3\n        c-0.1-1.7-0.5-3.2-1.4-4.5c-0.9-1.3-2.1-2.3-3.7-3s-3.5-1-5.6-1c-1.9,0-3.7,0.3-5.3,1C25,65.1,23.8,66,23,67.3s-1.2,2.6-1.2,4.1\n        c0,1.3,0.3,2.5,1,3.6c0.7,1.1,1.7,2,3.1,2.7c1.1,0.6,2.9,1.2,5.5,1.8c2.6,0.6,4.3,1.1,5.1,1.4c1.2,0.5,2.1,1,2.6,1.7\n        c0.5,0.7,0.8,1.5,0.8,2.4c0,0.9-0.3,1.7-0.8,2.5c-0.5,0.7-1.4,1.3-2.5,1.8c-1.1,0.4-2.4,0.6-3.8,0.6c-1.6,0-3.1-0.3-4.4-0.8\n        c-1.3-0.6-2.3-1.3-2.9-2.2c-0.6-0.9-1-2.1-1.2-3.5l-3.6,0.3C20.7,85.3,21.2,87,22.2,88.5z"/>\n      <path d="M60.2,89.1c-0.9,0.7-2,1-3.3,1c-1.7,0-3.2-0.6-4.3-1.8c-1.2-1.2-1.8-3-1.9-5.2h15.5c0-0.4,0-0.7,0-0.9\n        c0-3.4-0.9-6.1-2.6-8s-4-2.8-6.8-2.8c-2.9,0-5.2,1-7,2.9S47,78.9,47,82.4c0,3.4,0.9,6,2.7,7.9s4.2,2.8,7.2,2.8\n        c2.4,0,4.4-0.6,5.9-1.8c1.5-1.2,2.6-2.8,3.2-4.9l-3.6-0.4C61.8,87.4,61.1,88.5,60.2,89.1z M52.6,75.9c1.1-1.1,2.5-1.6,4.1-1.6\n        c1.8,0,3.2,0.7,4.4,2c0.7,0.9,1.2,2.2,1.3,3.9H50.8C50.9,78.4,51.5,77,52.6,75.9z"/>\n      <path d="M73.9,92.6V81.7c0-1.5,0.2-2.9,0.6-4.1c0.3-0.8,0.7-1.5,1.3-1.9c0.6-0.5,1.3-0.7,2.1-0.7c0.9,0,1.7,0.3,2.6,0.8l1.2-3.3\n        c-1.2-0.8-2.4-1.1-3.6-1.1c-0.8,0-1.6,0.2-2.3,0.7s-1.4,1.4-2.2,2.9v-3.1h-3.2v20.7H73.9z"/>\n\n    </symbol>\n    <symbol id="thr" viewBox="0 0 100 100">\n      <path d="M20,50 a1,1 0 0,0 30,0 a1,1 0 0,1 30,0" fill="none" stroke="#000" stroke-width="1"/>\n      <path d="M34.1,92.6V67.3h9.5V64H20.9v3.4h9.4v25.3H34.1z"/>\n      <path d="M50.6,92.6V81.2c0-1.6,0.2-2.9,0.6-3.8s1-1.7,2-2.2s1.9-0.8,2.9-0.8c1.4,0,2.5,0.4,3.2,1.2s1.1,2.1,1.1,3.8v13.1h3.5V79.4\n        c0-2-0.2-3.6-0.7-4.6s-1.3-1.9-2.4-2.5s-2.5-0.9-4-0.9c-2.5,0-4.6,1-6.2,2.9V64H47v28.6H50.6z"/>\n      <path d="M72.8,92.6V81.7c0-1.5,0.2-2.9,0.6-4.1c0.3-0.8,0.7-1.5,1.3-1.9c0.6-0.5,1.3-0.7,2.1-0.7c0.9,0,1.7,0.3,2.6,0.8l1.2-3.3\n        c-1.2-0.8-2.4-1.1-3.6-1.1c-0.8,0-1.6,0.2-2.3,0.7s-1.4,1.4-2.2,2.9v-3.1h-3.2v20.7H72.8z"/>\n    </symbol>\n    <symbol id="asn" viewBox="0 0 100 100">\n      <path d="M20,50 a1,1 0 0,0 30,0 a1,1 0 0,1 30,0" fill="none" stroke="#000" stroke-width="1"/>\n      <path d="M19.4,92.6l3.1-8.7h12l3.3,8.7h4.3L30.5,64h-4.1l-11,28.6H19.4z M26.8,72.4c0.7-1.8,1.2-3.6,1.5-5.5\n        c0.4,1.5,1.1,3.5,2,5.9l3,7.9h-9.7L26.8,72.4z"/>\n      <path d="M46.1,91.4c1.4,1.1,3.5,1.7,6.2,1.7c1.6,0,3.1-0.3,4.4-0.8s2.3-1.4,3-2.4s1-2.1,1-3.3c0-1.2-0.3-2.2-0.8-3\n        c-0.6-0.8-1.3-1.4-2.3-1.8c-1-0.4-2.7-1-5.2-1.6c-1.7-0.5-2.8-0.8-3.1-0.9c-0.6-0.2-1.1-0.6-1.3-0.9c-0.3-0.4-0.4-0.8-0.4-1.2\n        c0-0.7,0.3-1.3,1-1.9c0.7-0.5,1.8-0.8,3.5-0.8c1.4,0,2.4,0.3,3.2,0.9c0.7,0.6,1.2,1.4,1.4,2.5l3.4-0.5c-0.2-1.3-0.6-2.4-1.2-3.2\n        s-1.5-1.4-2.7-1.9s-2.7-0.7-4.3-0.7c-1.1,0-2.1,0.1-3,0.4c-0.9,0.3-1.7,0.6-2.2,1c-0.7,0.5-1.3,1.2-1.7,2\n        c-0.4,0.8-0.6,1.6-0.6,2.6c0,1,0.3,1.9,0.8,2.8c0.5,0.8,1.3,1.5,2.3,2s2.8,1,5.4,1.7c1.9,0.5,3.1,0.9,3.6,1.2c0.7,0.5,1,1.1,1,1.9\n        c0,0.9-0.4,1.7-1.2,2.3s-2,1-3.6,1c-1.6,0-2.8-0.4-3.7-1.1c-0.9-0.7-1.4-1.8-1.6-3.2l-3.5,0.5C43.8,88.6,44.7,90.3,46.1,91.4z"/>\n      <path d="M68.3,92.6V81.3c0-2.7,0.5-4.5,1.6-5.4c1.1-1,2.4-1.4,3.9-1.4c0.9,0,1.8,0.2,2.5,0.6c0.7,0.4,1.2,1,1.5,1.7\n        s0.4,1.8,0.4,3.2v12.6h3.5V79.8c0-1.6-0.1-2.8-0.2-3.4c-0.2-1-0.6-1.9-1.1-2.6c-0.5-0.7-1.3-1.3-2.4-1.8c-1-0.4-2.2-0.7-3.4-0.7\n        c-2.9,0-5.1,1.1-6.6,3.4v-2.9h-3.2v20.7H68.3z"/>\n    </symbol>\n    <symbol id="hyl" viewBox="0 0 100 100">\n      <path d="M20,50 a1,1 0 0,0 30,0 a1,1 0 0,1 30,0" fill="none" stroke="#000" stroke-width="1"/>\n      <path d="M28.1,92.6V79.1H43v13.5h3.8V64H43v11.8H28.1V64h-3.8v28.6H28.1z"/>\n      <path d="M54.7,101c1.1,0,2.1-0.3,2.9-0.8c0.8-0.5,1.5-1.4,2.1-2.5c0.5-0.9,1.1-2.4,2-4.7l7.9-21.1h-3.5l-4.4,12.1\n        c-0.6,1.5-1,3.1-1.4,4.7c-0.4-1.7-0.9-3.3-1.5-4.8l-4.3-12h-3.8l7.9,20.8c-0.1,0.4-0.2,0.7-0.3,0.9c-0.5,1.4-0.9,2.3-1.1,2.6\n        c-0.3,0.5-0.7,0.8-1.2,1.1s-1.1,0.4-1.9,0.4c-0.6,0-1.2-0.1-2-0.3l0.4,3.3C53.3,100.9,54.1,101,54.7,101z"/>\n      <path d="M76.1,92.6V64h-3.5v28.6H76.1z"/>\n    </symbol>\n    <symbol id="etnp" viewBox="0 0 100 100">\n      <path d="M50,15.1 L66.2,26.9 L60,45.9 L40,45.9 L33.8,26.9" fill="#000"/>\n      <circle cx="50" cy="70" fill="#bbe5fa" r="15" stroke-width="2" stroke="#2f5fac"/>\n      <path fill="#2f5fac" stroke="none" stroke-width="2" d="M47,70.5v0h4.5c2.5,0,4.3-0.55,5.25-1.6c0.95-1.05,1.45-2.35,1.45-3.85c0-0.9-0.2-1.7-0.55-2.45c-0.35-0.75-0.85-1.3-1.45-1.75c-0.6-0.4-1.35-0.7-2.2-0.85c-0.65-0.1-1.55-0.15-2.7-0.15h-8v17.9h3.6z m-0.5,-8.5h4.6\nc1.05,0,1.8,0.05,2.2,0.15\nc0.6,0.15,1.1,0.5,1.5,1.05c0.4,0.55,0.55,1.15,0.55,1.9c0,1.05-0.3,1.85-0.95,2.4c-0.65,0.55-1.75,0.85-3.25,0.85h-4.65v-7z"/>\n    </symbol>\n    <symbol id="dol-pp" viewBox="0 0 100 100">\n      <circle cx="50" cy="20" fill="#bbe5fa" r="7.5" stroke-width="2" stroke="#2f5fac"/>\n      <circle cx="50" cy="40" fill="#bbe5fa" r="7.5" stroke-width="2" stroke="#2f5fac"/>\n      <path fill="none" stroke="#999" stroke-width="4" stroke-linecap="round"  d="M50,50 55.8,61.1 44.5,72 55.8,83 44.5,94"/>\n    </symbol>\n    <symbol id="dol-p" viewBox="0 0 100 100">\n      <circle cx="50" cy="20" fill="#bbe5fa" r="7.5" stroke-width="2" stroke="#2f5fac"/>\n      <path fill="none" stroke="#999" stroke-width="4" stroke-linecap="round"  d="M50,27.5 55.8,38.9 44.5,50 55.8,61.1 44.5,72 55.8,83 44.5,94"/>\n    </symbol>\n\n    <symbol id="pi" viewBox="0 0 100 100">\n  <path d="M40.5,37.048h12.039c2.38,0,4.302,0.674,5.765,2.023c1.464,1.35,2.196,3.245,2.196,5.687c0,2.101-0.653,3.929-1.959,5.486\n    c-1.306,1.557-3.304,2.336-5.996,2.336h-8.401v11.373H40.5V37.048z M54.636,40.747c-0.799-0.378-1.897-0.567-3.291-0.567h-7.201\n    v9.323h7.201c1.625,0,2.943-0.348,3.955-1.044s1.519-1.923,1.519-3.681C56.819,42.799,56.091,41.456,54.636,40.747z"/>\n<polyline fill="none" stroke="#000000" stroke-miterlimit="10" points="12.076,90.888 12.076,54.475 33.525,54.475 "/>\n<line fill="none" stroke="#000000" stroke-miterlimit="10" x1="22.8" y1="80.746" x2="22.8" y2="54.475"/>\n<polygon fill="#fff" stroke="#000000" stroke-miterlimit="10" points="50.482,3.475 38.46,10.415 38.46,24.297 50.482,31.237 \n  62.503,24.297 62.503,10.415 "/>\n<line fill="none" stroke="#000000" stroke-miterlimit="10" x1="50.482" y1="35.021" x2="50.482" y2="31.237"/>\n    </symbol>\n\n  </defs>\n  \x3c!--\n  <g>\n    <rect x="0" y="0" width="100" height="100" stroke-width="0.1" stroke="#000" fill="none"/>\n    <text x="20" y="50" font-family="helvetica">100 x 100</text>\n    <text x="0" y="15"  font-family="helvetica">0</text>\n    <text x="70" y="100"  font-family="helvetica">100</text>\n  </g>\n  --\x3e\n  <use xlink:href="#galnac" x="100" y="100" width="100" height="100"/>\n  <use xlink:href="#glcnac" x="200" y="100" width="100" height="100"/>\n  <use xlink:href="#man" x="300" y="100" width="100" height="100"/>\n  <use xlink:href="#glc" x="400" y="100" width="100" height="100"/>\n  <text x="150" text-anchor="middle" y="210">GalNAc</text>\n  <text x="250" text-anchor="middle" y="210">GlcNAc</text>\n  <text x="350" text-anchor="middle" y="210">Mannose</text>\n  <text x="450" text-anchor="middle" y="210">Glucose</text>\n  <use xlink:href="#fuc" x="100" y="250" width="100" height="100"/>\n  <use xlink:href="#neu" x="200" y="250" width="100" height="100"/>\n  <use xlink:href="#neuac" x="300" y="250" width="100" height="100"/>\n  <use xlink:href="#neugc" x="400" y="250" width="100" height="100"/>\n  <text x="150" text-anchor="middle" y="370">Fucose</text>\n  <text x="250" text-anchor="middle" y="370">Sialic acid</text>\n  <text x="350" text-anchor="middle" y="370">NeuAc</text>\n  <text x="450" text-anchor="middle" y="370">NeuGc</text>\n\n  <use xlink:href="#ara" x="100" y="400" width="100" height="100"/>\n  <use xlink:href="#xyl" x="200" y="400" width="100" height="100"/>\n  <use xlink:href="#glca" x="300" y="400" width="100" height="100"/>\n  <use xlink:href="#idoa" x="400" y="400" width="100" height="100"/>\n\n  <text x="150" text-anchor="middle" y="510">Arabinose</text>\n  <text x="250" text-anchor="middle" y="510">Xylose</text>\n  <text x="350" text-anchor="middle" y="510">GlcA</text>\n  <text x="450" text-anchor="middle" y="510">IdoA</text>\n\n  <use xlink:href="#hexa" x="100" y="550" width="100" height="100"/>\n  <use xlink:href="#hex" x="200" y="550" width="100" height="100"/>\n  <use xlink:href="#hexnac" x="300" y="550" width="100" height="100"/>\n  <use xlink:href="#p" x="400" y="550" width="100" height="100"/>\n\n  <text x="150" text-anchor="middle" y="660">HexA</text>\n  <text x="250" text-anchor="middle" y="660">Hexose</text>\n  <text x="350" text-anchor="middle" y="660">HexNAc</text>\n  <text x="450" text-anchor="middle" y="660">P</text>\n\n  <use xlink:href="#ser" x="100" y="700" width="100" height="100"/>\n  <use xlink:href="#thr" x="200" y="700" width="100" height="100"/>\n  <use xlink:href="#asn" x="300" y="700" width="100" height="100"/>\n  <use xlink:href="#hyl" x="400" y="700" width="100" height="100"/>\n\n  <text x="150" text-anchor="middle" y="810">Ser</text>\n  <text x="250" text-anchor="middle" y="810">Thr</text>\n  <text x="350" text-anchor="middle" y="810">Asn</text>\n  <text x="450" text-anchor="middle" y="810">HyL</text>\n\n  <use xlink:href="#hso3" x="100" y="850" width="100" height="100"/>\n  <use xlink:href="#cer" x="200" y="850" width="100" height="100"/>\n  <use xlink:href="#hso3.2" x="300" y="850" width="100" height="100"/>\n  <use xlink:href="#hso3.3" x="400" y="850" width="100" height="100"/>\n\n  <text x="150" text-anchor="middle" y="960">HSO3</text>\n  <text x="250" text-anchor="middle" y="960">Cer</text>\n  <text x="350" text-anchor="middle" y="960">2S</text>\n  <text x="450" text-anchor="middle" y="960">3S</text>\n\n\n  <use xlink:href="#hso3.4" x="100" y="1000" width="100" height="100"/>\n  <use xlink:href="#hso3.6" x="200" y="1000" width="100" height="100"/>\n  <use xlink:href="#hso3.N" x="300" y="1000" width="100" height="100"/>\n  <use xlink:href="#glcn" x="400" y="1000" width="100" height="100"/>\n\n  <text x="150" text-anchor="middle" y="1110">4S</text>\n  <text x="250" text-anchor="middle" y="1110">6S</text>\n  <text x="350" text-anchor="middle" y="1110">NS</text>\n  <text x="450" text-anchor="middle" y="1110">GlcN</text>\n\n\n  <use xlink:href="#etnp" x="100" y="1150" width="100" height="100"/>\n  <use xlink:href="#pi" x="200" y="1150" width="100" height="100"/>\n  <use xlink:href="#dol-pp" x="300" y="1150" width="100" height="100"/>\n  <use xlink:href="#dol-p" x="400" y="1150" width="100" height="100"/>\n\n  <text x="150" text-anchor="middle" y="1260">Etnp</text>\n  <text x="250" text-anchor="middle" y="1260">PI</text>\n  <text x="350" text-anchor="middle" y="1260">Dol-PP</text>\n  <text x="450" text-anchor="middle" y="1260">Dol-P</text>\n\n\n</svg>\n'},function(e,t,r){"use strict";(function(e){var n=r(5),i=r(2),a=r(7),o=r(9),s=r(13);function l(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){l(a,n,i,o,s,"next",e)}function s(e){l(a,n,i,o,s,"throw",e)}o(void 0)}))}}var h=Symbol("document_container"),d="object"!=typeof e||"object"!=typeof e.versions||void 0===e.versions.node?r(11).default:"",u=Object(i.a)("glycanjs:canvasrenderer"),f=Symbol("done_tween"),p=(e,t)=>(e.x.push(t[0]),e.y.push(t[1]),e),g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:[],y:[]};if(e.torender){for(var r of e.torender)t=g(r,t);return t}return e.x2&&(p(t,[e.x,e.y]),p(t,[e.x2,e.y2])),e.width&&(p(t,[e.x,e.y]),p(t,[e.x+e.width,e.y+e.height])),e.text&&(p(t,[e.x,e.y]),p(t,[e.x,e.y])),t};class v{constructor(e){this._mat=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix(),this._mat.a=e[0],this._mat.b=e[1],this._mat.c=e[2],this._mat.d=e[3],this._mat.e=e[4],this._mat.f=e[5]}applyToPoint(e,t){var r=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGPoint();return r.x=e,r.y=t,r.matrixTransform(this._mat)}inverse(){var e=this._mat.inverse(),t=[e.a,e.b,e.c,e.d,e.e,e.f];return new v(t)}multiply(e){var t=this._mat.multiply(e._mat),r=[t.a,t.b,t.c,t.d,t.e,t.f];return new v(r)}}var m,y=function(e,t){if(t.torender)for(var r of t.torender)y(e,r);else t.render&&t.render(e)},b=e=>{var t={};if(t.fill=e.getAttribute("fill"),e.getAttribute("stroke-width")&&parseFloat(e.getAttribute("stroke-width"))>0&&(t.stroke=e.getAttribute("stroke")),e.getAttribute("transform")){var[r,n,i,a]=e.getAttribute("transform").match(/rotate\((\d+),(\d+),(\d+)\)/);r.length>0&&(t.rotate={angle:n,cx:i,cy:a})}return t},w=e=>{var t=[];for(var r of e.querySelectorAll("path")){var n=b(r);n.d=r.getAttribute("d"),t.push(n)}for(var i of e.querySelectorAll("circle")){var a=b(i);a.cx=parseFloat(i.getAttribute("cx")),a.cy=parseFloat(i.getAttribute("cy")),a.r=parseFloat(i.getAttribute("r")),t.push(a)}for(var o of e.querySelectorAll("rect")){var s=b(o),l=o.getAttribute("x"),c=o.getAttribute("y"),h=parseFloat(o.getAttribute("x"))+parseFloat(o.getAttribute("width")),d=parseFloat(o.getAttribute("y"))+parseFloat(o.getAttribute("height"));s.d="M".concat(l,",").concat(c," ").concat(h,",").concat(c," ").concat(h,",").concat(d," ").concat(l,",").concat(d," z"),t.push(s)}for(var u of e.querySelectorAll("polyline")){var f=b(u);f.d="M"+u.getAttribute("points")+"Z",t.push(f)}for(var p of e.querySelectorAll("text")){var g=b(p);g.fontSize=p.getAttribute("font-size"),g.text=p.textContent;var v=p.getAttribute("x"),m=p.getAttribute("y");g.x=v,g.y=m,t.push(g)}return t},x=Symbol("global_symbols"),_=(Symbol("performing_import"),new WeakMap),k=function(e,t){if(t.clientX){var r=e.getBoundingClientRect(),n=e.screenToCanvasMatrix.applyToPoint(t.clientX-r.x,t.clientY-r.y),i=n.x/100,a=n.y/100;t.sugarX=i,t.sugarY=a}},O=(e,t,r)=>(t*=100,(e*=100)>=r.x&&e<=r.x+r.width&&t>=r.y&&t<=r.y+r.height),S=(e,t)=>({left:e,top:t,width:0,height:0}),M=function(e){if(e.sugarX||e.sugarY){var t=[...this.iconset].filter(O.bind(null,e.sugarX,e.sugarY)),r=e.type;for(var n of t)if(n.hasElement()){e.stopImmediatePropagation();var i=new Event(r,{bubbles:!0});return n.element.getBoundingClientRect=S.bind(null,e.clientX,e.clientY),n.element.dispatchEvent(i),void("dragover"===r&&this.last_dragenter!==n&&(this.last_dragenter&&(delete this.last_dragenter,i=new Event("dragleave",{bubbles:!0}),n.element.dispatchEvent(i)),i=new Event("dragenter",{bubbles:!0}),n.element.dispatchEvent(i),this.last_dragenter=n))}if(t.length<1&&"dragover"===r&&this.last_dragenter){var a=new Event("dragleave",{bubbles:!0});this.last_dragenter.element.dispatchEvent(a),delete this.last_dragenter}}};class C extends a.a{constructor(e,t){var r;if(u("CanvasRenderer"),super(e,t),Object(n.autoPlay)(!0),this.iconset=new Set,Object(n.onTick)(()=>{this.animating&&this.paint()}),this.ready=m.call(this),e)for(var i of(e instanceof HTMLCanvasElement?r=e:(this[h]=e,u.info("Creating canvas element"),(r=e.ownerDocument.createElement("canvas")).setAttribute("width","1px"),r.setAttribute("height","1px"),e.appendChild(r)),this.element=new o.a(r),function(e,t){for(var r of"mousemove mousedown mouseup click touchstart touchend touchmove drop dragover".split(" "))e.addEventListener(r,t,{passive:!0,capture:!0})}(this.element.canvas,k.bind(this,this.element.canvas)),["click","dragover"]))this.element.canvas.addEventListener(i,M.bind(this),{capture:!0})}static get Canvas(){return o.a}static get SYMBOLS(){return d}static get GLOBAL_SCALE(){return 100}get animating(){for(var e of this.iconset)if(!e.rendered)return!0;return!1}setupContainer(e,t){var r=this.element;if(e||(e=r.group(),this.rendered.set(t,e)),this.groupTag&&!e.tagGroup&&(e.tagGroup=e.group()),e.tagGroup)for(var n of e.tagGroup.element.childNodes)e.appendChild(n);return e}renderLinkageGroup(e){return e.group()}renderLinkageLabel(e,t,r,n,i,a){var o=e.text(t,r,n);return!i&&a<0&&(o["text-anchor"]="end"),o}removeRendered(e){e.residue&&(e.residue.parent.remove(e.residue),e.residue.element&&e.residue.element.parentNode.removeChild(e.residue.element),this.iconset.has(e.residue)&&this.iconset.delete(e.residue)),e.linkage&&e.linkage.parent.remove(e.linkage)}setIconPosition(e,t,r,i,a,o){_.get(e)&&_.get(e).stop(),_.set(e,new n.Tween(e));var s=_.get(e),l=200;e.rendered=!1,clearTimeout(e[f]),e.x!==t||e.y!==r||e.width!==i||e.height!==a?(this.iconset.has(e)||(this.iconset.add(e),e.x=t,e.y=r,e.width=i,e.height=a,e.rotate=o,l=0,e.rendered=!0),s.to({x:t,y:r,width:i,height:a,rotate:o},l).on("complete",e=>{e[f]=setTimeout(()=>{e.rendered=!0},100)}).start()):e.rendered=!0}screenCoordinatesFromLayout(e){var t=this.element.canvas,r={x:0,y:0},n=e.x+e.width,i=e.y+e.height;r.x=100*e.x,r.y=100*e.y;var a=t.screenToCanvasMatrix.inverse().applyToPoint(r.x,r.y);return e.x=a.x,e.y=a.y,r.x=100*n,r.y=100*i,a=t.screenToCanvasMatrix.inverse().applyToPoint(r.x,r.y),e.width=a.x-e.x,e.height=a.y-e.y,e.x+=t.getBoundingClientRect().x,e.y+=t.getBoundingClientRect().y,e}renderIcon(e,t){var r=e.use(t,0,0,1,1);r.src=this.symbols[t].svg,r.paths=this.symbols[t].paths;var n=this.element.canvas;return Object.defineProperty(r,"element",{get:function(){return this._element||(this._element=n.ownerDocument.createElement("button"),n.appendChild(this._element)),this._element}}),r.hasElement=()=>"_element"in r,r}scaleToFit(){}paint(){!function(e,t){var r=g(t);r.x=r.x.map((e,t,r)=>{if(t%2==0)return.5*(e+r[t+1])}).filter(e=>void 0!==e),r.y=r.y.map((e,t,r)=>{if(t%2==0)return.5*(e+r[t+1])}).filter(e=>void 0!==e);var n=Math.min(...r.x)-100,i=Math.max(...r.x)+100,a=Math.min(...r.y)-100,o=Math.max(...r.y)+100;e.width=1*(i-n),e.height=1*(o-a);var l,c=e.getContext("2d"),{width:h,height:d}=e.getBoundingClientRect(),u=e.height,f=d||1,p=e.width,m=h||1;if(u>p){var b=new v([u/f,0,0,u/f,0,0]).multiply(new v([1,0,0,1,-.5*m,0]));l=new v([1,0,0,1,.5*p,0]).multiply(b)}else{var w=new v([p/m,0,0,p/m,0,0]).multiply(new v([1,0,0,1,0,-.5*f]));l=new v([1,0,0,1,0,.5*u]).multiply(w)}c.setTransform(1,0,0,1,-1*n,-1*a),e.cm=new s.a(c,{handleScale:!1,handleTransforms:!0,matrix:new v([1,0,0,1,-1*n,-1*a])}),e.cm.centering_matrix=l,e.screenToCanvasMatrix=new v([1,0,0,1,-1*n,-1*a]).inverse().multiply(l),y(e,t)}(this.element.canvas,this.element)}refresh(){var e=this;return c((function*(){return e.ready.then(c((function*(){yield a.a.prototype.refresh.call(e),e.paint()})))}))()}}var E=new WeakMap;m=function(){var e=this.constructor,t=document.createElement("svg");return E.has(e)?new Promise(e=>{setTimeout(()=>{m.call(this).then(e)},0)}):void 0!==e[x]?(this.symbols=e[x],Promise.resolve()):(E.set(e,!0),this.symbols={},Promise.resolve(e.SYMBOLS).then(e=>t.innerHTML=e).then(()=>{for(var r of t.querySelectorAll("defs symbol")){var n=r.innerHTML.replace(/#/g,"%23"),i=w(r),a='data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" x="0" y="0" width="100px" height="100px">'.concat(n,"</svg>");this.symbols[r.getAttribute("id")]={svg:a,paths:i}}e[x]=this.symbols,E.delete(e)}))},C.DEFAULT_PADDING={top:0,side:0},t.a=C}).call(this,r(8))},function(e,t,r){"use strict";
/*!
	canvas-mouse 0.8.0-alpha
	Copyright (c) 2017 Epistemex
	MIT license.
*/t.a=function(e,t){if(!(e instanceof CanvasRenderingContext2D))throw"Need a 2D canvas context.";t=Object.assign({handleScale:!1,handleTransforms:!1,handleResize:!0,handleScroll:!0,onchange:null,matrix:null,plugins:[]},t);var r,n,i,a,o,s,l,c=this,h=Object.defineProperty.bind(Object),d="currentTransform"in e||"mozCurrentTransform"in e,u=t.plugins,f=e.canvas,p=t.matrix,g=p?p.inverse():null,v=t.handleScale,m=t.handleTransforms&&(d||p),y=p?function(e){var t=g.applyToPoint(e.x,e.y);return{x:t.x,y:t.y,timeStamp:e.timeStamp}}:function(t){var r,n,i=e.currentTransform||e.mozCurrentTransform;i instanceof SVGMatrix&&(i=DOMMatrix.fromMatrix(i));return r=void 0===i.a?new DOMMatrix(i):i,n=r.invertSelf(),{x:t.x*n.a+t.y*n.c+n.e,y:t.x*n.b+t.y*n.d+n.f,timeStamp:t.timeStamp}};function b(){p&&!p._xx&&(p._xx=p._x,p._x=function(){return g=this.inverse(),this._xx()})}function w(){var e=f.getBoundingClientRect(),t=getComputedStyle(f),r=t.getPropertyValue.bind(t),c=parseFloat,h="padding-",d="border-",u="-width",p="left",g="right",v="bottom";s=c(r(h+p))+c(r(d+p+u)),l=c(r(h+"top"))+c(r(d+"top"+u)),n=e.left+s,i=e.top+l,a=f.width/(e.width-(s+c(r(h+g))+c(r(d+g+u))))||1,o=f.height/(e.height-(l+c(r(h+v))+c(r(d+v+u))))||1}function x(){cancelAnimationFrame(r),r=requestAnimationFrame(k)}function _(){cancelAnimationFrame(r),r=requestAnimationFrame(O)}function k(){w(),t.onchange&&t.onchange({type:"resize",timeStamp:Date.now()})}function O(){var e=f.getBoundingClientRect();n=e.left+s,i=e.top+l,t.onchange&&t.onchange({type:"scroll",timeStamp:Date.now()})}!m||d||p||(console.log("currentTransform not supported by browser"),m=!1),this.getPos=function(e){var t,r={x:(t=e).clientX-n,y:t.clientY-i,timeStamp:t.timeStamp};if(v&&(r=function(e){return e.x*=a,e.y*=o,e}(r)),m&&(r=y(r)),u.length)for(var s=0;s<u.length;s++)r=u[s].handler(e,r);return r},this.getPosXY=function(e,t){var r;return 1===arguments.length?(t=e.y,r=e.x):r=e,c.getPos({clientX:r/a+n,clientY:t/o+i,timestamp:Date.now()})},this.addPlugin=function(e){u.indexOf(e)<0&&u.push(e)},this.removePlugin=function(e){var t=u.indexOf(e);t>-1&&u.splice(t,1)},this.init=w,this.update=O,h(c,"handleScale",{get:function(){return v},set:function(e){v=!!e}}),h(c,"handleTransforms",{get:function(){return m},set:function(e){m=!!e&&(d||p)}}),h(c,"handleScroll",{get:function(){return t.handleScroll},set:function(e){e?(window.addEventListener("scroll",_),t.handleScroll=!0):(window.removeEventListener("scroll",_),t.handleScroll=!1)}}),h(c,"handleResize",{get:function(){return t.handleResize},set:function(e){e?(window.addEventListener("resize",x),t.handleResize=!0):(window.removeEventListener("resize",x),t.handleResize=!1)}}),h(c,"onchange",{get:function(){return t.onchange},set:function(e){t.onchange=e}}),h(c,"matrix",{get:function(){return p},set:function(e){p=e,m=m&&(d||p),b()}}),b(),w(),c.handleResize=t.handleResize,c.handleScroll=t.handleScroll}},function(e,t,r){e.exports=r(19)},function(e,t,r){(function(n){var i;t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))}),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch(e){}!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;var e;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(i=!1,()=>{i||(i=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(16)(t);var{formatters:a}=e.exports;a.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,r(8))},function(e,t,r){e.exports=function(e){function t(e){var r,i,a,o=null;function s(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];if(s.enabled){var a=s,o=Number(new Date),l=o-(r||o);a.diff=l,a.prev=r,a.curr=o,r=o,n[0]=t.coerce(n[0]),"string"!=typeof n[0]&&n.unshift("%O");var c=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(e,r)=>{if("%%"===e)return"%";c++;var i=t.formatters[r];if("function"==typeof i){var o=n[c];e=i.call(a,o),n.splice(c,1),c--}return e}),t.formatArgs.call(a,n);var h=a.log||t.log;h.apply(a,n)}}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=n,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(i!==t.namespaces&&(i=t.namespaces,a=t.enabled(e)),a),set:e=>{o=e}}),"function"==typeof t.init&&t.init(s),s}function n(e,r){var n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function i(e,t){for(var r=0,n=0,i=-1,a=0;r<e.length;)if(n<t.length&&(t[n]===e[r]||"*"===t[n]))"*"===t[n]?(i=n,a=r,n++):(r++,n++);else{if(-1===i)return!1;n=i+1,r=++a}for(;n<t.length&&"*"===t[n];)n++;return n===t.length}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){var e=[...t.names,...t.skips.map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){t.save(e),t.namespaces=e,t.names=[],t.skips=[];var r=("string"==typeof e?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(var n of r)"-"===n[0]?t.skips.push(n.slice(1)):t.names.push(n)},t.enabled=function(e){for(var r of t.skips)if(i(e,r))return!1;for(var n of t.names)if(i(e,n))return!0;return!1},t.humanize=r(17),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(r=>{t[r]=e[r]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},function(e,t){var r=1e3,n=6e4,i=60*n,a=24*i;function o(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,t){t=t||{};var s=typeof e;if("string"===s&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var o=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*a;case"hours":case"hour":case"hrs":case"hr":case"h":return o*i;case"minutes":case"minute":case"mins":case"min":case"m":return o*n;case"seconds":case"second":case"secs":case"sec":case"s":return o*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(e);if("number"===s&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=a)return o(e,t,a,"day");if(t>=i)return o(e,t,i,"hour");if(t>=n)return o(e,t,n,"minute");if(t>=r)return o(e,t,r,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=a)return Math.round(e/a)+"d";if(t>=i)return Math.round(e/i)+"h";if(t>=n)return Math.round(e/n)+"m";if(t>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"Builder",(function(){return Re})),r.d(n,"Writer",(function(){return Ie})),r.d(n,"IO",(function(){return Ne}));var i={};r.r(i),r.d(i,"Sugar",(function(){return B})),r.d(i,"Monosaccharide",(function(){return c.b})),r.d(i,"Reaction",(function(){return xe})),r.d(i,"SEQUENCE_CACHEKEY",(function(){return de})),r.d(i,"ReactionSet",(function(){return re})),r.d(i,"ReactionGroup",(function(){return ae})),r.d(i,"comparator",(function(){return J})),r.d(i,"Repeat",(function(){return h.a})),r.d(i,"CondensedIupac",(function(){return n})),r.d(i,"CondensedLayout",(function(){return Ze})),r.d(i,"SugarAwareLayout",(function(){return nt})),r.d(i,"LinkageLayout",(function(){return ht})),r.d(i,"FishEyeLayout",(function(){return ir})),r.d(i,"SugarAwareLayoutFishEye",(function(){return ar})),r.d(i,"LinkageLayoutFishEye",(function(){return or})),r.d(i,"SVGRenderer",(function(){return bt.a})),r.d(i,"CanvasRenderer",(function(){return wt.a})),r.d(i,"SVGCanvas",(function(){return xt.a})),r.d(i,"Fragmentor",(function(){return nr})),r.d(i,"Mass",(function(){return Vt}));var a={};r.r(a),r.d(a,"IupacSugar",(function(){return xi})),r.d(a,"SViewerLite",(function(){return ia})),r.d(a,"default",(function(){return la}));var o={};r.r(o),r.d(o,"default",(function(){return ka}));var s={};r.r(s),r.d(s,"default",(function(){return Ha}));var l={};r.r(l),r.d(l,"default",(function(){return so}));var c=r(1),h=r(0),d=r(4),u=r(2),f=(Symbol("uuid"),new WeakMap);var p=class{constructor(){this._cache=new Map}has(e){return null!=this._cache.get(e.map(e=>f.get(e)).join("#"))}get(e){return this._cache.get(e.map(e=>f.get(e)).join("#"))}set(e,t){var r=e.map(e=>{var t=f.get(e);return t||(t=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)),f.set(e,t)),t});this._cache.set(r.join("#"),t)}},g=Object(u.a)("glycanjs:searching"),v=Symbol("skip_cache"),m=e=>[].concat.apply([],e),y=function(e,t,r){return r.indexOf(e)===t},b=function(e,t,r){for(var n=null,i=[].concat(e),a=[].concat(r);n=i.shift();){var o=i.length>0;a=a.filter(t.bind(null,n)),o&&(a=a.map(e=>e.parent)),a=a.filter(e=>null!=e)}return a.map(e=>r.indexOf(e)).map(t=>r.slice(t-e.length+1,t+1))},w=function(e,t,r){var n=e.paths(),i=t.paths(),a=[],o=new WeakMap,s=e=>e.map(e=>e[e.length-1]);return i.forEach(e=>{var t=b.bind(null,e,r),i=n.map(t);a=a.concat(m(i.map(s))).filter(y),m(m(i)).filter(y).forEach(e=>{o.set(e,(o.get(e)||0)+1)})}),a.filter(e=>o.get(e)==t.leaves().length)},x=function(e,t){return t.children.map(r=>{var n=r.toSugar(e.constructor);return n.linkage=t.linkageOf(r),n.parent_link=t.parent?t.parent.linkageOf(t):0,n})},_=function(e,t,r){var n=Symbol("wildcard");g.info("Wildcard matching",e.sequence,t.sequence);var i=t.composition().filter(e=>"*"===e.identifier).map(x.bind(null,t)),a=t.clone();a.composition().filter(e=>"*"===e.identifier).forEach(e=>{e.children.map(t=>e.removeChild(e.linkageOf(t),t)),e.setTag(n,!0)}),g.info("Root sugar for wildcard matching",a.sequence),g.info("We have",i.length,"wildcard subtrees to ensure matches for"),i.forEach(e=>e.forEach(e=>{var t=new(0,e.constructor.Monosaccharide)("*");t.addChild(e.linkage,e.root),e.root=t,g.info("Wildcard subtree sequence:",e.sequence)}));var o=w(e,a,r),s=m(o.map(t=>e.trace(a,t,r)));g.info("RESULTS from matching Root sugar, total of",s.length,"trees matched"),s.forEach(e=>{g.info("RESULT Root sugar match sequence",e.sequence);var t=e.composition_for_tag(n)[0];g.info("The residue acting as wildcard is",t,"with parent",t.parent?t.parent.identifier:"(No root)")});var l=function(e,t){var r=new WeakMap;for(var n of e)for(var i of(g.info("For a Root tree match",n.sequence,"we are finding wildcard leaves"),n.leaves()))i.getTag(t)&&(r.set(i.original,n),g.info("Adding leaf",i.original.identifier," to tree mapping"),i.parent&&(r.set(i.parent.original,n),g.info("Adding leaf parent",i.parent.original.identifier," to tree mapping")));return r}(s,n),c=i.map((function(t){return t.map((function(t){var i=w(e,t,r);g.info("For subtree",t.sequence,"we matched roots",i.map(e=>e.identifier)),g.info("We should be able to match each of these roots with a Root sugar match"),i=i.filter(e=>!e.parent||0==t.parent_link||e.parent.linkageOf(e)==t.parent_link).map(t=>{g.info("The parents of ",t.identifier,t.parent," are being checked for being leaves of any root tree");var r=[...e.residues_to_root(t)];for(var n of r)if(l.get(n))return{root:t,parent_leaf:n}}).filter(e=>e),g.info("Number of subtrees that are a parent of a root match",i.length);var o=i.map(i=>{var o=e.trace(t,i.root,r),s=l.get(i.parent_leaf),c=a.composition_for_tag(n)[0],h=[];for(var d of(g.info("Matched after tracing",o),o)){var u=s.clone(),f=u.composition_for_tag(n)[0];d.root.original=c,f===u.root?u.root=d.root:(d.root.copyTagsFrom(f),f.parent.replaceChild(f,d.root,0)),h.push(u)}return h});return m(o)}))}));return g.info("Found",m(m(c)).length,"matching trees"),m(m(c))};var k=Symbol("cache_symbol"),O={type:"wildcard"},S={type:"fixed"},M={type:"composition"},C={type:"trace"};class E extends class{static search(e,t,r){return t.composition().filter(e=>"*"===e.identifier).length>0?this.search_wildcard_paths(e,t,r):this.search_fixed_paths(e,t,r)}static search_wildcard_paths(e,t,r){return _(e,t,r)}static search_fixed_paths(e,t,r){return w(e,t,r)}}{static get Cache(){return this[k]||(this[k]=new p),this[k]}static search(e,t,r){if(!Object.isFrozen(e)||!Object.isFrozen(t))return super.search(e,t,r);if([...e.composition_for_tag(v)].length>0)return super.search(e,t,r);var n=[e,M],i=[t,M],a=this.Cache.get(i),o=this.Cache.get(n);return o||(o=e.composition().map(e=>e.identifier),this.Cache.set(n,o)),a||(a=t.composition().map(e=>e.identifier),this.Cache.set(i,a)),a.every(e=>"*"===e||null!=o.find(t=>t===e))?super.search(e,t,r):[]}static search_wildcard_paths(e,t,r){if(!Object.isFrozen(e)||!Object.isFrozen(t))return super.search_wildcard_paths(e,t,r);if([...e.composition_for_tag(v)].length>0)return super.search_wildcard_paths(e,t,r);var n=[e,t,r,O];return this.Cache.has(n)||this.Cache.set(n,super.search_wildcard_paths(e,t,r)),this.Cache.get(n)}static search_fixed_paths(e,t,r){if(!Object.isFrozen(e)||!Object.isFrozen(t))return super.search_fixed_paths(e,t,r);if([...e.composition_for_tag(v)].length>0)return super.search_fixed_paths(e,t,r);var n=[e,t,r,S];return this.Cache.has(n)||this.Cache.set(n,super.search_fixed_paths(e,t,r)),this.Cache.get(n)}}var A=(e,t,r,n)=>{if(!Object.isFrozen(e)||!Object.isFrozen(t))return e.trace(t,r,n);if([...e.composition_for_tag(v)].length>0)return e.trace(t,r,n);var i=[e,t,r,n,C],a=E.Cache;return a.has(i)||a.set(i,e.trace(t,r,n)),a.get(i).map(e=>e.clone())},T=e=>{for(var t=e;t.parent;){var r=t.parent.children,n=r[r.indexOf(t)+1];if(n)return n;t=t.parent}return null},L=function*(e){for(var t=[...e.depth_first_traversal()],r=0;r<t.length;){var n=t[r],i=T(n);i||(i=n);var a=t.indexOf(i),o=t.slice(r+1,a),s=t.slice(a===r?a+1:a);if(a===r)for(var l of s)yield{root:n,chord:[n,l]};else{for(var c of s)yield{root:e.root,chord:[n,c]};for(var h of o)yield{root:n,chord:[n,h]}}r+=1}},P=function*(e,t){if(t<2)throw new Error("Cannot expand chord set when n < 2");var r=[...L(e)],n=r.filter(t=>t.root===e.root&&t.chord[0]!==e.root),i={};for(var a of n)i[a.chord[0]]=i[a.chord[0]]||[],i[a.chord[0]].push(a.chord[1]);var o=0;for(var s of r)yield s;for(;o<t-2&&r.length>0;){var l=[];for(var c of r)for(var h of i[c.chord[c.chord.length-1]]||[])if(e.composition(c.root).indexOf(h)>=0){var d={root:c.root};d.chord=c.chord.concat(h),yield d,l.push(d)}r=l,o+=1}},q=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return function*(){t>=1&&(yield*e.depth_first_traversal(e.root,t=>({root:e.root,chord:[t]})),yield*e.depth_first_traversal(e.root,t=>t===e.root?null:{root:t,chord:[t]})),t>=2&&(yield*P(e,t))}()},R=Symbol("root"),I=function(e,t){for(var r=null;!(r=Object.getOwnPropertyDescriptor(e,t))&&Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return r},N=function(e,t,r){return r.indexOf(e)===t},H=(e,t)=>t.getTag(e),F=Symbol("frozen_sequence"),j=Symbol("frozen_composition"),D=function(e,t,r){for(var n of e.children.filter(e=>e instanceof h.a.Monosaccharide)){if(n.counter==t&&n.original==r)return n;if(!(n.counter>t)){var i=D(n,t,r);if(i)return i}}};class B{constructor(){}set root(e){this[R]=e}get root(){return this[R]}static get Monosaccharide(){return c.b}freeze(){var e=this;for(var t of this.breadth_first_traversal())Object.freeze(t);this[F]=this.sequence,this[j]=this.composition(),Object.defineProperty(this,"composition",{value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.root;return t===e.root?e[j]:e.constructor.prototype.composition.call(e,t)}}),Object.defineProperty(this,"sequence",{get:()=>this[F]}),Object.freeze(this)}get repeats(){return this.composition(this.root).filter(e=>e instanceof h.a.Monosaccharide).map(e=>e.repeat).filter((e,t,r)=>r.indexOf(e)===t)}paths(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.root,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.leaves(e),r=this;return[].concat(t).map(e=>Array.from(r.residues_to_root(e)))}leaves(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.root;return this.composition(e).filter(e=>0===e.children.length)}locate_monosaccharide(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.root,[,r,n]=e.match(/[a-zA-Z]+|[0-9]+/g);r=parseInt(r),n=n.charCodeAt(0)-"a".charCodeAt(0);var i=this.paths(t).map(e=>e.reverse()[r-1]).filter(e=>e).filter(N);return 1==i.length&&i[0]===t?t:i[n]}location_for_monosaccharide(e){var t=[...this.breadth_first_traversal()].filter(t=>t.depth===e.depth).indexOf(e);return"y"+e.depth+String.fromCharCode("a".charCodeAt(0)+t)}composition(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.root,t=this;return e?[[e]].concat(e.children.map(e=>t.composition(e))).reduce((e,t)=>e.concat(t)):[]}composition_for_tag(e){return this.composition().filter(H.bind(null,e))}clone(e){var t=new WeakMap,r=new WeakMap,n=this.breadth_first_traversal(this.root,e);for(var i of n)if(!(i instanceof h.a.Monosaccharide&&i.repeat.root!==i)){t.has(i)||t.set(i,i.clone());var a=t.get(i);if(a instanceof h.a.Monosaccharide&&(r.set(i.repeat,a.repeat),t.set(i,a.repeat.root),a=t.get(i)),i.parent instanceof h.a.Monosaccharide&&i.parent.repeat.children.indexOf(i)>=0){var o=r.get(i.parent.repeat);new c.b("Root").addChild(i.parent.linkageOf(i),a),o.children=o.children.concat(a)}else if(i.parent&&t.get(i.parent))t.get(i.parent).addChild(i.parent.linkageOf(i),a),t.get(i.parent).balance();else if(i.parent&&i.parent instanceof h.a.Monosaccharide){var s=r.get(i.parent.repeat),l=D(s.root,i.parent.counter,i.parent.original);l.addChild(i.parent.linkageOf(i),a),l.balance()}}var d=new this.constructor;return d.root=t.get(this.root),d}match_sugar_pattern(e,t){var r,n=E.search(this,e,t);return e.composition().map(e=>e.identifier).filter(e=>"*"===e).length>0?n:(r=n.map(r=>A(this,e,r,t)),[].concat.apply([],r))}trace(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.root,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>!0;return d.b.trace(this,t,e,r)}breadth_first_traversal(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.root,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e;return function*(){if(e){var r=[];for(r.push(e);r.length>0;){var n=r.shift();r=r.concat(n.children),t&&(n=t(n)),n&&(yield n)}}}()}depth_first_traversal(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.root,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e;return function*(){if(e){var r=[];for(r.push(e);r.length>0;){var n=r.shift();r=n.children.concat(r);var i=t?t(n):n;i&&(yield i)}}}()}chords(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return function*(){yield*q(e,t)}()}residues_to_root(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.root;return function*(){for(yield e;e.parent;)e=e.parent,yield e}()}static CopyIO(e){var t=this,r=I(e,"sequence").set,n=I(e,"sequence").get;return class extends t{get sequence(){return n.call(this)}set sequence(e){r.call(this,e)}}}}var z=Symbol("epimerised_identifier"),G=Symbol("original"),W=new WeakMap;class V extends c.b{constructor(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(t),this[G]=e,this[z]=t,W.set(this,r)}get identifier(){return this.epimerised?this[z]:this[G].identifier}get epimerised(){return W.get(this)}disable(){W.set(this,!1)}enable(){W.set(this,!0)}get anomer(){return this[G].anomer}get parent_linkage(){return this[G].parent_linkage}set anomer(e){}set parent_linkage(e){}set identifier(e){}clone(){var e=new this.constructor(this[G],this[z],this.epimerised);return e.copyTagsFrom(this),e}}var U=Symbol("reactions"),X=Symbol("reactionset"),Y=Object(u.a)("glycanjs:reactionset"),Z=Symbol("has_been_epimerised"),K=e=>t=>t.setTag(e,null),$=e=>t=>e.indexOf(t)<0,Q=(e,t,r)=>r.indexOf(e)===t,J=(e,t)=>{if(!e||!t)return!1;if("*"===e.identifier||"*"===t.identifier)return!0;var r=((e,t)=>e.getTag(Z)===t.identifier||(t.getTag(Z)===e.identifier||e.identifier===t.identifier))(e,t),n=!1,i=!1;return e.parent&&t.parent&&(n=0===e.parent.linkageOf(e)||0===t.parent.linkageOf(t)||e.parent.linkageOf(e)===t.parent.linkageOf(t),e.anomer===t.anomer&&(i=!0)),e.parent||t.parent||(n=!0,i=!0),r&&n&&i},ee=function(e,t){var r=this.delta;return e.map(e=>{var n=A(t,r,e,J);return n=n.filter((e=>t=>t.root.original===e)(e))}).filter(e=>e.length>0)},te=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=[];for(var n of this.positive){var i=Symbol("curr_attachment");n.tagSubstrateResidues(e,i,t);var a=e.composition_for_tag(i);a.forEach(K(i)),r=r.concat(a)}if(r.length<1)return r;for(var o of this.negative){var s=Symbol("curr_attachment");o.tagSubstrateResidues(e,s,t);var l=e.composition_for_tag(s);if(l.forEach(K(s)),(r=r.filter($(l))).length<1)return r}return r};class re{constructor(){this[U]=[]}get delta(){return this.positive[0].delta}get positive(){return this[U].filter(e=>!e.negative)}get negative(){return this[U].filter(e=>e.negative)}addReactionRule(e){this[U].push(e)}tagSubstrateResidues(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Symbol("substrate"),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;for(var n of te.call(this,e,r))n.setTag(t);return t}tagAvailableSubstrateResidues(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Symbol("substrate"),r=te.call(this,e),n=ee.call(this,r,e);n=(n=[].concat.apply([],n)).map(e=>e.root.original);var i=r.filter(e=>n.indexOf(e)<0);for(var a of i)!a.parent&&a.children.length>0&&a.linkageOf(a.children[0])<0||a.setTag(t);return t}worksOn(e){return te.call(this,e).length>0}execute(){}generate(){}}var ne=(e,t,r)=>{if(!(r.length<1)){var n=new re;for(var i of r){var a=null;t.has(i)?a=t.get(i):((a=new e).sequence=i,t.set(i,a)),n.addReactionRule(a)}return n}};var ie=new Map;class ae{constructor(){this[X]=[]}static groupFromJSON(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=new this,i=xe.CopyIO(new t),a=Object.keys(e);for(var o of a=r.filter(e=>a.indexOf(e)>=0).concat(a.filter(e=>r.indexOf(e)<0)))if(e[o].reactions.length>0)for(var s of e[o].reactions.map(ne.bind(null,i,ie)))s&&n.addReactionSet(s);return n}get reactions(){return this[X]}addReactionSet(e){return this[X].indexOf(e)<0&&this[X].push(e),e}tagSubstrateResidues(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.reactions,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Symbol("substrate");for(var n of t)n.tagSubstrateResidues(e,r,null);return r}tagAvailableSubstrateResidues(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.reactions,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Symbol("substrate");for(var n of t)n.tagAvailableSubstrateResidues(e,r);return r}supportsLinkageAt(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.reactions;if(!t)return function(e,t){var r=[],n=[],i=[],a=function(){var t=e.composition_for_tag(o.tagAvailableSubstrateResidues(e));if(t.length>0){var a=o.delta.root.children[0],s=o.delta.root.linkageOf(a);if(!t.some(e=>void 0===e.childAt(s)))return 1;var l="Root"!==o.delta.root.identifier?o.delta.sequence:a.toSugar(o.delta.constructor).sequence;r.push(s),i.push(l),n.push(a.anomer)}};for(var o of t)a();return n=n.filter(Q),r=r.filter(Q),i=i.filter(Q),{anomer:n,linkage:r,donor:i,substrate:[]}}(e,i);var a=[],o=[],s=this.reactions.filter(e=>{var r=e.delta.root.children[0];if(!r)return!1;var n=r.toSugar(e.delta.constructor).sequence;e.delta.root.linkageOf(r);return!t||n===t}),l=new WeakMap;s.forEach(t=>{var r=e.composition_for_tag(t.tagAvailableSubstrateResidues(e));if(r.length>0){var n=t.delta.root.children[0],i=t.delta.root.linkageOf(n),s=r.filter(e=>void 0===e.childAt(i));l.set(t,s),s.length>0&&(a.push(i),o.push(n.anomer))}});var c=s.filter(e=>(l.get(e)||[]).length>0),h=c;if(o=o.filter(Q),a=a.filter(Q),Y.info("Remaining reactions after filtering by donor ".concat(s.length)),Y.info("Remaining reactions after filtering by used_linakge ".concat(c.length)),c.length<1||void 0===r&&void 0===n){var d=c.map(e=>l.get(e)).flat().filter(Q);return c.length>0?{anomer:o,linkage:a,substrate:d}:{anomer:[],linkage:[],substrate:[]}}if(void 0!==r){var u=h.filter(e=>{var t=e.delta.root.children[0],n=e.delta.root.linkageOf(t);return 0===n||n===r});if(h=u,Y.info("Remaining reactions after filtering by linkage ".concat(u.length)),u.length<1)return u.length>0?{anomer:o,linkage:[r],substrate:[]}:{anomer:[],linkage:[],substrate:[]}}n&&(a=[],o=[]);var f=[];for(var p of h){if(l.get(p).indexOf(n)>=0){var g=p.delta.root.children[0],v=p.delta.root.linkageOf(g);a.push(v),o.push(g.anomer),f.push(g.anomer+v)}}return o=o.filter(Q),(a=a.filter(Q)).length>0&&o.length>0&&n?{anomer:o,linkage:a,anomerlinks:f,substrate:[n]}:{anomer:o,linkage:a,substrate:[]}}supportLinkages(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.reactions,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Symbol("with_support"),n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=new WeakMap;for(var a of e.composition_for_tag(Z))a.setTag(Z,null),a.setTag(v,null);for(var o of t){i.has(o)||i.set(o,{substrate:Symbol("substrate"),residue:Symbol("residue")});var s=!1;if(o instanceof re)for(var l of o.positive){var c=l.composition().filter(e=>e instanceof V);c.length>0&&(s=!0,l.delta.root.setTag(Z,c[0].identifier)),c.forEach(e=>{e.enable()})}if(o.tagSubstrateResidues(e,i.get(o).substrate,n),o instanceof re)for(var h of o.positive){h.composition().filter(e=>e instanceof V).forEach(e=>e.disable())}var d=e.composition_for_tag(i.get(o).substrate),u=ee.call(o,d,e),f=u.map(e=>{var t=e[0];return t.composition(t.root.children[0]).map(e=>e.original)});if(s)for(var p of u.flat())for(var g of p.composition_for_tag(Z))g.original.setTag(Z,g.getTag(Z)),g.original.setTag(v,!0);for(var m of[].concat.apply([],f))m.getTag(Z)&&s||(m.setTag(i.get(o).residue),m.setTag(r))}return this.map=i,r}}var oe=Symbol("comment_string"),se=Symbol("is_negative"),le=Symbol("reaction_sugar"),ce=Symbol("reaction_position"),he=Symbol("reaction_position_string"),de=Symbol("Sequence Cache"),ue=e=>class extends e{get sequence(){return super.sequence.replace(/Root/,"")}set sequence(e){super.sequence=e}},fe=(Symbol("search_cache"),new Map),pe=function(e,t){var r,n,i=t===de;t&&(fe.has(t)?r=fe.get(t):(r=i?new Map:new WeakMap,fe.set(t,r)),(n=r.get(i?e.sequence:e))||(n=new Map,r.set(i?e.sequence:e,n)));var a=this.composition().some(e=>e instanceof V),o=this.sequence+this[he],s=(!!n&&n.has(o),n&&n.has(o)?n.get(o):null);s||(s=(e.match_sugar_pattern(this,J)||[]).map(e=>{var t=e.composition_for_tag(this.attachment_tag)[0];if(t)return t.original}).filter(e=>e),!n||a&&0!=s.length||(i?n.set(o,s.map(t=>e.location_for_monosaccharide(t))):n.set(o,s)));return i&&s[0]&&"string"==typeof s[0]&&(s=s.map(t=>e.locate_monosaccharide(t))),s},ge=function(e,t){var r;r=t?[e.location_for_monosaccharide(t)]:[...pe.call(this,e)].map(t=>e.location_for_monosaccharide(t));var n=new Set;for(var i of r){var a=e.locate_monosaccharide(i),o=this[le].clone();if("Root"!==o.root.identifier){var s=new V(a,o.root.identifier,!0);if(a instanceof h.a.Monosaccharide&&a.repeat.mode==h.a.MODE_MINIMAL&&!(a.parent instanceof h.a.Monosaccharide)){var l=a.parent,c=a.repeat;for(var d of(a.original.donateChildrenTo(s),c.template.root.parent.replaceChild(a.original,s),c.template.root=s,l.replaceChild(a,c.root),a=s,n.add(s),o.root.children))a.graft(d),[...o.composition(d)].forEach(n.add,n);var u=c.clone();u.children=c.children,c.root.parent.replaceChild(c.root,u.root)}else{for(var f of o.root.children)a.graft(f),[...o.composition(f)].forEach(n.add,n);a.donateChildrenTo(s),s.copyTagsFrom(a),(a=e.locate_monosaccharide(i))!==e.root?a.parent.replaceChild(a,s):(e.root=s,a=s),n.add(s)}}else for(var p of(a instanceof h.a.Monosaccharide&&a.repeat.mode==h.a.MODE_MINIMAL&&(a=a.original),o.root.children))a.graft(p),[...o.composition(p)].forEach(n.add,n)}return[...n]},ve=function(e){var t=[],r=Symbol("attach");for(var n of pe.call(this,e)){var i=this[le].clone();n.setTag(r,!0);var a=e.clone(),o=a.composition_for_tag(r)[0];for(var s of i.root.children)o.graft(s);n.setTag(r,null),o.setTag(r,null),t.push(a)}return t},me=function(e,t){var r=this.delta;return e.filter(e=>0==t.trace(r,e,J).length)};class ye extends B{set comment(e){this[oe]=e,(e=>{var t=e[oe],r=!1;0===t.indexOf("!")&&(t=t.substring(1),r=!0);var[n,i]=t.split("@");n=n.replace(/[{}]/g,"");var a=new(ue(B.CopyIO(e)));if(e[se]=r,a.sequence=n,e[le]=a,e[ce]=((e,t)=>e.locate_monosaccharide(t))(e,i),!e[ce])throw new Error("Cannot locate attachment point");if("Root"!==a.root.identifier){var o=e[ce],s=new V(o,a.root.identifier,!1);o.donateChildrenTo(s),s.copyTagsFrom(o),o.parent?o.parent.replaceChild(o,s):e.root=s,e[ce]=s}e[he]=i,e.attachment_tag=Symbol("attachment"),e[ce].setTag(e.attachment_tag)})(this),this.freeze(),this.delta.freeze()}get comment(){if(!this.delta)return this[oe]}get delta(){return this[le]}get negative(){return this[se]}tagSubstrateResidues(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Symbol("substrate"),r=pe.call(this,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null);if(this.negative){var n=me.call(this,r,e);r=r.filter(e=>n.indexOf(e)<0)}return r.forEach(e=>e.setTag(t)),t}tagAvailableSubstrateResidues(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Symbol("substrate"),r=pe.call(this,e),n=me.call(this,r,e);return(r=r.filter(e=>n.indexOf(e)<0)).forEach(e=>e.setTag(t)),t}worksOn(e){var t=pe.call(this,e);return t.length<1?this.negative||!1:!this.negative||me.call(this,t,e).length>0}execute(e,t){return ge.call(this,e,t)}generate(e){return ve.call(this,e)}}ye.Comparator=J;var be,we,xe=ye,_e=e=>{if(e<0){if(e===c.b.LINKAGES.O)return"O";if(e===c.b.LINKAGES.N)return"N"}return e<=0?"?":""+e},ke=e=>c.b.LINKAGES[e]?c.b.LINKAGES[e]:"?"==e?0:parseInt(e),Oe=(e,t)=>new(0,e.constructor.Monosaccharide)(t);be=(e,t)=>{var r=t.shift();if(!r)throw new Error("Empty branch");var[n,i]=r.split("("),a=Oe(e,n);return we(e,a,t),[a,i]},we=(e,t,r)=>{for(var n=[],i=(e,t)=>e.addChild(t[0],t[1]);r.length>0;){var a=r.shift();if("]"==a){var[o,s]=be(e,r),[l,c,,h]=(s||"").split("");o.anomer=l,o.parent_linkage=ke(c),n.push([ke(h),o])}else{if("["==a)return n.reverse().forEach(i.bind(null,t)),void(n.length=0);var[d,u]=a.split("("),[f,p,,g]=(u||"").split(""),v=Oe(e,d);v.anomer=f,v.parent_linkage=ke(p),t.addChild(ke(g),v),n.reverse().forEach(i.bind(null,t)),n.length=0,t=v}}};var Se=function(e){return e.split("").reverse().join("")},Me=e=>t=>t.identifier==="Repeat".concat(e),Ce=function(e){var t="";""!==e&&([,e,t]=e.match(/([^+]+)(?:\+(".+"))*/)),t=(t||"").replace(/^"/,"").replace(/"$/,"");for(var r,n=/{([^}@]+)(?:@([a-z]\d+[a-z]))?}([a-z]|\d+)/g,i=0,a={},o=e;null!==(r=n.exec(e));)o=o.replace(r[0],"Repeat".concat(++i,"(u?-?)")),a[i]={seq:r[1],attachment:r[2],variable:r[3]};(e=o).match(/[\])]$/)&&(e="".concat(e,"Root"));var s=(e+=")").split(/([[\]])/);if(s=s.map(e=>e.split(/\)(?=[A-Za-z*])/).reverse().join(")")).map(e=>e.match(/\d$/)?e+")":e),s=[].concat.apply([],s.map(e=>Se(e).split(")").filter(e=>e.length).map(Se))).reverse(),this.root=null,s.length>0){var l=Oe(this,s.shift());we(this,l,s),this.root=l}return((e,t)=>{var r=e.composition();for(var n of Object.keys(t)){var i=r.filter(Me(n)).shift();if(i){var a=t[n].seq,o=1,s="";t[n].variable.match(/^\d+$/)&&(s=""+(o=parseInt(t[n].variable))),t[n].variable.match(/[a-z]/)&&(s=t[n].variable);var l=new(0,e.constructor);l.sequence=a;var c=t[n].attachment;if(!c){for(var d=l.root;d.children&&d.children.length>0;)d=d.children[0];c=l.location_for_monosaccharide(d)}var u=new h.a(l,c,1,o);u.mode=h.a.MODE_MINIMAL,s&&(u.identifier=s);var f=i.parent;f.removeChild(f.linkageOf(i),i),f.graft(u.root),i.children.length>0&&(u.children=i.children)}}r=e.composition()})(this,a),t&&(this.comment=t),this.root},Ee=e=>{var t=e.toString();if(e instanceof h.a.Monosaccharide){if(e.repeat.mode===h.a.MODE_MINIMAL)return"{".concat(e.repeat.template.sequence.replace(/\([a-z]\d+-$/,""));if(e.repeat.mode===h.a.MODE_EXPAND)return"".concat(t)}return t},Ae=e=>e.parent?"("+e.anomer+_e(e.parent_linkage)+"-":"",Te=function(e){var t=e[0];return e[1].map(e=>[t,e])},Le=e=>e instanceof h.a.Monosaccharide&&e.repeat.root===e&&e.repeat.mode===h.a.MODE_MINIMAL?(e.repeat.off_main?"@".concat(e.repeat.attachment):"")+"}".concat(e.repeat.identifier):"",Pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.root;if(e){var t=[];if(e instanceof h.a.Monosaccharide&&e.repeat.mode===h.a.MODE_MINIMAL&&e.repeat.root===e){var r=e.repeat.children;t=r.length>0?[].concat.apply([],[...r[0].parent.child_linkages].map(t=>{var[r,n]=t;return[r,n.filter(t=>!(t instanceof h.a.Monosaccharide&&t.repeat===e.repeat))]}).sort((e,t)=>e[0]-t[0]).map(Te)):[]}else t=[].concat.apply([],[...e.child_linkages].sort((e,t)=>e[0]-t[0]).map(Te));var n=""+t.map(e=>Pe.call(this,e[1])+_e(e[0])+")"+Le(e[1])).reduce((e,t)=>e?e+"["+t+"]":t,""),i=n+Ee(e)+Ae(e);return e===this.root&&this.comment?"".concat(i,'+"').concat(this.comment,'"'):i}},qe=function(e,t){for(var r=null;!(r=Object.getOwnPropertyDescriptor(e,t))&&Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return r},Re=function(e){var t=(qe(e.prototype,"sequence")||{get:null}).get,r=function(e){Ce.call(this,e)},n={};return t&&(n.get=t),r&&(n.set=r),Object.defineProperty(e.prototype,"sequence",n),class extends e{}},Ie=function(e){var t=(qe(e.prototype,"sequence")||{set:null}).set,r=function(){return Pe.call(this,this.root)},n={};return r&&(n.get=r),t&&(n.set=t),Object.defineProperty(e.prototype,"sequence",n),class extends e{}},Ne=e=>Re(Ie((e=>class extends e{})(e)));function He(e,t,r,n){this._bounds=e,this.children=[],this.nodes=[],n&&(this._maxChildren=n),r&&(this._maxDepth=r),t&&(this._depth=t)}function Fe(e,t,r,n){He.call(this,e,t,r,n),this._stuckChildren=[]}function je(e,t,r,n){var i;i=t?new He(e,0,r,n):new Fe(e,0,r,n),this.root=i}He.prototype.nodes=null,He.prototype._classConstructor=He,He.prototype.children=null,He.prototype._bounds=null,He.prototype._depth=0,He.prototype._maxChildren=4,He.prototype._maxDepth=4,He.TOP_LEFT=0,He.TOP_RIGHT=1,He.BOTTOM_LEFT=2,He.BOTTOM_RIGHT=3,He.prototype.insert=function(e){if(this.nodes.length){var t=this._findIndex(e);this.nodes[t].insert(e)}else{this.children.push(e);var r=this.children.length;if(this._depth<this._maxDepth&&r>this._maxChildren){var n;for(this.subdivide(),n=0;n<r;n++)this.insert(this.children[n]);this.children.length=0}}},He.prototype.retrieve=function(e){if(this.nodes.length){var t=this._findIndex(e);return this.nodes[t].retrieve(e)}return this.children},He.prototype._findIndex=function(e){var t=this._bounds,r=!(e.x>t.x+t.width/2),n=!(e.y>t.y+t.height/2),i=He.TOP_LEFT;return r?n||(i=He.BOTTOM_LEFT):i=n?He.TOP_RIGHT:He.BOTTOM_RIGHT,i},He.prototype.subdivide=function(){var e=this._depth+1,t=this._bounds.x,r=this._bounds.y,n=this._bounds.width/2,i=this._bounds.height/2,a=t+n,o=r+i;this.nodes[He.TOP_LEFT]=new this._classConstructor({x:t,y:r,width:n,height:i},e,this._maxDepth,this._maxChildren),this.nodes[He.TOP_RIGHT]=new this._classConstructor({x:a,y:r,width:n,height:i},e,this._maxDepth,this._maxChildren),this.nodes[He.BOTTOM_LEFT]=new this._classConstructor({x:t,y:o,width:n,height:i},e,this._maxDepth,this._maxChildren),this.nodes[He.BOTTOM_RIGHT]=new this._classConstructor({x:a,y:o,width:n,height:i},e,this._maxDepth,this._maxChildren)},He.prototype.clear=function(){this.children.length=0;var e,t=this.nodes.length;for(e=0;e<t;e++)this.nodes[e].clear();this.nodes.length=0},Fe.prototype=new He,Fe.prototype._classConstructor=Fe,Fe.prototype._stuckChildren=null,Fe.prototype._out=[],Fe.prototype.insert=function(e){if(this.nodes.length){var t=this._findIndex(e),r=this.nodes[t];e.x>=r._bounds.x&&e.x+e.width<=r._bounds.x+r._bounds.width&&e.y>=r._bounds.y&&e.y+e.height<=r._bounds.y+r._bounds.height?this.nodes[t].insert(e):this._stuckChildren.push(e)}else{this.children.push(e);var n=this.children.length;if(this._depth<this._maxDepth&&n>this._maxChildren){var i;for(this.subdivide(),i=0;i<n;i++)this.insert(this.children[i]);this.children.length=0}}},Fe.prototype.getChildren=function(){return this.children.concat(this._stuckChildren)},Fe.prototype.retrieve=function(e){var t=this._out;if(t.length=0,this.nodes.length){var r=this._findIndex(e),n=this.nodes[r];e.x>=n._bounds.x&&e.x+e.width<=n._bounds.x+n._bounds.width&&e.y>=n._bounds.y&&e.y+e.height<=n._bounds.y+n._bounds.height?t.push.apply(t,this.nodes[r].retrieve(e)):(e.x<=this.nodes[He.TOP_RIGHT]._bounds.x&&(e.y<=this.nodes[He.BOTTOM_LEFT]._bounds.y&&t.push.apply(t,this.nodes[He.TOP_LEFT].getAllContent()),e.y+e.height>this.nodes[He.BOTTOM_LEFT]._bounds.y&&t.push.apply(t,this.nodes[He.BOTTOM_LEFT].getAllContent())),e.x+e.width>this.nodes[He.TOP_RIGHT]._bounds.x&&(e.y<=this.nodes[He.BOTTOM_RIGHT]._bounds.y&&t.push.apply(t,this.nodes[He.TOP_RIGHT].getAllContent()),e.y+e.height>this.nodes[He.BOTTOM_RIGHT]._bounds.y&&t.push.apply(t,this.nodes[He.BOTTOM_RIGHT].getAllContent())))}return t.push.apply(t,this._stuckChildren),t.push.apply(t,this.children),t},Fe.prototype.getAllContent=function(){var e,t=this._out;if(this.nodes.length)for(e=0;e<this.nodes.length;e++)this.nodes[e].getAllContent();return t.push.apply(t,this._stuckChildren),t.push.apply(t,this.children),t},Fe.prototype.clear=function(){this._stuckChildren.length=0,this.children.length=0;var e=this.nodes.length;if(e){var t;for(t=0;t<e;t++)this.nodes[t].clear();this.nodes.length=0}},je.prototype.root=null,je.prototype.insert=function(e){if(e instanceof Array){var t,r=e.length;for(t=0;t<r;t++)this.root.insert(e[t])}else this.root.insert(e)},je.prototype.clear=function(){this.root.clear()},je.prototype.retrieve=function(e){return this.root.retrieve(e).slice(0)};var De=je,Be=Object(u.a)("glycanjs:condensedlayout"),ze=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{dx:0,dy:0,r:.5},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=this.DELTA_Y,a=this.DELTA_X;if(r.collision=[],t.children.length>1&&!r.spread_count&&(r.spread_count=t.children.length,r.spread=1),!t.parent)return r;if(r.dy=-1*i,r.dx=0,!r.item_index&&n.spread_count){var o=t.parent.children;r.item_index=o.indexOf(t)+1}return n.spread&&(r.dy=-1*n.spread*i,r.dx=n.spread*a*(r.item_index-1-Math.floor(n.spread_count/2)+.5*(1-n.spread_count%2))),(!n.spread||n.spread<2)&&(r.dy+=-1*r.r),n.grid_spread&&(r.dx=a*r.item_index),r},Ge=e=>{var t=e.map(e=>e.position.x),r=Math.min(...t),n=Math.max(...t)-r,i=Math.min(...t),a=Math.max(...t)-i,o=new De({x:r,y:i,width:n,height:a});for(var s of e.map((e,t)=>Object.assign({idx:t},e.position)))!0!==s.ignore_overlap&&o.insert(s);for(var l=0;l<e.length;l++)if(!0!==e[l].position.ignore_overlap){var c=e[l].position,h=o.retrieve(c);for(var d of h)if(d.idx!==l&&e[l].item.parent!=e[d.idx].item&&e[d.idx].item.parent!=e[l].item){var u=e[d.idx].position;if(!(u.collision.indexOf(c)>=0&&c.collision.indexOf(u)>=0)){var f=c.x-u.x,p=c.y-u.y,g=c.r+u.r;f*f+p*p<g*g&&(u.collision.push(c),c.collision.push(u))}}}},We=(e,t)=>{return!t.parent&&1==t.children.length&&t.linkageOf(t.children[0])<0?(r=e.get(t),t.identifier,r.x=-1*r.r,r.y=1,r.width=2*r.r,r.height=2*r.r,{position:e.get(t),item:t}):(((e,t)=>{e.x=-1*e.r,e.y=-1*e.r,e.width=2*e.r,e.height=2*e.r,t&&(e.x+=t.x+t.width/2+e.dx,e.y+=t.y+t.height/2+e.dy)})(e.get(t),t.parent?e.get(t.parent):null),Be.info("Position for",t.identifier,e.get(t).x,e.get(t).y),{position:e.get(t),item:t});var r},Ve=(e,t)=>!e[t],Ue=(e,t)=>e.get(t),Xe=(e,t)=>[...e.residues_to_root(t)],Ye=class{static get DELTA_X(){return this.LINKS,1}static get DELTA_Y(){return this.LINKS?1:.5}static get SPREAD_DELTA(){return 1}static LayoutMonosaccharide(e,t,r,n){return ze.call(this,e,t,r,n)}static CalculateIdentifier(e){return e.identifier.toLowerCase()}static PerformLayout(e){for(var t=new WeakMap,r=[...e.breadth_first_traversal()],n=20;n>=0;){for(var i of(Be.info("Looping to resolve overlaps on loop",n--),r)){var a=t.has(i)?t.get(i):void 0,o=i.parent&&t.has(i.parent)?t.get(i.parent):void 0;t.set(i,this.LayoutMonosaccharide(e,i,a,o,t))}var s=r.map(We.bind(null,t));Ge(s);var l=s.filter(e=>e.position.collision.length>0).map(e=>e.item),c=new WeakMap;for(var h of l)c.set(t.get(h),h);if(l.length<1){Be.info("No overlaps to resolve - breaking");break}var d=new WeakMap;for(var u of l){var f=[].concat.apply([],t.get(u).collision.map(Ue.bind(null,c)).map(Xe.bind(null,e)));for(var p of(Be.info(u.identifier,"collides with",f[0].identifier,"at",t.get(u).x,t.get(u).y,t.get(u).collision.map(e=>[e.x,e.y]),"which is a child of",f.map(e=>e.identifier)),e.residues_to_root(u)))if(p!==u&&(d.has(p)||d.set(p,[]),f.indexOf(p)>=0)){Be.info("Overlap root of",p.identifier,"for",u.identifier),d.get(p).push(u);break}}var g={};for(var v of[].concat(r).reverse())if(d.has(v)){var m=d.get(v).filter(Ve.bind(null,g));for(var y of m)g[y]=!0;m.length>0&&(t.get(v).spread=(t.get(v).spread||0)+this.SPREAD_DELTA,Be.info("Increasing spread for",v.identifier,"to",t.get(v).spread))}}if(Be.enabled)for(var b of(Be.info("Done layout for",e.sequence),r))Be.info("Laid out",b.identifier,t.get(b));return t}};Ye.LINKS=!0;var Ze=Ye,Ke=e=>"HSO3"!==e.identifier,$e=["Xyl","HSO3","Rbo","P","GlcN"];class Qe extends(Ne(B)){}var Je=new Qe;Je.sequence="Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc";var et=(e,t)=>!(!e||!t)&&e.identifier===t.identifier,tt=function(e,t,r,n){var i=this.LINKS?2/3*5/4*r:2*r/3,a=this.LINKS?2/3*2/3*n:2*n/3;t.r=1/4*r;var o=e.parent.linkageOf(e);return 2!==o&&6!==o&&o!==c.b.LINKAGES.N||(t.dy=0*a,t.dx=.5*i,2!==o&&o!==c.b.LINKAGES.N||(t.dx*=-1)),3!==o&&4!==o||(t.dy=-1*a,t.dx=.5*i,3===o&&(t.dx*=-1),4===o&&(t.dx=0*i)),t.ignore_overlap=!0,t},rt=new WeakMap;class nt extends Ze{static CalculateIdentifier(e){var t=e.identifier.toLowerCase(),r=e.parent?e.parent.linkageOf(e):null;r===c.b.LINKAGES.N&&(r="N"),r===c.b.LINKAGES.O&&(r="O");var n=e.parent&&("hso3"===t||"me"==t)&&r?"."+r:"";return"".concat(t).concat(n)}static get DELTA_X(){return 1.25*super.DELTA_X}static get DELTA_Y(){return 1.25*super.DELTA_Y}static get SPREAD_DELTA(){return.25*super.SPREAD_DELTA}static LayoutMonosaccharide(e,t,r,n,i){var a=this.DELTA_Y,o=this.DELTA_X;if(r=Ze.LayoutMonosaccharide.call(this,e,t,r,n),$e.indexOf(t.identifier)>=0&&(r.keep_horizontal=!0),!rt.get(r)&&!this.LINKS&&!r.ignore_overlap){var s=e.match_sugar_pattern(Je,et);rt.set(r,!0),s.length>0&&s[0].composition().map(e=>e.original).indexOf(t)>=0&&(this.LINKS||(r.ignore_overlap=!0))}var l=t.siblings;if(1==l.filter(Ke).length&&("Fuc"==t.identifier||"NeuAc"==t.identifier)||t.parent&&t.parent.endsRepeatUnit&&t.parent.repeat.mode==h.a.MODE_MINIMAL&&"Fuc"==t.identifier)return"NeuAc"==t.identifier&&"Fuc"==l.filter(Ke)[0].identifier?(r.dx=0,r.dy=-1*a,r.dy-=r.r,r):(r.dy=0,r.dx=[2,3].indexOf(t.parent.linkageOf(t))>=0?-1*o:o,"Fuc"==t.identifier?(r.rotate=r.dx<0?90:-90,r.dx=r.dx<0?-.75:.75,r):(this.LINKS&&(r.dx+=(r.dx<0?-1:1)*o/4),r));if("PI"===t.identifier&&(r.r=.75),"GlcN"===t.identifier&&"PI"===t.parent.identifier)return r.dx=.5*o,r;if("EtNP"===t.identifier){var c=t.parent.linkageOf(t);2===c&&(r.dy=0,r.dx=-.66*o,r.rotate=-90),6===c&&1===t.parent.children.length&&(r.dy=-1.25*a,r.dx=0),6===c&&t.parent.children.length>1&&(r.dx=.66*o,r.dy=0,r.rotate=90),r.ignore_overlap=!0}if("HSO3"===t.identifier||"Me"===t.identifier)return tt.call(this,t,r,o,a);if(1==l.length&&"P"===t.identifier)return r.dy=0,r.dx=t.parent.linkageOf(t)>=0?o:-1*o,this.LINKS&&(r.dx+=(r.dx<0?-1:1)*o/4),r;if(1==l.length&&"GlcNAc"===t.identifier&&"GlcNAc"==l[0].identifier)return 3===t.parent.linkageOf(t)&&(r.dx=0),r;if(0==l.filter(Ke).filter(e=>["Fuc","NeuAc"].indexOf(e.identifier)<0).length&&l.filter(Ke).filter(e=>["Fuc","NeuAc"].indexOf(e.identifier)>=0).length<=1&&(r.dx=0),1===l.length&&["P","HSO3","EtNP"].indexOf(l[0].identifier)>=0&&(r.dx=0),2===l.length&&[t].concat(l).map(e=>e.identifier).indexOf("Fuc")>=0&&[t].concat(l).map(e=>e.identifier).indexOf("HSO3")>=0&&["Fuc"].indexOf(t.identifier)>=0)return r.dy=0,r.dx=t.parent.linkageOf(t)>=4?o:-1*o,"Fuc"==t.identifier&&(r.rotate=r.dx<0?90:-90,r.ignore_overlap=!0),this.LINKS&&(r.dx+=(r.dx<0?-1:1)*o/4),r;if("Man"===t.identifier&&t.siblings.length>0){var d=t.siblings.map(e=>i.get(e)).filter(e=>e).map(e=>e.spread).filter(e=>e);r.spread&&d.push(r.spread);var u=Math.max(...d);if(isFinite(u)){for(var f of t.siblings)f.children.length>0&&i.get(f)&&(i.get(f).spread=u);r.spread=u}}return r}}class it extends(Ne(B)){}var at=(e,t)=>!(!e||!t)&&e.identifier===t.identifier,ot=new it;ot.sequence="Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc";var st=new it;st.sequence="Gal(b1-3)GalNAc";var lt,ct,ht=class extends nt{static LayoutMonosaccharide(e,t,r,n,i){var a=2*this.DELTA_Y,o=this.DELTA_X;if(r=nt.LayoutMonosaccharide.call(this,e,t,r,n,i),!t.parent)return r;if("HSO3"===t.identifier||"Me"==t.identifier)return tt.call(this,t,r,o,a/2);var s=e.match_sugar_pattern(ot,at);if(s.length>0&&s[0].composition().map(e=>e.original).indexOf(t)>=0)return this.LINKS||"Man"==t.identifier&&"Man"==t.parent.identifier&&(r.ignore_overlap=!1,r.dx=.5*r.dx,r.dy=.5*r.dy),r;if((s=e.match_sugar_pattern(st,at)).length>0){0;var l=s[0].composition().map(e=>e.original);if(l[0]&&l[0].parent&&["Ser","Thr","Tyr"].indexOf(l[0].parent.identifier)<0);else{if(l.indexOf(t)>=0)return r;if(t.siblings.filter(e=>l.indexOf(e)>=0).length>0)return r}}var c=t.parent.linkageOf(t),h="Fuc"===t.identifier;switch(c){case 0:r.dx=0,r.dy=-1*a;break;case 2:r.dx=-1*o*(n.spread||1),r.dy=0,h&&(r.rotate=90);break;case 3:r.dx=-1*o,r.dy=-1*a,h&&(r.rotate=0);break;case 4:r.dx=0,r.dy=-1*a,h&&(r.rotate=180);break;case 6:r.dx=1*o,r.dy=-1*a,h&&(r.rotate=this.LINKS?206:225);break;case 8:r.dx=1*o,r.dy=0}return r}},dt=Object(u.a)("glycanjs:fisheyelayout"),ut=3,ft=[-100,-3],pt=!0;function gt(){lt=(lt=Math.exp(ut))/(lt-1)*2,ct=ut/2}function vt(e){var t=e.x-ft[0],r=e.y-ft[1],n=Math.sqrt(t*t+r*r);if(!n||n>=2)return{x:e.x,y:e.y,z:n>=2?1:10};var i=lt*(1-Math.exp(-n*ct))/n*.75+.25;return{x:ft[0]+t*i,y:ft[1]+r*i,z:Math.min(i,10)}}gt();var mt=e=>class extends e{static get focus(){return[].concat(ft)}static set focus(e){ft[0]=e[0],ft[1]=e[1],gt()}static get zoom(){return ut}static set zoom(e){ut=e,gt()}static get lock_residues(){return pt}static set lock_residues(e){pt=e}static PerformLayout(t){dt("Performing FishEyeLayout");var r=e.PerformLayout.call(this,t);for(var n of t.composition()){var i=r.get(n),[a,o,s,l]=[i.x,i.y,i.width,i.height],c=vt({x:a+s/2,y:o+l/2}),h=vt({x:a+s/2,y:o+l}),d=vt({x:a+s,y:o+l/2}),u=Math.max(2*(h.y-c.y),2*(d.x-c.x));pt?(i.x=i.x-(u-s)/2,i.y=i.y-(u-l)/2):(i.x=c.x-u/2,i.y=c.y-u/2),i.z=c.z,i.width=u,i.height=u}return r}},yt=mt(nt),bt=r(10),wt=r(12),xt=r(6),_t=Symbol("C"),kt=Symbol("H"),Ot=Symbol("O"),St=Symbol("N"),Mt=Symbol("P"),Ct=Symbol("S"),Et=Symbol("Na"),At=new Map;At.set(_t,12),At.set(kt,1.007825035),At.set(Ot,15.99491463),At.set(St,14.003074),At.set(Et,22.989771);class Tt{constructor(e){this.atom=e}}class Lt{constructor(e){this.name=e}can_accept(e,t){return!0}apply(e){return[].concat(e)}reducing_end(e){return e}static Apply(e,t){var r=Array.from(e);for(var n of t)if(n instanceof Tt){var i=r.indexOf(n.atom);if(i<0)throw new Error("Bad index");r.splice(i,1)}else r.push(n);return r}}var Pt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3?arguments[3]:void 0;!n&&r&&(n=[Ot,[kt].concat(r),[kt].concat(r)].flat());var i=class extends Lt{constructor(){super(e)}get reducing_end_atoms(){return n}get derivative_atoms(){return r}can_accept(e,r){return t(e,r)}apply(e){var t=super.apply(e);return Lt.Apply(t,r)}reducing_end(e){var t=super.apply(e);return Lt.Apply(t,n)}};return Object.freeze(new i)},qt=Pt("underivatised"),Rt=Pt("permethylated",e=>e.indexOf(Ot)>=0&&e.indexOf(kt)>=0||e.indexOf(St)>=0&&e.indexOf(kt)>=0,[_t,kt,kt]),It=(Pt("2AB",e=>e,[],[_t,_t,_t,_t,_t,_t,_t,kt,kt,kt,kt,kt,kt,kt,kt,St,St,Ot]),Pt("ethyl ester",(e,t)=>1==t,[_t,_t,kt,kt,kt,kt],[]),Pt("ammonia amidation",(e,t)=>1==t,[kt,St,new Tt(Ot)],[]),e=>"H"===e?[kt]:"O"===e?[Ot]:"OH"===e?[Ot,kt]:"HOH"===e?[kt,Ot,kt]:"OO"===e?[Ot,Ot]:"NH2"===e?[St,kt,kt]:"HH"===e?[kt,kt]:"NAc"===e||"NHAc"===e?[St,kt,_t,Ot,_t,kt,kt,kt]:"NHGc"===e?[St,kt,_t,Ot,_t,kt,kt,Ot,kt]:void 0),Nt=(e,t)=>{for(var r of t){var n=e.indexOf(r);n>=0&&e.splice(n,1)}return e},Ht=e=>{var t=new Map;for(var r of e.split(";"))r.match(/^r/)?t.set(parseInt(r[1]),{atoms:[_t,kt].concat(It(r.split(":")[1])),reducing:!0}):r.match(/-/)?t.set(parseInt(r[0]),{atoms:[_t,kt]}):t.set(parseInt(r[0]),{atoms:[_t,kt].concat(It(r.split(":")[1]))});return Object.freeze(t),t},Ft=e=>{var t=[];for(var r of e.split(";")){var[n,i]=r.split(":");switch(i=parseInt(i),n){case"C":n=_t;break;case"H":n=kt;break;case"O":n=Ot;break;case"N":n=St;break;case"P":n=Mt;break;case"S":n=Ct}t=t.concat(Array(i).fill(n))}return Object.freeze(t),t},jt=(()=>{var e={};for(var t of"\nterminii:r1:x;2:x;3:x;4:x\nname:P\ntype:ion\ncomposition:P:1;H:2;O:3\n\nterminii:r1:x;2:x;3:x;4:x\nname:S\ntype:ion\ncomposition:S:1;H:1;O:3\n\nterminii:r1:OH;2eq:OH;3eq:OH;4eq:OH;5eq:-;6eq:HOH\nname:Hex\ncomposition:C:6;H:10;O:5\n\nterminii:r1:OH;2eq:OH;3eq:OH;4ax:OH;5eq:-;6eq:HOH\nname:Gal\ntype:Hex\n\nterminii:r1:OH;2eq:OH;3eq:OH;4eq:OH;5eq:-;6eq:HOH\nname:Glc\ntype:Hex\n\nterminii:r1:OH;2eq:OH;3ax:OH;4eq:OH;5eq:-;6eq:HOH\nname:Man\ntype:Hex\n\nterminii:r1:OH;2eq:OH;3eq:OH;4ax:OH;5eq:-;6eq:HOH\nname:Galf\ntype:Hex\n\nterminii:r1:OH;2eq:NAc;3eq:OH;4eq:OH;5eq:-;6eq:HOH\nname:HexNAc\ncomposition:C:8;H:13;N:1;O:5\n\nterminii:r1:OH;2eq:NAc;3eq:OH;4ax:OH;5eq:-;6eq:HOH\nname:GalNAc\ntype:HexNAc\n\nterminii:r1:OH;2eq:NAc;3eq:OH;4eq:OH;5eq:-;6eq:HOH\nname:GlcNAc\ntype:HexNAc\n\nterminii:r1:OH;2eq:OH;3eq:OH;4ax:OH;5eq:-;6eq:OO\nname:HexA\ncomposition:C:6;H:8;O:6\n\nterminii:r1:OH;2eq:OH;3eq:OH;4ax:OH;5eq:-;6eq:OO\nname:GlcA\ntype:HexA\n\nterminii:r1:OH;2eq:OH;3eq:OH;4ax:OH;5eq:-;6eq:OO\nname:IdoA\ntype:HexA\n\nterminii:1ax:OO;r2:O;3ax:H;4eq:OH;5eq:NHAc;6eq:-;7:OH;8:OH;9:HOH\nname:NeuAc\ntype:NeuAc\ncomposition:C:11;H:17;N:1;O:8\n\nterminii:1ax:OO;r2:O;3ax:H;4eq:OH;5eq:NHGc;6eq:-;7:OH;8:OH;9:HOH\nname:NeuGc\ntype:NeuGc\ncomposition:C:11;H:17;N:1;O:9\n\nterminii:r1:OH;2eq:OH;3eq:OH;4ax:OH;5eq:-;6eq:HH\nname:dHex\ncomposition:C:6;H:10;O:4\n\nterminii:r1:OH;2eq:OH;3eq:OH;4ax:OH;5eq:-;6eq:HH\nname:Fuc\ntype:dHex\n\nterminii:r1:OH;2eq:OH;3eq:OH;4ax:OH;5eq:-;6eq:HH\nname:Rha\ntype:dHex\n\nterminii:r1:OH;2eq:OH;3eq:OH;4ax:OH;5eq:H\nname:Pent\ncomposition:C:5;H:8;O:4\n\nterminii:r1:OH;2eq:OH;3eq:OH;4ax:OH;5eq:H\nname:Xyl\ntype:Pent\n\nterminii:r1:OH;2eq:OH;3eq:OH;4ax:OH;5eq:H\nname:Ara\ntype:Pent\n\nterminii:r1:OH;2eq:NH2;3eq:OH;4eq:OH;5eq:-;6eq:HOH\nname:HexN\ncomposition:C:6;H:11;N:1;O:4\n\nterminii:r1:OH;2eq:NH2;3eq:OH;4eq:OH;5eq:-;6eq:HOH\nname:GlcN\ntype:HexN\n\nterminii:r1:H\nname:Me\ntype:alkyl\ncomposition:C:1;H:3\n".replace(/^\n/,"").split("\n\n")){var r={};for(var n of t.split("\n")){var[i,a]=n.split(/^([^:]+):/).slice(1);switch(i){case"name":r.name=a;break;case"terminii":r.ring=Ht(a);break;case"type":r.type=a;break;case"composition":r.composition=Ft(a)}}e[r.name]=r,Object.freeze(r)}return e})(),Dt=e=>e.map(e=>At.get(e)).reduce((e,t)=>e+t,0),Bt=e=>{var t=jt[e];return t&&t.type&&(t=jt[t.type]),t},zt=(e,t,r)=>{var n=Array.from(e);return r.can_accept(e,t)&&(n=r.apply(e)),n},Gt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qt,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Bt(e);return n&&n.ring?Object.freeze(Array.from(n.ring.values()).filter(e=>r||!e.reducing).map(e=>Array.from(e.atoms)).map((e,r)=>zt(e,r+1,t)).map(e=>Object.freeze(e))):Object.freeze([])},Wt=Symbol("derivative"),Vt=e=>{class t extends e.Monosaccharide{get mass(){return Dt(this.atoms)}get derivative(){return this[Wt]||qt}set derivative(e){if([qt,Rt].indexOf(e)<0)throw new Error("Bad derivative");this[Wt]=e}get atoms(){var e=[Ot,...this.ring_atoms].flat();return e=Nt(e,this.derivative.reducing_end_atoms)}get ring_atoms(){return Gt(this.identifier,this.derivative)}get proto(){return(jt[this.identifier]||{}).type}}return class extends e{static get Monosaccharide(){return t}get atoms(){var e=this.composition().map(e=>e.atoms).flat();return this.root.derivative.reducing_end(e)}get mass(){return Dt(this.atoms)}set reducing_end(e){void 0===e&&(e=FREE_REDUCING_END)}derivatise(e){for(var t of this.composition())t.derivative=e}}},Ut=(e,t,r)=>e<=r&&0===t||(e<=t||e>r)&&0!==t,Xt=e=>{var t=e.substring(5),r=e.substring(0,5),n=r;switch(r){case"1,1-e":n="1,5-a";break;case"2,2-e":n="0,2-a";break;case"3,3-e":n="3,5-a";break;case"4,4-e":case"5,5-e":n="0,4-a";break;case"1,3-e":n="1,3-a";break;case"2,4-e":n="2,4-a";break;case"3,5-e":n="3,4-a";break;case"1,1-w":n="1,5-x";break;case"2,2-w":n="0,2-x";break;case"3,3-w":n="3,5-x";break;case"4,4-w":case"5,5-w":n="0,4-x"}return"".concat(n).concat(t)};class Yt extends d.a{get children(){var e=super.children;return((e,t)=>{var r=t;if(e){e.match(/^[bc]/);var n=e.match(/(\d),(\d)-([ax])/);if(n){var i=parseInt(n[1]),a=parseInt(n[2]),o="x"===n[3];r=r.filter(e=>{var t=e.parent.linkageOf(e),r=Ut(t>5?5:t,i,a);return o?r:!r})}}return r=r.filter(e=>!(e.type||"").match(/^[yz]/))})(this.type,e)}get parent(){if(!(this.type||"").match(/(^[bc]|-a)/))return super.parent}get mass(){return Dt(this.atoms)}get atoms(){var e,t=[],r=Array.from([[Ot]].concat(this.original.ring_atoms)),n=[];if(this.type&&(e=this.type.match(/(\d,\d)-([ax])/))){var i=e[1],[a,o]=i.split(",").map(e=>+e),s=e[2];this.original.proto;t=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n&&t>0&&(t+=1),n&&r>0&&(r+=1);for(var i=Array.from(e),a=t;a<r;)i[++a]=[];i[1].length>0&&(i=i.map((t,r)=>0==t.length?e[r]:[]));var o=n?6:5;if(r>=o)for(var s=e.length;s>=o+1;)e[s]&&(i[s]=e[s]),s-=1;return i}(r,a,o,this.identifier.indexOf("Neu")>=0),"a"===s&&(n=t.flat())}return n.length<1&&(n=Nt(r.flat(),t.flat())),n=Nt(n,this.original.derivative.reducing_end_atoms)}}var Zt=e=>class extends e{constructor(){super(),this.base_composition=[]}static get Monosaccharide(){return Yt}get is_reducing_end(){return this.chordResidues.every(e=>e.type.match(/(^[yz])|(\d,\d-[x])/))}get chord(){return this.chordResidues}set chord(e){this.base_root||(this.base_root=this.root,this.base_composition=this.composition()),this.root=this.base_root;var t=this.base_composition.filter(t=>e.chord.indexOf(t.original)>=0);this.chordResidues=e.chord.map(e=>t.filter(t=>t.original===e)[0]),this.root=e.root===this.root.original?this.root:t.filter(t=>t.original===e.root)[0]}set type(e){for(var t of this.base_composition)t.type=null;if(e){for(var r=e.split("/"),n=0;n<r.length;n++)r[n].match(/-[ew]/)&&(r[n]=Xt(r[n])),this.chordResidues[n].type=r[n];this.typestring=e;var i=this.base_root,a=this.chordResidues.filter((t,r)=>e.split("/")[r].match(/^(\d+,\d+-[ae]|[bc])/));a.length>0&&(i=a[0]),this.root=i}}get type(){return this.typestring}get mass(){return Dt(this.atoms)}get atoms(){var e,t=[kt].concat(this.root.original.derivative.derivative_atoms),r=[...this.composition().map(e=>e.atoms).flat()],n=this.type.split("/").filter((e,t,r)=>r.indexOf(e)==t);for(var i of n)i.match(/^y/)&&r.push(kt),i.match(/^b/)&&(r=r.concat(t),r=Nt(r,[kt])),i.match(/^z/)&&(r=Nt(r,[Ot,kt])),i.match(/^c/)&&(r=r.concat(t).concat([kt,Ot])),i.match(/^\d,\d-[xw]/)&&(r=r.concat(t));switch(e=(e=this.type.match(/(\d,\d-[ew])/))?e[1]:null){case"1,1-e":case"3,3-e":r.push(Ot);break;case"5,5-e":r=Nt(r,[Ot,kt,kt,_t]);break;case"3,5-e":r=r.concat([kt,kt,_t]);break;case"1,1-w":r=Nt(r,[Ot,kt,kt]);break;case"2,2-w":r=Nt(r,[kt,kt]);break;case"3,3-w":r=Nt(r,[Ot,kt,kt]);break;case"4,4-w":r=Nt(r,[kt,kt]);break;case"5,5-w":r=r.concat([Ot,kt,_t])}return this.is_reducing_end?r=r.concat(t).concat([Ot]):this.type.match(/\d,\d-[a]/)&&(r=this.root.original.derivative.reducing_end(r)),this.type.match(/^1,1-[w]/)&&(r=Nt(r,[kt])),r=Nt(r,Array(n.length-1).fill(t).flat())}},Kt=(e,t,r,n)=>{var[i,a]=e[n].split("");return i=parseInt(i),r.match(/(^[bc]|-a|-e)/)&&(i=1+t-i),r.match(/(^[yz]|-x|-w)/)&&(i-=1),r+i+a},$t=(e,t)=>t.root===e.root&&t.chord[0]!==e.root,Qt=(e,t)=>[].concat(...e.map(e=>t.map(t=>[].concat(e,t)))),Jt=function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return t?Jt(Qt(e,t),...n):e},er=["y","z","3,5-x","1,3-x","1,5-x","2,4-x","0,2-x","0,4-x"],tr=["b","c","3,5-a","1,3-a","1,5-a","2,4-a","0,2-a","0,4-a"],rr=(e,t)=>t.type.match(/^[yz]/)?e.indexOf(t.parent)<0||!((e,t)=>{if(!t)return!0;if(t.match(/^[bc]/))return!0;var r=t.match(/(\d),(\d)-([ax])/);if(r){var n=parseInt(r[1]),i=parseInt(r[2]),a="x"===r[3],o=Ut(e>5?5:e,n,i);return a?o:!o}})(t.parent.linkageOf(t),t.parent.type):e.indexOf(t)<0;var nr=class{static getFragment(e,t){var r=e.constructor,n=Zt(r),i=Object(d.c)(e,n).clone(),a=t.split("/").map(t=>{var r=t,n=t.match(/(\d+,\d+-[xw]|[yz])(\d+)(.*)/);if(n&&(r="y".concat(+n[2]+1).concat(n[3])),n=t.match(/(\d+,\d+-[ae]|[bc])(\d+)(.*)/)){var i=Math.max(...e.leaves().map(e=>e.depth));r="y".concat(i-n[2]+1).concat(n[3])}return e.locate_monosaccharide(r)}),o=e.root,s=a.filter((e,r)=>t.split("/")[r].match(/^(\d+,\d+-[ae]|[bc])/));return s.length>0&&(o=s[0]),i.chord={root:o,chord:a},i.type=t,i}static fragment(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return function*(){if(!("mass"in e))throw new Error("Sugar object class does not derive from Mass class");var r=e.constructor,n=Zt(r),i=Object(d.c)(e,n),a=Math.max(...e.leaves().map(e=>e.depth)),o=(e,t)=>e.location_for_monosaccharide(t).substring(1);for(var s of e.chords(t)){var l=[er.concat(tr)].concat(new Array(s.chord.length-1).fill(er));s.chord.indexOf(e.root)>=0&&($t(e,s)?l[s.chord.indexOf(e.root)]=l[s.chord.indexOf(e.root)].concat(["1,1-w","2,2-w","3,3-w","4,4-w","5,5-w"]):l[s.chord.indexOf(e.root)]=l[s.chord.indexOf(e.root)].concat(["1,1-e","2,2-e","3,3-e","4,4-e","5,5-e","3,5-e","1,3-e","2,4-e"]));var c=Jt.apply(null,l),h=s.chord.map(o.bind(null,e)),u=Kt.bind(null,h,a);for(var f of c)if(Array.isArray(f)||(f=[f]),!f[0].match(/^[bc]/)||s.root!==e.root){var p=i.clone();p.type=null,p.chord=s,p.type=f.map(u).join("/");var g=p.composition();p.chordResidues.some(rr.bind(null,g))||(yield p)}}for(var v of["3,5-x","1,3-x","1,5-x","2,4-x","0,2-x","0,4-x","1,1-w","2,2-w","3,3-w","4,4-w","5,5-w"]){var m=i.clone();m.type=null,m.chord={root:e.root,chord:[e.root]},m.type=v+"0a",yield m}}()}},ir=yt,ar=mt(nt),or=mt(ht);function sr(e,t,r){if(e&&e.length){var[n,i]=t,a=Math.PI/180*r,o=Math.cos(a),s=Math.sin(a);for(var l of e){var[c,h]=l;l[0]=(c-n)*o-(h-i)*s+n,l[1]=(c-n)*s+(h-i)*o+i}}}function lr(e,t){return e[0]===t[0]&&e[1]===t[1]}function cr(e,t){var r,n=t.hachureAngle+90,i=t.hachureGap;i<0&&(i=4*t.strokeWidth),i=Math.round(Math.max(i,.1));var a=1;return t.roughness>=1&&((null===(r=t.randomizer)||void 0===r?void 0:r.next())||Math.random())>.7&&(a=i),function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=r,a=Math.max(t,.1),o=e[0]&&e[0][0]&&"number"==typeof e[0][0]?[e]:e,s=[0,0];if(i)for(var l of o)sr(l,s,i);var c=function(e,t,r){var n=[];for(var i of e){var a=[...i];lr(a[0],a[a.length-1])||a.push([a[0][0],a[0][1]]),a.length>2&&n.push(a)}var o=[];t=Math.max(t,.1);var s=[];for(var l of n)for(var c=0;c<l.length-1;c++){var h=l[c],d=l[c+1];if(h[1]!==d[1]){var u=Math.min(h[1],d[1]);s.push({ymin:u,ymax:Math.max(h[1],d[1]),x:u===h[1]?h[0]:d[0],islope:(d[0]-h[0])/(d[1]-h[1])})}}if(s.sort((e,t)=>e.ymin<t.ymin?-1:e.ymin>t.ymin?1:e.x<t.x?-1:e.x>t.x?1:e.ymax===t.ymax?0:(e.ymax-t.ymax)/Math.abs(e.ymax-t.ymax)),!s.length)return o;for(var f=[],p=s[0].ymin,g=0;f.length||s.length;){if(s.length){for(var v=-1,m=0;m<s.length&&!(s[m].ymin>p);m++)v=m;s.splice(0,v+1).forEach(e=>{f.push({s:p,edge:e})})}if((f=f.filter(e=>!(e.edge.ymax<=p))).sort((e,t)=>e.edge.x===t.edge.x?0:(e.edge.x-t.edge.x)/Math.abs(e.edge.x-t.edge.x)),(1!==r||g%t==0)&&f.length>1)for(var y=0;y<f.length;y+=2){var b=y+1;if(b>=f.length)break;var w=f[y].edge,x=f[b].edge;o.push([[Math.round(w.x),p],[Math.round(x.x),p]])}p+=r,f.forEach(e=>{e.edge.x=e.edge.x+r*e.edge.islope}),g++}return o}(o,a,n);if(i){for(var h of o)sr(h,s,-i);!function(e,t,r){var n=[];e.forEach(e=>n.push(...e)),sr(n,t,r)}(c,s,-i)}return c}(e,i,n,a||1)}class hr{constructor(e){this.helper=e}fillPolygons(e,t){return this._fillPolygons(e,t)}_fillPolygons(e,t){var r=cr(e,t);return{type:"fillSketch",ops:this.renderLines(r,t)}}renderLines(e,t){var r=[];for(var n of e)r.push(...this.helper.doubleLineOps(n[0][0],n[0][1],n[1][0],n[1][1],t));return r}}function dr(e){var t=e[0],r=e[1];return Math.sqrt(Math.pow(t[0]-r[0],2)+Math.pow(t[1]-r[1],2))}class ur extends hr{fillPolygons(e,t){var r=t.hachureGap;r<0&&(r=4*t.strokeWidth),r=Math.max(r,.1);var n=cr(e,Object.assign({},t,{hachureGap:r})),i=Math.PI/180*t.hachureAngle,a=[],o=.5*r*Math.cos(i),s=.5*r*Math.sin(i);for(var[l,c]of n)dr([l,c])&&a.push([[l[0]-o,l[1]+s],[...c]],[[l[0]+o,l[1]-s],[...c]]);return{type:"fillSketch",ops:this.renderLines(a,t)}}}class fr extends hr{fillPolygons(e,t){var r=this._fillPolygons(e,t),n=Object.assign({},t,{hachureAngle:t.hachureAngle+90}),i=this._fillPolygons(e,n);return r.ops=r.ops.concat(i.ops),r}}class pr{constructor(e){this.helper=e}fillPolygons(e,t){var r=cr(e,t=Object.assign({},t,{hachureAngle:0}));return this.dotsOnLines(r,t)}dotsOnLines(e,t){var r=[],n=t.hachureGap;n<0&&(n=4*t.strokeWidth),n=Math.max(n,.1);var i=t.fillWeight;i<0&&(i=t.strokeWidth/2);var a=n/4;for(var o of e)for(var s=dr(o),l=s/n,c=Math.ceil(l)-1,h=s-c*n,d=(o[0][0]+o[1][0])/2-n/4,u=Math.min(o[0][1],o[1][1]),f=0;f<c;f++){var p=u+h+f*n,g=d-a+2*Math.random()*a,v=p-a+2*Math.random()*a,m=this.helper.ellipse(g,v,i,i,t);r.push(...m.ops)}return{type:"fillSketch",ops:r}}}class gr{constructor(e){this.helper=e}fillPolygons(e,t){var r=cr(e,t);return{type:"fillSketch",ops:this.dashedLine(r,t)}}dashedLine(e,t){var r=t.dashOffset<0?t.hachureGap<0?4*t.strokeWidth:t.hachureGap:t.dashOffset,n=t.dashGap<0?t.hachureGap<0?4*t.strokeWidth:t.hachureGap:t.dashGap,i=[];return e.forEach(e=>{var a=dr(e),o=Math.floor(a/(r+n)),s=(a+n-o*(r+n))/2,l=e[0],c=e[1];l[0]>c[0]&&(l=e[1],c=e[0]);for(var h=Math.atan((c[1]-l[1])/(c[0]-l[0])),d=0;d<o;d++){var u=d*(r+n),f=u+r,p=[l[0]+u*Math.cos(h)+s*Math.cos(h),l[1]+u*Math.sin(h)+s*Math.sin(h)],g=[l[0]+f*Math.cos(h)+s*Math.cos(h),l[1]+f*Math.sin(h)+s*Math.sin(h)];i.push(...this.helper.doubleLineOps(p[0],p[1],g[0],g[1],t))}}),i}}class vr{constructor(e){this.helper=e}fillPolygons(e,t){var r=t.hachureGap<0?4*t.strokeWidth:t.hachureGap,n=t.zigzagOffset<0?r:t.zigzagOffset,i=cr(e,t=Object.assign({},t,{hachureGap:r+n}));return{type:"fillSketch",ops:this.zigzagLines(i,n,t)}}zigzagLines(e,t,r){var n=[];return e.forEach(e=>{var i=dr(e),a=Math.round(i/(2*t)),o=e[0],s=e[1];o[0]>s[0]&&(o=e[1],s=e[0]);for(var l=Math.atan((s[1]-o[1])/(s[0]-o[0])),c=0;c<a;c++){var h=2*c*t,d=2*(c+1)*t,u=Math.sqrt(2*Math.pow(t,2)),f=[o[0]+h*Math.cos(l),o[1]+h*Math.sin(l)],p=[o[0]+d*Math.cos(l),o[1]+d*Math.sin(l)],g=[f[0]+u*Math.cos(l+Math.PI/4),f[1]+u*Math.sin(l+Math.PI/4)];n.push(...this.helper.doubleLineOps(f[0],f[1],g[0],g[1],r),...this.helper.doubleLineOps(g[0],g[1],p[0],p[1],r))}}),n}}var mr={};class yr{constructor(e){this.seed=e}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}var br={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function wr(e,t){return e.type===t}function xr(e){for(var t=[],r=function(e){for(var t=new Array;""!==e;)if(e.match(/^([ \t\r\n,]+)/))e=e.substr(RegExp.$1.length);else if(e.match(/^([aAcChHlLmMqQsStTvVzZ])/))t[t.length]={type:0,text:RegExp.$1},e=e.substr(RegExp.$1.length);else{if(!e.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];t[t.length]={type:1,text:"".concat(parseFloat(RegExp.$1))},e=e.substr(RegExp.$1.length)}return t[t.length]={type:2,text:""},t}(e),n="BOD",i=0,a=r[i];!wr(a,2);){var o=0,s=[];if("BOD"===n){if("M"!==a.text&&"m"!==a.text)return xr("M0,0"+e);i++,o=br[a.text],n=a.text}else wr(a,1)?o=br[n]:(i++,o=br[a.text],n=a.text);if(!(i+o<r.length))throw new Error("Path data ended short");for(var l=i;l<i+o;l++){var c=r[l];if(!wr(c,1))throw new Error("Param not a number: "+n+","+c.text);s[s.length]=+c.text}if("number"!=typeof br[n])throw new Error("Bad segment: "+n);var h={key:n,data:s};t.push(h),a=r[i+=o],"M"===n&&(n="L"),"m"===n&&(n="l")}return t}function _r(e){var t=0,r=0,n=0,i=0,a=[];for(var{key:o,data:s}of e)switch(o){case"M":a.push({key:"M",data:[...s]}),[t,r]=s,[n,i]=s;break;case"m":t+=s[0],r+=s[1],a.push({key:"M",data:[t,r]}),n=t,i=r;break;case"L":a.push({key:"L",data:[...s]}),[t,r]=s;break;case"l":t+=s[0],r+=s[1],a.push({key:"L",data:[t,r]});break;case"C":a.push({key:"C",data:[...s]}),t=s[4],r=s[5];break;case"c":var l=s.map((e,n)=>n%2?e+r:e+t);a.push({key:"C",data:l}),t=l[4],r=l[5];break;case"Q":a.push({key:"Q",data:[...s]}),t=s[2],r=s[3];break;case"q":var c=s.map((e,n)=>n%2?e+r:e+t);a.push({key:"Q",data:c}),t=c[2],r=c[3];break;case"A":a.push({key:"A",data:[...s]}),t=s[5],r=s[6];break;case"a":t+=s[5],r+=s[6],a.push({key:"A",data:[s[0],s[1],s[2],s[3],s[4],t,r]});break;case"H":a.push({key:"H",data:[...s]}),t=s[0];break;case"h":t+=s[0],a.push({key:"H",data:[t]});break;case"V":a.push({key:"V",data:[...s]}),r=s[0];break;case"v":r+=s[0],a.push({key:"V",data:[r]});break;case"S":a.push({key:"S",data:[...s]}),t=s[2],r=s[3];break;case"s":var h=s.map((e,n)=>n%2?e+r:e+t);a.push({key:"S",data:h}),t=h[2],r=h[3];break;case"T":a.push({key:"T",data:[...s]}),t=s[0],r=s[1];break;case"t":t+=s[0],r+=s[1],a.push({key:"T",data:[t,r]});break;case"Z":case"z":a.push({key:"Z",data:[]}),t=n,r=i}return a}function kr(e){var t=[],r="",n=0,i=0,a=0,o=0,s=0,l=0;for(var{key:c,data:h}of e){switch(c){case"M":t.push({key:"M",data:[...h]}),[n,i]=h,[a,o]=h;break;case"C":t.push({key:"C",data:[...h]}),n=h[4],i=h[5],s=h[2],l=h[3];break;case"L":t.push({key:"L",data:[...h]}),[n,i]=h;break;case"H":n=h[0],t.push({key:"L",data:[n,i]});break;case"V":i=h[0],t.push({key:"L",data:[n,i]});break;case"S":var d=0,u=0;"C"===r||"S"===r?(d=n+(n-s),u=i+(i-l)):(d=n,u=i),t.push({key:"C",data:[d,u,...h]}),s=h[0],l=h[1],n=h[2],i=h[3];break;case"T":var[f,p]=h,g=0,v=0;"Q"===r||"T"===r?(g=n+(n-s),v=i+(i-l)):(g=n,v=i);var m=n+2*(g-n)/3,y=i+2*(v-i)/3,b=f+2*(g-f)/3,w=p+2*(v-p)/3;t.push({key:"C",data:[m,y,b,w,f,p]}),s=g,l=v,n=f,i=p;break;case"Q":var[x,_,k,O]=h,S=n+2*(x-n)/3,M=i+2*(_-i)/3,C=k+2*(x-k)/3,E=O+2*(_-O)/3;t.push({key:"C",data:[S,M,C,E,k,O]}),s=x,l=_,n=k,i=O;break;case"A":var A=Math.abs(h[0]),T=Math.abs(h[1]),L=h[2],P=h[3],q=h[4],R=h[5],I=h[6];0===A||0===T?(t.push({key:"C",data:[n,i,R,I,R,I]}),n=R,i=I):n===R&&i===I||(Sr(n,i,R,I,A,T,L,P,q).forEach((function(e){t.push({key:"C",data:e})})),n=R,i=I);break;case"Z":t.push({key:"Z",data:[]}),n=a,i=o}r=c}return t}function Or(e,t,r){return[e*Math.cos(r)-t*Math.sin(r),e*Math.sin(r)+t*Math.cos(r)]}function Sr(e,t,r,n,i,a,o,s,l,c){var h,d=(h=o,Math.PI*h/180),u=[],f=0,p=0,g=0,v=0;if(c)[f,p,g,v]=c;else{[e,t]=Or(e,t,-d),[r,n]=Or(r,n,-d);var m=(e-r)/2,y=(t-n)/2,b=m*m/(i*i)+y*y/(a*a);b>1&&(i*=b=Math.sqrt(b),a*=b);var w=i*i,x=a*a,_=w*x-w*y*y-x*m*m,k=w*y*y+x*m*m,O=(s===l?-1:1)*Math.sqrt(Math.abs(_/k));g=O*i*y/a+(e+r)/2,v=O*-a*m/i+(t+n)/2,f=Math.asin(parseFloat(((t-v)/a).toFixed(9))),p=Math.asin(parseFloat(((n-v)/a).toFixed(9))),e<g&&(f=Math.PI-f),r<g&&(p=Math.PI-p),f<0&&(f=2*Math.PI+f),p<0&&(p=2*Math.PI+p),l&&f>p&&(f-=2*Math.PI),!l&&p>f&&(p-=2*Math.PI)}var S=p-f;if(Math.abs(S)>120*Math.PI/180){var M=p,C=r,E=n;p=l&&p>f?f+120*Math.PI/180*1:f+120*Math.PI/180*-1,u=Sr(r=g+i*Math.cos(p),n=v+a*Math.sin(p),C,E,i,a,o,0,l,[p,M,g,v])}S=p-f;var A=Math.cos(f),T=Math.sin(f),L=Math.cos(p),P=Math.sin(p),q=Math.tan(S/4),R=4/3*i*q,I=4/3*a*q,N=[e,t],H=[e+R*T,t-I*A],F=[r+R*P,n-I*L],j=[r,n];if(H[0]=2*N[0]-H[0],H[1]=2*N[1]-H[1],c)return[H,F,j].concat(u);u=[H,F,j].concat(u);for(var D=[],B=0;B<u.length;B+=3){var z=Or(u[B][0],u[B][1],d),G=Or(u[B+1][0],u[B+1][1],d),W=Or(u[B+2][0],u[B+2][1],d);D.push([z[0],z[1],G[0],G[1],W[0],W[1]])}return D}var Mr={randOffset:function(e,t){return jr(e,t)},randOffsetWithRange:function(e,t,r){return Fr(e,t,r)},ellipse:function(e,t,r,n,i){return Lr(e,t,i,Tr(r,n,i)).opset},doubleLineOps:function(e,t,r,n,i){return Dr(e,t,r,n,i,!0)}};function Cr(e,t,r,n,i){return{type:"path",ops:Dr(e,t,r,n,i)}}function Er(e,t,r){var n=(e||[]).length;if(n>2){for(var i=[],a=0;a<n-1;a++)i.push(...Dr(e[a][0],e[a][1],e[a+1][0],e[a+1][1],r));return t&&i.push(...Dr(e[n-1][0],e[n-1][1],e[0][0],e[0][1],r)),{type:"path",ops:i}}return 2===n?Cr(e[0][0],e[0][1],e[1][0],e[1][1],r):{type:"path",ops:[]}}function Ar(e,t){if(e.length){for(var r="number"==typeof e[0][0]?[e]:e,n=zr(r[0],1*(1+.2*t.roughness),t),i=t.disableMultiStroke?[]:zr(r[0],1.5*(1+.22*t.roughness),Nr(t)),a=1;a<r.length;a++){var o=r[a];if(o.length){var s=zr(o,1*(1+.2*t.roughness),t),l=t.disableMultiStroke?[]:zr(o,1.5*(1+.22*t.roughness),Nr(t));for(var c of s)"move"!==c.op&&n.push(c);for(var h of l)"move"!==h.op&&i.push(h)}}return{type:"path",ops:n.concat(i)}}return{type:"path",ops:[]}}function Tr(e,t,r){var n=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(e/2,2)+Math.pow(t/2,2))/2)),i=Math.ceil(Math.max(r.curveStepCount,r.curveStepCount/Math.sqrt(200)*n)),a=2*Math.PI/i,o=Math.abs(e/2),s=Math.abs(t/2),l=1-r.curveFitting;return{increment:a,rx:o+=jr(o*l,r),ry:s+=jr(s*l,r)}}function Lr(e,t,r,n){var[i,a]=Wr(n.increment,e,t,n.rx,n.ry,1,n.increment*Fr(.1,Fr(.4,1,r),r),r),o=Gr(i,null,r);if(!r.disableMultiStroke&&0!==r.roughness){var[s]=Wr(n.increment,e,t,n.rx,n.ry,1.5,0,r),l=Gr(s,null,r);o=o.concat(l)}return{estimatedPoints:a,opset:{type:"path",ops:o}}}function Pr(e,t,r,n,i,a,o,s,l){var c=e,h=t,d=Math.abs(r/2),u=Math.abs(n/2);d+=jr(.01*d,l),u+=jr(.01*u,l);for(var f=i,p=a;f<0;)f+=2*Math.PI,p+=2*Math.PI;p-f>2*Math.PI&&(f=0,p=2*Math.PI);var g=2*Math.PI/l.curveStepCount,v=Math.min(g/2,(p-f)/2),m=Vr(v,c,h,d,u,f,p,1,l);if(!l.disableMultiStroke){var y=Vr(v,c,h,d,u,f,p,1.5,l);m.push(...y)}return o&&(s?m.push(...Dr(c,h,c+d*Math.cos(f),h+u*Math.sin(f),l),...Dr(c,h,c+d*Math.cos(p),h+u*Math.sin(p),l)):m.push({op:"lineTo",data:[c,h]},{op:"lineTo",data:[c+d*Math.cos(f),h+u*Math.sin(f)]})),{type:"path",ops:m}}function qr(e,t){var r=kr(_r(xr(e))),n=[],i=[0,0],a=[0,0];for(var{key:o,data:s}of r)switch(o){case"M":a=[s[0],s[1]],i=[s[0],s[1]];break;case"L":n.push(...Dr(a[0],a[1],s[0],s[1],t)),a=[s[0],s[1]];break;case"C":var[l,c,h,d,u,f]=s;n.push(...Ur(l,c,h,d,u,f,a,t)),a=[u,f];break;case"Z":n.push(...Dr(a[0],a[1],i[0],i[1],t)),a=[i[0],i[1]]}return{type:"path",ops:n}}function Rr(e,t){var r=[];for(var n of e)if(n.length){var i=t.maxRandomnessOffset||0,a=n.length;if(a>2){r.push({op:"move",data:[n[0][0]+jr(i,t),n[0][1]+jr(i,t)]});for(var o=1;o<a;o++)r.push({op:"lineTo",data:[n[o][0]+jr(i,t),n[o][1]+jr(i,t)]})}}return{type:"fillPath",ops:r}}function Ir(e,t){return function(e,t){var r=e.fillStyle||"hachure";if(!mr[r])switch(r){case"zigzag":mr[r]||(mr[r]=new ur(t));break;case"cross-hatch":mr[r]||(mr[r]=new fr(t));break;case"dots":mr[r]||(mr[r]=new pr(t));break;case"dashed":mr[r]||(mr[r]=new gr(t));break;case"zigzag-line":mr[r]||(mr[r]=new vr(t));break;default:mr[r="hachure"]||(mr[r]=new hr(t))}return mr[r]}(t,Mr).fillPolygons(e,t)}function Nr(e){var t=Object.assign({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}function Hr(e){return e.randomizer||(e.randomizer=new yr(e.seed||0)),e.randomizer.next()}function Fr(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return r.roughness*n*(Hr(r)*(t-e)+e)}function jr(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Fr(-e,e,t,r)}function Dr(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=a?i.disableMultiStrokeFill:i.disableMultiStroke,s=Br(e,t,r,n,i,!0,!1);if(o)return s;var l=Br(e,t,r,n,i,!0,!0);return s.concat(l)}function Br(e,t,r,n,i,a,o){var s,l=Math.pow(e-r,2)+Math.pow(t-n,2),c=Math.sqrt(l);s=c<200?1:c>500?.4:-.0016668*c+1.233334;var h=i.maxRandomnessOffset||0;h*h*100>l&&(h=c/10);var d=h/2,u=.2+.2*Hr(i),f=i.bowing*i.maxRandomnessOffset*(n-t)/200,p=i.bowing*i.maxRandomnessOffset*(e-r)/200;f=jr(f,i,s),p=jr(p,i,s);var g=[],v=()=>jr(d,i,s),m=()=>jr(h,i,s),y=i.preserveVertices;return a&&(o?g.push({op:"move",data:[e+(y?0:v()),t+(y?0:v())]}):g.push({op:"move",data:[e+(y?0:jr(h,i,s)),t+(y?0:jr(h,i,s))]})),o?g.push({op:"bcurveTo",data:[f+e+(r-e)*u+v(),p+t+(n-t)*u+v(),f+e+2*(r-e)*u+v(),p+t+2*(n-t)*u+v(),r+(y?0:v()),n+(y?0:v())]}):g.push({op:"bcurveTo",data:[f+e+(r-e)*u+m(),p+t+(n-t)*u+m(),f+e+2*(r-e)*u+m(),p+t+2*(n-t)*u+m(),r+(y?0:m()),n+(y?0:m())]}),g}function zr(e,t,r){if(!e.length)return[];var n=[];n.push([e[0][0]+jr(t,r),e[0][1]+jr(t,r)]),n.push([e[0][0]+jr(t,r),e[0][1]+jr(t,r)]);for(var i=1;i<e.length;i++)n.push([e[i][0]+jr(t,r),e[i][1]+jr(t,r)]),i===e.length-1&&n.push([e[i][0]+jr(t,r),e[i][1]+jr(t,r)]);return Gr(n,null,r)}function Gr(e,t,r){var n=e.length,i=[];if(n>3){var a=[],o=1-r.curveTightness;i.push({op:"move",data:[e[1][0],e[1][1]]});for(var s=1;s+2<n;s++){var l=e[s];a[0]=[l[0],l[1]],a[1]=[l[0]+(o*e[s+1][0]-o*e[s-1][0])/6,l[1]+(o*e[s+1][1]-o*e[s-1][1])/6],a[2]=[e[s+1][0]+(o*e[s][0]-o*e[s+2][0])/6,e[s+1][1]+(o*e[s][1]-o*e[s+2][1])/6],a[3]=[e[s+1][0],e[s+1][1]],i.push({op:"bcurveTo",data:[a[1][0],a[1][1],a[2][0],a[2][1],a[3][0],a[3][1]]})}if(t&&2===t.length){var c=r.maxRandomnessOffset;i.push({op:"lineTo",data:[t[0]+jr(c,r),t[1]+jr(c,r)]})}}else 3===n?(i.push({op:"move",data:[e[1][0],e[1][1]]}),i.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):2===n&&i.push(...Br(e[0][0],e[0][1],e[1][0],e[1][1],r,!0,!0));return i}function Wr(e,t,r,n,i,a,o,s){var l=[],c=[];if(0===s.roughness){e/=4,c.push([t+n*Math.cos(-e),r+i*Math.sin(-e)]);for(var h=0;h<=2*Math.PI;h+=e){var d=[t+n*Math.cos(h),r+i*Math.sin(h)];l.push(d),c.push(d)}c.push([t+n*Math.cos(0),r+i*Math.sin(0)]),c.push([t+n*Math.cos(e),r+i*Math.sin(e)])}else{var u=jr(.5,s)-Math.PI/2;c.push([jr(a,s)+t+.9*n*Math.cos(u-e),jr(a,s)+r+.9*i*Math.sin(u-e)]);for(var f=2*Math.PI+u-.01,p=u;p<f;p+=e){var g=[jr(a,s)+t+n*Math.cos(p),jr(a,s)+r+i*Math.sin(p)];l.push(g),c.push(g)}c.push([jr(a,s)+t+n*Math.cos(u+2*Math.PI+.5*o),jr(a,s)+r+i*Math.sin(u+2*Math.PI+.5*o)]),c.push([jr(a,s)+t+.98*n*Math.cos(u+o),jr(a,s)+r+.98*i*Math.sin(u+o)]),c.push([jr(a,s)+t+.9*n*Math.cos(u+.5*o),jr(a,s)+r+.9*i*Math.sin(u+.5*o)])}return[c,l]}function Vr(e,t,r,n,i,a,o,s,l){var c=a+jr(.1,l),h=[];h.push([jr(s,l)+t+.9*n*Math.cos(c-e),jr(s,l)+r+.9*i*Math.sin(c-e)]);for(var d=c;d<=o;d+=e)h.push([jr(s,l)+t+n*Math.cos(d),jr(s,l)+r+i*Math.sin(d)]);return h.push([t+n*Math.cos(o),r+i*Math.sin(o)]),h.push([t+n*Math.cos(o),r+i*Math.sin(o)]),Gr(h,null,l)}function Ur(e,t,r,n,i,a,o,s){for(var l=[],c=[s.maxRandomnessOffset||1,(s.maxRandomnessOffset||1)+.3],h=[0,0],d=s.disableMultiStroke?1:2,u=s.preserveVertices,f=0;f<d;f++)0===f?l.push({op:"move",data:[o[0],o[1]]}):l.push({op:"move",data:[o[0]+(u?0:jr(c[0],s)),o[1]+(u?0:jr(c[0],s))]}),h=u?[i,a]:[i+jr(c[f],s),a+jr(c[f],s)],l.push({op:"bcurveTo",data:[e+jr(c[f],s),t+jr(c[f],s),r+jr(c[f],s),n+jr(c[f],s),h[0],h[1]]});return l}function Xr(e){return[...e]}function Yr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e.length;if(r<3)throw new Error("A curve must have at least three points.");var n=[];if(3===r)n.push(Xr(e[0]),Xr(e[1]),Xr(e[2]),Xr(e[2]));else{var i=[];i.push(e[0],e[0]);for(var a=1;a<e.length;a++)i.push(e[a]),a===e.length-1&&i.push(e[a]);var o=[],s=1-t;n.push(Xr(i[0]));for(var l=1;l+2<i.length;l++){var c=i[l];o[0]=[c[0],c[1]],o[1]=[c[0]+(s*i[l+1][0]-s*i[l-1][0])/6,c[1]+(s*i[l+1][1]-s*i[l-1][1])/6],o[2]=[i[l+1][0]+(s*i[l][0]-s*i[l+2][0])/6,i[l+1][1]+(s*i[l][1]-s*i[l+2][1])/6],o[3]=[i[l+1][0],i[l+1][1]],n.push(o[1],o[2],o[3])}}return n}function Zr(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function Kr(e,t,r){var n=Zr(t,r);if(0===n)return Zr(e,t);var i=((e[0]-t[0])*(r[0]-t[0])+(e[1]-t[1])*(r[1]-t[1]))/n;return Zr(e,$r(t,r,i=Math.max(0,Math.min(1,i))))}function $r(e,t,r){return[e[0]+(t[0]-e[0])*r,e[1]+(t[1]-e[1])*r]}function Qr(e,t,r,n){var i,a,o=n||[];if(function(e,t){var r=e[t+0],n=e[t+1],i=e[t+2],a=e[t+3],o=3*n[0]-2*r[0]-a[0];o*=o;var s=3*n[1]-2*r[1]-a[1];s*=s;var l=3*i[0]-2*a[0]-r[0];l*=l;var c=3*i[1]-2*a[1]-r[1];return o<l&&(o=l),s<(c*=c)&&(s=c),o+s}(e,t)<r){var s=e[t+0];o.length?(i=o[o.length-1],a=s,Math.sqrt(Zr(i,a))>1&&o.push(s)):o.push(s),o.push(e[t+3])}else{var l=e[t+0],c=e[t+1],h=e[t+2],d=e[t+3],u=$r(l,c,.5),f=$r(c,h,.5),p=$r(h,d,.5),g=$r(u,f,.5),v=$r(f,p,.5),m=$r(g,v,.5);Qr([l,u,g,m],0,r,o),Qr([m,v,p,d],0,r,o)}return o}function Jr(e,t){return en(e,0,e.length,t)}function en(e,t,r,n,i){for(var a=i||[],o=e[t],s=e[r-1],l=0,c=1,h=t+1;h<r-1;++h){var d=Kr(e[h],o,s);d>l&&(l=d,c=h)}return Math.sqrt(l)>n?(en(e,t,c+1,n,a),en(e,c,r,n,a)):(a.length||a.push(o),a.push(s)),a}function tn(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.15,r=arguments.length>2?arguments[2]:void 0,n=[],i=(e.length-1)/3,a=0;a<i;a++)Qr(e,3*a,t,n);return r&&r>0?en(n,0,n.length,r):n}var rn="none";class nn{constructor(e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=e||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions}_d(e,t,r){return{shape:e,sets:t||[],options:r||this.defaultOptions}}line(e,t,r,n,i){var a=this._o(i);return this._d("line",[Cr(e,t,r,n,a)],a)}rectangle(e,t,r,n,i){var a=this._o(i),o=[],s=function(e,t,r,n,i){return function(e,t){return Er(e,!0,t)}([[e,t],[e+r,t],[e+r,t+n],[e,t+n]],i)}(e,t,r,n,a);if(a.fill){var l=[[e,t],[e+r,t],[e+r,t+n],[e,t+n]];"solid"===a.fillStyle?o.push(Rr([l],a)):o.push(Ir([l],a))}return a.stroke!==rn&&o.push(s),this._d("rectangle",o,a)}ellipse(e,t,r,n,i){var a=this._o(i),o=[],s=Tr(r,n,a),l=Lr(e,t,a,s);if(a.fill)if("solid"===a.fillStyle){var c=Lr(e,t,a,s).opset;c.type="fillPath",o.push(c)}else o.push(Ir([l.estimatedPoints],a));return a.stroke!==rn&&o.push(l.opset),this._d("ellipse",o,a)}circle(e,t,r,n){var i=this.ellipse(e,t,r,r,n);return i.shape="circle",i}linearPath(e,t){var r=this._o(t);return this._d("linearPath",[Er(e,!1,r)],r)}arc(e,t,r,n,i,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7?arguments[7]:void 0,l=this._o(s),c=[],h=Pr(e,t,r,n,i,a,o,!0,l);if(o&&l.fill)if("solid"===l.fillStyle){var d=Object.assign({},l);d.disableMultiStroke=!0;var u=Pr(e,t,r,n,i,a,!0,!1,d);u.type="fillPath",c.push(u)}else c.push(function(e,t,r,n,i,a,o){var s=e,l=t,c=Math.abs(r/2),h=Math.abs(n/2);c+=jr(.01*c,o),h+=jr(.01*h,o);for(var d=i,u=a;d<0;)d+=2*Math.PI,u+=2*Math.PI;u-d>2*Math.PI&&(d=0,u=2*Math.PI);for(var f=(u-d)/o.curveStepCount,p=[],g=d;g<=u;g+=f)p.push([s+c*Math.cos(g),l+h*Math.sin(g)]);return p.push([s+c*Math.cos(u),l+h*Math.sin(u)]),p.push([s,l]),Ir([p],o)}(e,t,r,n,i,a,l));return l.stroke!==rn&&c.push(h),this._d("arc",c,l)}curve(e,t){var r=this._o(t),n=[],i=Ar(e,r);if(r.fill&&r.fill!==rn)if("solid"===r.fillStyle){var a=Ar(e,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));n.push({type:"fillPath",ops:this._mergedShape(a.ops)})}else{var o=[],s=e;if(s.length){var l="number"==typeof s[0][0]?[s]:s;for(var c of l)c.length<3?o.push(...c):3===c.length?o.push(...tn(Yr([c[0],c[0],c[1],c[2]]),10,(1+r.roughness)/2)):o.push(...tn(Yr(c),10,(1+r.roughness)/2))}o.length&&n.push(Ir([o],r))}return r.stroke!==rn&&n.push(i),this._d("curve",n,r)}polygon(e,t){var r=this._o(t),n=[],i=Er(e,!0,r);return r.fill&&("solid"===r.fillStyle?n.push(Rr([e],r)):n.push(Ir([e],r))),r.stroke!==rn&&n.push(i),this._d("polygon",n,r)}path(e,t){var r=this._o(t),n=[];if(!e)return this._d("path",n,r);e=(e||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");var i=r.fill&&"transparent"!==r.fill&&r.fill!==rn,a=r.stroke!==rn,o=!!(r.simplification&&r.simplification<1),s=function(e,t,r){var n=kr(_r(xr(e))),i=[],a=[],o=[0,0],s=[],l=()=>{s.length>=4&&a.push(...tn(s,1)),s=[]},c=()=>{l(),a.length&&(i.push(a),a=[])};for(var{key:h,data:d}of n)switch(h){case"M":c(),o=[d[0],d[1]],a.push(o);break;case"L":l(),a.push([d[0],d[1]]);break;case"C":if(!s.length){var u=a.length?a[a.length-1]:o;s.push([u[0],u[1]])}s.push([d[0],d[1]]),s.push([d[2],d[3]]),s.push([d[4],d[5]]);break;case"Z":l(),a.push([o[0],o[1]])}if(c(),!r)return i;var f=[];for(var p of i){var g=Jr(p,r);g.length&&f.push(g)}return f}(e,0,o?4-4*(r.simplification||1):(1+r.roughness)/2),l=qr(e,r);if(i)if("solid"===r.fillStyle)if(1===s.length){var c=qr(e,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));n.push({type:"fillPath",ops:this._mergedShape(c.ops)})}else n.push(Rr(s,r));else n.push(Ir(s,r));return a&&(o?s.forEach(e=>{n.push(Er(e,!1,r))}):n.push(l)),this._d("path",n,r)}opsToPath(e,t){var r="";for(var n of e.ops){var i="number"==typeof t&&t>=0?n.data.map(e=>+e.toFixed(t)):n.data;switch(n.op){case"move":r+="M".concat(i[0]," ").concat(i[1]," ");break;case"bcurveTo":r+="C".concat(i[0]," ").concat(i[1],", ").concat(i[2]," ").concat(i[3],", ").concat(i[4]," ").concat(i[5]," ");break;case"lineTo":r+="L".concat(i[0]," ").concat(i[1]," ")}}return r.trim()}toPaths(e){var t=e.sets||[],r=e.options||this.defaultOptions,n=[];for(var i of t){var a=null;switch(i.type){case"path":a={d:this.opsToPath(i),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:rn};break;case"fillPath":a={d:this.opsToPath(i),stroke:rn,strokeWidth:0,fill:r.fill||rn};break;case"fillSketch":a=this.fillSketch(i,r)}a&&n.push(a)}return n}fillSketch(e,t){var r=t.fillWeight;return r<0&&(r=t.strokeWidth/2),{d:this.opsToPath(e),stroke:t.fill||rn,strokeWidth:r,fill:rn}}_mergedShape(e){return e.filter((e,t)=>0===t||"move"!==e.op)}}class an{constructor(e,t){this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.gen=new nn(t)}draw(e){var t=e.sets||[],r=e.options||this.getDefaultOptions(),n=this.ctx,i=e.options.fixedDecimalPlaceDigits;for(var a of t)switch(a.type){case"path":n.save(),n.strokeStyle="none"===r.stroke?"transparent":r.stroke,n.lineWidth=r.strokeWidth,r.strokeLineDash&&n.setLineDash(r.strokeLineDash),r.strokeLineDashOffset&&(n.lineDashOffset=r.strokeLineDashOffset),this._drawToContext(n,a,i),n.restore();break;case"fillPath":n.save(),n.fillStyle=r.fill||"";var o="curve"===e.shape||"polygon"===e.shape||"path"===e.shape?"evenodd":"nonzero";this._drawToContext(n,a,i,o),n.restore();break;case"fillSketch":this.fillSketch(n,a,r)}}fillSketch(e,t,r){var n=r.fillWeight;n<0&&(n=r.strokeWidth/2),e.save(),r.fillLineDash&&e.setLineDash(r.fillLineDash),r.fillLineDashOffset&&(e.lineDashOffset=r.fillLineDashOffset),e.strokeStyle=r.fill||"",e.lineWidth=n,this._drawToContext(e,t,r.fixedDecimalPlaceDigits),e.restore()}_drawToContext(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"nonzero";for(var i of(e.beginPath(),t.ops)){var a="number"==typeof r&&r>=0?i.data.map(e=>+e.toFixed(r)):i.data;switch(i.op){case"move":e.moveTo(a[0],a[1]);break;case"bcurveTo":e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"lineTo":e.lineTo(a[0],a[1])}}"fillPath"===t.type?e.fill(n):e.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(e,t,r,n,i){var a=this.gen.line(e,t,r,n,i);return this.draw(a),a}rectangle(e,t,r,n,i){var a=this.gen.rectangle(e,t,r,n,i);return this.draw(a),a}ellipse(e,t,r,n,i){var a=this.gen.ellipse(e,t,r,n,i);return this.draw(a),a}circle(e,t,r,n){var i=this.gen.circle(e,t,r,n);return this.draw(i),i}linearPath(e,t){var r=this.gen.linearPath(e,t);return this.draw(r),r}polygon(e,t){var r=this.gen.polygon(e,t);return this.draw(r),r}arc(e,t,r,n,i,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7?arguments[7]:void 0,l=this.gen.arc(e,t,r,n,i,a,o,s);return this.draw(l),l}curve(e,t){var r=this.gen.curve(e,t);return this.draw(r),r}path(e,t){var r=this.gen.path(e,t);return this.draw(r),r}}var on=(e,t)=>new an(e,t),sn=new WeakMap,ln=wt.a.Canvas,cn=(e,t,r)=>{e.rotate&&(t.save(),t.translate(e.rotate.cx,e.rotate.cy),t.rotate(e.rotate.angle),t.translate(-1*e.rotate.cx,-1*e.rotate.cy)),e.d&&("none"!==e.fill?(r.path(e.d,{fill:"#fff",stroke:"#fff",roughness:0,fillStyle:"solid",strokeWidth:0}),r.path(e.d,{fill:e.fill||"#000",roughness:e.fill?2:.5,fillStyle:"hachure",fillWeight:1.5,stroke:"#111"})):r.path(e.d,{roughness:2})),e.cx&&(r.circle(e.cx,e.cy,2*e.r,{fill:"#fff",stroke:"#fff",roughness:0,fillStyle:"solid",strokeWidth:0}),r.circle(e.cx,e.cy,2*e.r,{fill:e.fill,roughness:2,fillWeight:1.5,fillStyle:"hachure",stroke:"#111"})),e.fontSize&&(t.font="".concat(e.fontSize,"px sans-serif"),t.textAlign="center",t.textBaseline="middle",t.fillStyle=e.fill,t.fillText(e.text,e.x,e.y)),e.rotate&&t.restore()},hn=function(e){var t=e.getContext("2d");if(this.paths&&this.paths.length>0){if(t.save(),t.translate(this.x,this.y),t.scale(this.width/100,this.height/100),!sn.has(this)){var r=e.ownerDocument.createElement("canvas");r.width=100,r.height=100;var n=r.getContext("2d"),i=on(r);for(var a of this.paths.filter(e=>!e.text))cn(a,n,i);sn.set(this,r)}for(var o of(t.save(),t.translate(50,50),t.rotate(Math.PI/180*this.rotate),t.drawImage(sn.get(this),-50,-50),t.restore(),this.paths.filter(e=>e.text)))cn(o,t,e);t.restore()}},dn=function(e){on(e).line(this.x,this.y,this.x2,this.y2,{roughness:3})};class un extends ln{use(e,t,r,n,i){var a={icon:e,x:t,y:r,width:n,height:i,render:hn};return this.appendChild(a),a}line(e,t,r,n){var i={x:e,y:t,x2:r,y2:n,options:arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},render:dn};return this.appendChild(i),i}group(e){return e||(e=new un,this.appendChild(e)),e}}var fn=un;class pn extends wt.a{constructor(e,t){super(e,t),this.element=new fn(this.element.canvas)}}var gn=pn,vn=r(3),mn=function(e,t,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:90,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100,o=50,s=50,l=[],c=i-n,h=t/r*(Math.PI/2)*(c/90),d=0;d<=a;d++){var u=o+e*Math.cos(h*d/a),f=s+e*Math.sin(-1*h*d/a);l.push("".concat(u.toFixed(1),"% ").concat(f.toFixed(1),"%"))}return l},yn=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:90,a=50,o=50,s=i-n,l=t/r*(Math.PI/2)*(s/90),c=a+e*Math.cos(l),h=o+e*Math.sin(-1*l);return{x:c,y:h}},bn=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:90,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:10,s=50*e,l=50*t,{x:c,y:h}=yn(s,r,n,i,a);return"polygon(".concat((50+s).toFixed(1),"% 50%, ").concat((50+l).toFixed(1),"% 50%, ").concat(mn(l,r,n,i,a,o).join(","),", ").concat(c.toFixed(1),"% ").concat(h.toFixed(1),"%, ").concat(mn(s,r,n,i,a,o).reverse().join(","),")")},wn=vn("glycanjs:piemenu"),xn=document.createElement("template");xn.innerHTML='\n  <style>\n    :host {\n      padding: 0;\n      display: block;\n      position: relative;\n      filter: drop-shadow(0px 5px 5px rgba(0,0,0,0.5));\n      transform: scale(0.99);\n      --start-angle: -60;\n      --end-angle: 60;\n      --notch-ratio: 0.075;\n      --icon-position-ratio: 0.2;\n      --icon-size: 10px;\n      --sectorid: url(#sectorWeight1);\n    }\n    :host([active]) {\n      transform: scale(1);\n    }\n\n    :host ::slotted(*) {\n      background: #eee;\n      border: 0;\n      color: black;\n      position: absolute;\n      top: 0;\n      left: 0;\n      transform: scale(0.001);\n      width: 100%;\n      height: 100%;\n      -webkit-clip-path: var(--sectorid);\n      clip-path: var(--sectorid);\n    }\n\n    :host ::slotted(*[data-disabled]) {\n      display: none;\n    }\n\n  </style>\n  <style id="angles">\n  </style>\n  <slot id="items"></slot>\n';var _n=e=>e.toFixed(1),kn=(e,t)=>{kn.timeouts=new WeakMap,new MutationObserver((function(r){for(var n of r){if(n.target===e)return;if("attributes"==n.type){clearTimeout(kn.timeouts.get(e.parentNode)),e.querySelector("input[disabled]")?e.setAttribute("data-disabled",""):e.removeAttribute("data-disabled"),e.querySelector("input[data-weight]")?(e.setAttribute("data-weight",e.querySelector("input[data-weight]").getAttribute("data-weight")),e.style.setProperty("--weight",e.querySelector("input[data-weight]").getAttribute("data-weight"))):(e.removeAttribute("data-weight"),e.style.setProperty("--weight",null));var i=setTimeout(t,0);kn.timeouts.set(e.parentNode,i)}}})).observe(e,{attributes:!0,subtree:!0,attributeFilter:["disabled","data-weight"]})},On=function(e){var t,r,n=0,i=.3,a=0,o=[],s=e.assignedNodes().filter(e=>e instanceof HTMLElement).filter(e=>e.querySelector("input:not([disabled])")),l=window.getComputedStyle(this);t=parseInt(l.getPropertyValue("--start-angle")),r=parseInt(l.getPropertyValue("--end-angle"));var c=s.map(e=>Math.abs(parseInt(e.getAttribute("data-weight")||"1"))).reduce((e,t)=>e+t,0),h=(r-t)/c;a=t;var d=h,u=parseFloat(l.getPropertyValue("--notch-ratio")||"0"),f=parseFloat(l.getPropertyValue("--icon-position-ratio")),p=()=>{On.bind(this)(e)};for(var g of s.reverse()){var v=Math.abs(parseInt(g.getAttribute("data-weight")||"1"));d=h*v;var m=f,y=_n(50+100*Math.cos(Math.PI/180*d*.5)*(.5-m)),b=_n(50+100*Math.sin(Math.PI/180*d*.5)*(.5-m)),w=parseInt(l.getPropertyValue("--icon-size").replace("px",""));if(g.firstChild&&g.firstChild.setAttribute&&(g.firstChild.style.bottom="calc(".concat(b,"% - ").concat(w/2,"px)"),g.firstChild.style.left="calc(".concat(y,"% - ").concat(w/2,"px)"),g.firstChild.style.position="absolute",g.firstChild.style.transform="rotate(".concat(_n(a),"deg)"),g.firstChild.style.pointerEvents="none",g.firstChild.style.display="table-cell",g.firstChild.style.verticalAlign="middle",g.firstChild.style.textAlign="center",g.firstChild.style.width="".concat(w,"px"),g.firstChild.style.height="".concat(w,"px")),g.style){g.style.transitionDelay="".concat(_n(n),"s"),g.style.transition="transform ".concat(_n(i),"s"),g.style.transform="scale(0.001)",g.hasAttribute("data-weight"),g.style.setProperty("--sectorid",bn(u,1,v,c,t,r)),g.style.setProperty("--slice-background-rotate-angle","".concat(_n(90-Math.abs(a)),"deg")),n+=.1,i-=.1;var x="rot".concat(_n(a));x=x.replace(/[-\.]/g,"x"),g.setAttribute("class",x);var _=window.ShadyCSS?"".concat("ccg-piemenu","[active] .").concat(x," { transform: rotate(").concat(_n(-1*a),"deg) !important; }"):":host([active]) ::slotted(.".concat(x,") { transform: rotate(").concat(_n(-1*a),"deg) !important; }");o.push(_),a+=d,g.wired||kn(g,p),g.wired=!0}}this.hoverstyles.innerHTML=o.join("\n")};function Sn(){return Reflect.construct(HTMLElement,[],Object.getPrototypeOf(this).constructor)}Object.setPrototypeOf(Sn.prototype,HTMLElement.prototype),Object.setPrototypeOf(Sn,HTMLElement),window.ShadyCSS&&ShadyCSS.prepareTemplate(xn,"ccg-piemenu");class Mn extends Sn{constructor(){super(),wn("Initiating custom PieMenu element"),window.ShadyCSS&&ShadyCSS.styleElement(this)}connectedCallback(){this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(xn.content.cloneNode(!0)),this.hoverstyles=this.shadowRoot.getElementById("angles"),this.hoverstyles||(this.hoverstyles=document.createElement("style"),this.shadowRoot.appendChild(this.hoverstyles),this.hoverstyles.setAttribute("type","text/css"));var e=this.shadowRoot.getElementById("items");On.bind(this)(e),this.style.setProperty("--sectorid",bn(0,1,1,1,0,90)),e.addEventListener("slotchange",On.bind(this,e)),e.addEventListener("slotchange",()=>{this.style.setProperty("--sectorid",bn(0,1,1,1,0,90))})}clear(){for(var e of this.children)e.classList.remove("hover");Array.from(this.querySelectorAll("input:checked"),e=>e.checked=!1)}}Mn.ChainForm=function(e){Object.getOwnPropertyNames(e.elements).filter(e=>!e.match(/[0-9]+/))},customElements.define("ccg-piemenu",Mn);var Cn=Symbol("menu_timeout"),En=Symbol("last_selected"),An=e=>{e[En]=null,e[Cn]&&clearTimeout(e[Cn]);var t=e.querySelectorAll("ccg-piemenu");for(var r of t)r.removeAttribute("active")},Tn=e=>{e.form[En]=null,e.addEventListener("dragenter",t=>{var r=t.target;if(r instanceof HTMLLabelElement&&r!==e.form[En]){e.form[En]=r;var n=e.getRootNode().getElementById(e.getAttribute("data-next"));for(var i of r.parentNode.children)i!==r?(i.classList.remove("dragover"),i.classList.remove("hover")):(i.classList.add("hover"),n&&i.classList.add("dragover"));e.form[Cn]&&clearTimeout(e.form[Cn]),n&&(e.form[Cn]=setTimeout(()=>{if(e.form[En]){var r=new MouseEvent("click",{bubbles:!0,clientX:t.clientX,clientY:t.clientY-window.scrollY,screenX:t.screenX,screenY:t.screenY});e.form[En].control.dispatchEvent(r),e.form[En]=null}},700))}}),e.addEventListener("click",t=>{var r=t.target;if(r instanceof HTMLInputElement){r.checked=!0,t.isTrusted||t.preventDefault(),clearTimeout(e.form[Cn]),setTimeout(()=>{e.removeAttribute("active")},100);var n=e.getRootNode().getElementById(e.getAttribute("data-next"));if(n)n.style.transform=e.style.transform,e.form[Cn]=setTimeout(()=>{n.setAttribute("active",null)},100),n.clear();else{var i=new Event("finished",{bubbles:!0});e.form.dispatchEvent(i)}}},{capture:!1}),e.addEventListener("drop",t=>{if(t.target instanceof HTMLLabelElement){var r=new MouseEvent("click",{bubbles:!0,clientX:t.clientX,clientY:t.clientY,screenX:t.screenX,screenY:t.screenY});e.form[En].control.dispatchEvent(r)}}),e.addEventListener("dragover",e=>{e.preventDefault();var t=e.target;if(t instanceof HTMLLabelElement)for(var r of t.parentNode.children)r!==t?r.classList.remove("hover"):r.classList.add("hover")}),e.addEventListener("dragleave",t=>{t.relatedTarget===e&&(e.form[En]=null,e.removeAttribute("active"),e.clear())})},Ln=e=>{(e=>{e.addEventListener("dragstart",e=>{e.__target?e.__target.click():e.target.click(),e.stopPropagation()},{capture:!1}),e.addEventListener("drag",e=>{e.__target?e.__target.click():e.target.click()})})(e),(e=>{e.addEventListener("dragend",()=>{e.reset()})})(e),(e=>{e.addEventListener("finished",e=>(e.preventDefault(),!1)),e.addEventListener("reset",()=>{An(e)})})(e)};var Pn,qn=class{constructor(e){Ln(e),(e=>{var t=e.querySelectorAll("ccg-piemenu");for(var r of t)r.form=e,Tn(r)})(e),e.clear=()=>{An(e)},Object.defineProperty(e,"active_center",{get:()=>{var t=e.querySelector("ccg-piemenu[active]");if(t){var r=t.getBoundingClientRect();return{left:r.left+.5*r.width,top:r.top+.5*r.height,r:.5*r.width}}}})}};!function(e){var t=function(){function e(){this._dropEffect="move",this._effectAllowed="all",this._data={}}return Object.defineProperty(e.prototype,"dropEffect",{get:function(){return this._dropEffect},set:function(e){this._dropEffect=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectAllowed",{get:function(){return this._effectAllowed},set:function(e){this._effectAllowed=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"types",{get:function(){return Object.keys(this._data)},enumerable:!0,configurable:!0}),e.prototype.clearData=function(e){null!=e?delete this._data[e]:this._data=null},e.prototype.getData=function(e){return this._data[e]||""},e.prototype.setData=function(e,t){this._data[e]=t},e.prototype.setDragImage=function(e,t,n){var i=r._instance;i._imgCustom=e,i._imgOffset={x:t,y:n}},e}();e.DataTransfer=t;var r=function(){function e(){if(this._lastClick=0,e._instance)throw"DragDropTouch instance already created.";var t=!1;if(document.addEventListener("test",(function(){}),{get passive(){return t=!0,!0}}),"ontouchstart"in document){var r=document,n=this._touchstart.bind(this),i=this._touchmove.bind(this),a=this._touchend.bind(this),o=!!t&&{passive:!1,capture:!1};r.addEventListener("touchstart",n,o),r.addEventListener("touchmove",i,o),r.addEventListener("touchend",a),r.addEventListener("touchcancel",a)}}return e.getInstance=function(){return e._instance},e.prototype._touchstart=function(t){var r=this;if(this._shouldHandle(t)){if(Date.now()-this._lastClick<e._DBLCLICK&&this._dispatchEvent(t,"dblclick",t.target))return t.preventDefault(),void this._reset();this._reset();var n=this._closestDraggable(t.target);n&&(this._dispatchEvent(t,"mousemove",t.target)||this._dispatchEvent(t,"mousedown",t.target)||(this._dragSource=n,this._ptDown=this._getPoint(t),this._lastTouch=t,t.preventDefault(),setTimeout((function(){r._dragSource==n&&null==r._img&&r._dispatchEvent(t,"contextmenu",n)&&r._reset()}),e._CTXMENU),e._ISPRESSHOLDMODE&&(this._pressHoldInterval=setTimeout((function(){r._isDragEnabled=!0,r._touchmove(t)}),e._PRESSHOLDAWAIT))))}},e.prototype._touchmove=function(e){if(this._shouldCancelPressHoldMove(e))this._reset();else if(this._shouldHandleMove(e)||this._shouldHandlePressHoldMove(e)){var t=this._getTarget(e);if(this._dispatchEvent(e,"mousemove",t))return this._lastTouch=e,void e.preventDefault();this._dragSource&&!this._img&&this._shouldStartDragging(e)&&(this._dispatchEvent(e,"dragstart",this._dragSource),this._createImage(e),this._dispatchEvent(e,"dragenter",t)),this._img&&(this._lastTouch=e,e.preventDefault(),t!=this._lastTarget&&(this._dispatchEvent(this._lastTouch,"dragleave",this._lastTarget),this._dispatchEvent(e,"dragenter",t),this._lastTarget=t),this._moveImage(e),this._isDropZone=this._dispatchEvent(e,"dragover",t))}},e.prototype._touchend=function(e){if(this._shouldHandle(e)){if(this._dispatchEvent(this._lastTouch,"mouseup",e.target))return void e.preventDefault();this._img||(this._dragSource=null,this._dispatchEvent(this._lastTouch,"click",e.target),this._lastClick=Date.now()),this._destroyImage(),this._dragSource&&(e.type.indexOf("cancel")<0&&this._isDropZone&&this._dispatchEvent(this._lastTouch,"drop",this._lastTarget),this._dispatchEvent(this._lastTouch,"dragend",this._dragSource),this._reset())}},e.prototype._shouldHandle=function(e){return e&&!e.defaultPrevented&&e.touches&&e.touches.length<2},e.prototype._shouldHandleMove=function(t){return!e._ISPRESSHOLDMODE&&this._shouldHandle(t)},e.prototype._shouldHandlePressHoldMove=function(t){return e._ISPRESSHOLDMODE&&this._isDragEnabled&&t&&t.touches&&t.touches.length},e.prototype._shouldCancelPressHoldMove=function(t){return e._ISPRESSHOLDMODE&&!this._isDragEnabled&&this._getDelta(t)>e._PRESSHOLDMARGIN},e.prototype._shouldStartDragging=function(t){var r=this._getDelta(t);return r>e._THRESHOLD||e._ISPRESSHOLDMODE&&r>=e._PRESSHOLDTHRESHOLD},e.prototype._reset=function(){this._destroyImage(),this._dragSource=null,this._lastTouch=null,this._lastTarget=null,this._ptDown=null,this._isDragEnabled=!1,this._isDropZone=!1,this._dataTransfer=new t,clearInterval(this._pressHoldInterval)},e.prototype._getPoint=function(e,t){return e&&e.touches&&(e=e.touches[0]),{x:t?e.pageX:e.clientX,y:t?e.pageY:e.clientY}},e.prototype._getDelta=function(t){if(e._ISPRESSHOLDMODE&&!this._ptDown)return 0;var r=this._getPoint(t);return Math.abs(r.x-this._ptDown.x)+Math.abs(r.y-this._ptDown.y)},e.prototype._getTarget=function(e){for(var t=this._getPoint(e),r=document.elementFromPoint(t.x,t.y);r&&"none"==getComputedStyle(r).pointerEvents;)r=r.parentElement;return r},e.prototype._createImage=function(t){this._img&&this._destroyImage();var r=this._imgCustom||this._dragSource;if(this._img=r.cloneNode(!0),this._copyStyle(r,this._img),this._img.style.top=this._img.style.left="-9999px",!this._imgCustom){var n=r.getBoundingClientRect(),i=this._getPoint(t);this._imgOffset={x:i.x-n.left,y:i.y-n.top},this._img.style.opacity=e._OPACITY.toString()}this._moveImage(t),document.body.appendChild(this._img)},e.prototype._destroyImage=function(){this._img&&this._img.parentElement&&this._img.parentElement.removeChild(this._img),this._img=null,this._imgCustom=null},e.prototype._moveImage=function(e){var t=this;requestAnimationFrame((function(){if(t._img){var r=t._getPoint(e,!0),n=t._img.style;n.position="absolute",n.pointerEvents="none",n.zIndex="999999",n.left=Math.round(r.x-t._imgOffset.x)+"px",n.top=Math.round(r.y-t._imgOffset.y)+"px"}}))},e.prototype._copyProps=function(e,t,r){for(var n=0;n<r.length;n++){var i=r[n];e[i]=t[i]}},e.prototype._copyStyle=function(t,r){if(e._rmvAtts.forEach((function(e){r.removeAttribute(e)})),t instanceof HTMLCanvasElement){var n=t,i=r;i.width=n.width,i.height=n.height,i.getContext("2d").drawImage(n,0,0)}for(var a=getComputedStyle(t),o=0;o<a.length;o++){var s=a[o];s.indexOf("transition")<0&&(r.style[s]=a[s])}r.style.pointerEvents="none";for(o=0;o<t.children.length;o++)this._copyStyle(t.children[o],r.children[o])},e.prototype._dispatchEvent=function(t,r,n){if(t&&n){var i=document.createEvent("Event"),a=t.touches?t.touches[0]:t;return i.initEvent(r,!0,!0),i.button=0,i.which=i.buttons=1,this._copyProps(i,t,e._kbdProps),this._copyProps(i,a,e._ptProps),i.dataTransfer=this._dataTransfer,n.dispatchEvent(i),i.defaultPrevented}return!1},e.prototype._closestDraggable=function(e){for(;e;e=e.parentElement)if(e.hasAttribute("draggable")&&e.draggable)return e;return null},e}();r._instance=new r,r._THRESHOLD=5,r._OPACITY=.5,r._DBLCLICK=500,r._CTXMENU=900,r._ISPRESSHOLDMODE=!1,r._PRESSHOLDAWAIT=400,r._PRESSHOLDMARGIN=25,r._PRESSHOLDTHRESHOLD=0,r._rmvAtts="id,class,style,draggable".split(","),r._kbdProps="altKey,ctrlKey,metaKey,shiftKey".split(","),r._ptProps="pageX,pageY,clientX,clientY,screenX,screenY,offsetX,offsetY".split(","),e.DragDropTouch=r}(Pn||(Pn={}));Pn.DataTransfer;var Rn=Pn.DragDropTouch,In=Symbol("instance"),Nn=e=>e.parentNode&&(e.parentNode instanceof HTMLElement||e.parentNode instanceof ShadowRoot)?Nn(e.parentNode):e.host?Nn(e.host):e,Hn=function(e,t,r){var n=null;if(e&&r){"dragleave"==t&&(n=this._getTarget(e));var i=document.createEvent("Event"),a=e.touches?e.touches[0]:e;return i.initEvent(t,!0,!0),i.button=0,i.which=i.buttons=1,this._copyProps(i,e,Rn._kbdProps),this._copyProps(i,a,Rn._ptProps),"dragleave"===i.type&&(i.relatedTarget=n),i.dataTransfer=this._dataTransfer,r.dispatchEvent(i),i}return!1};class Fn extends Rn{constructor(e){var t=Rn._instance;if(delete Rn._instance,super(),Rn._instance=t,this._lastClick=0,e[In])throw"DragDropTouch instance already created.";e[In]=this;var r=!1;if(document.addEventListener("test",(function(){}),{get passive(){return r=!0,!0}}),"ontouchstart"in document){document;var n=this._touchstart.bind(this),i=this._touchmove.bind(this),a=this._touchend.bind(this),o=!!r&&{passive:!1,capture:!1};e.shadowRoot.addEventListener("touchstart",n,o),e.shadowRoot.addEventListener("touchmove",i,o),e.shadowRoot.addEventListener("touchend",a),e.shadowRoot.addEventListener("touchcancel",a),this.root=e}}_getTarget(e){for(var t=this._getPoint(e),r=this.root.shadowRoot.elementFromPoint(t.x,t.y);r&&"none"==getComputedStyle(r).pointerEvents;)r=r.parentElement;return r}_dispatchEvent(e,t,r){if(e&&r){var n=Hn.bind(this)(e,t,this.root);return n.shim=!0,r.dispatchEvent(n),n.defaultPrevented}return!1}_destroyImage(){this._img&&(this._img.parentNode?this._img.parentNode.removeChild(this._img):this.root.shadowRoot.removeChild(this._img)),super._destroyImage()}_createImage(e){super._createImage(e);var t=this.root.getBoundingClientRect(),r=Nn(this.root);if(this._imgOffset.x+=t.x+r.scrollLeft,this._imgOffset.y+=t.y+r.scrollTop,!this._imgCustom){var n=this._dragSource.parentNode.style.transform;this._img.style.transform=n.replace(/translate\([^)]*\)/,"")}this.root.shadowRoot.appendChild(this._img)}}var jn=new Map,Dn=function(e){if(e.isTrusted||e.shim){var t="drag/"+function(){var e,t,r="";for(e=0;e<32;e++)t=16*Math.random()|0,8!=e&&12!=e&&16!=e&&20!=e||(r+="-"),r+=(12==e?4:16==e?3&t|8:t).toString(16);return r}();try{e.dataTransfer.setData(t,"")}catch(r){console.log("Couldnt set drag id, using global drag id"),e.dataTransfer.setData("text",t),window.global_drag=t}e.dataTransfer.effectAllowed="copy",e.dataTransfer.dropEffect="copy";var r=e.target,n=new Event("dragstart",{bubbles:!0});n.dataTransfer={types:[t]},n.data={},this.drags.set(t,n.data),r.dispatchEvent(n),e.stopPropagation()}},Bn=function(e){var t=[...e.dataTransfer.types].filter(e=>e.match(/^drag\/\d+/))[0]||window.global_drag;e.data=this.drags.get(t)},zn=function(e){for(var t of(e.addEventListener("dragstart",Dn.bind(this),{capture:!0}),["dragenter","dragover","drop","dragleave"]))e.addEventListener(t,Bn.bind(this))};var Gn=class{get drags(){return jn}constructor(e){zn.call(this,e)}};function Wn(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}var Vn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image.png",r=new MouseEvent("click",{view:window,bubbles:!1,cancelable:!0}),n=document.createElement("a");document.body.appendChild(n),n.style="display: none",n.setAttribute("download",t),n.setAttribute("href",e),n.dispatchEvent(r)},Un=document.createElement("template");Un.innerHTML='<svg xmlns="http://www.w3.org/2000/svg"><rect  x="0" y="0" width="100" height="100" fill="#fff" opacity="0" /></svg>';var Xn=function(){var e,t=(e=function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"png",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image",i=yield Yn(e,t,r);Vn(i,"".concat(n,".").concat(r))},function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){Wn(a,n,i,o,s,"next",e)}function s(e){Wn(a,n,i,o,s,"throw",e)}o(void 0)}))});return function(e,r){return t.apply(this,arguments)}}(),Yn=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"png";if("png"===r&&t instanceof HTMLCanvasElement){var n=t.toDataURL("image/png").replace("image/png","image/octet-stream");return Promise.resolve(n)}var i=document.createElement("canvas");i.width=e.getBoundingClientRect().width,i.height=e.getBoundingClientRect().height;var a=i.getContext("2d"),o=t.cloneNode(!0);if(e.shadowRoot.getElementById("icons")){var s=e.shadowRoot.getElementById("icons").querySelector("defs");for(var l of(o.appendChild(s.cloneNode(!0)),[...o.querySelectorAll("defs > svg")]))l.parentNode.removeChild(l);for(var c of o.querySelectorAll("defs symbol"))c.insertBefore(Un.content.cloneNode(!0).firstChild.firstChild,c.firstChild)}for(var h of o.querySelectorAll("symbol *[stroke-width]"))h.getAttribute("fill");for(var d of o.querySelectorAll("use"))d.setAttribute("xlink:href",d.getAttribute("xlink:href").replace(/.*#/,"#"));var u=(new XMLSerializer).serializeToString(o);if("svg"===r)return u.match(/^<svg[^>]+xmlns="http\:\/\/www\.w3\.org\/2000\/svg"/)||(u=u.replace(/^<svg/,'<svg xmlns="http://www.w3.org/2000/svg"')),u.match(/^<svg[^>]+"http\:\/\/www\.w3\.org\/1999\/xlink"/)||(u=u.replace(/^<svg/,'<svg xmlns:xlink="http://www.w3.org/1999/xlink"')),u='<?xml version="1.0" standalone="no"?>\r\n'+u,Promise.resolve("data:image/svg+xml;charset=utf-8,"+encodeURIComponent(u));var f=new Image,p=new Blob([u],{type:"image/svg+xml;charset=utf-8"}),g=window.URL.createObjectURL(p);return new Promise(e=>{f.onload=function(){a.drawImage(f,0,0),window.URL.revokeObjectURL(g);var t=i.toDataURL("image/png").replace("image/png","image/octet-stream");e(t)},f.src=g})},Zn=Xn,Kn=r(5);function $n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Qn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$n(Object(r),!0).forEach((function(t){Jn(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Jn(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ei=document.createElement("template");function ti(e,t){var r=document.createElement("canvas");return r.width=e.width,r.height=e.height,r}ei.innerHTML='\n<canvas class="highlight_canvas">\n</canvas>\n';var ri=new WeakMap;function ni(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=this.canvas,n=r.getContext("2d"),i=Math.ceil(parseFloat((window.document.documentElement.clientWidth/window.innerWidth).toFixed(2))),a=Math.max(1,i);ri.get(this)&&(ri.get(this).stop(),ri.delete(this)),n.clearRect(0,0,r.width,r.height);var o=r.getBoundingClientRect();r.width=a*o.width,r.height=a*o.height,n.scale(a,a);var s=ti(r),l=s.getContext("2d"),c=this.viewer.renderer,{start:h,end:d}=this.states,u=new Kn.Tween(Qn({},h)).to(Qn({},d),this.duration);u.on("update",()=>{l.clearRect(0,0,r.width,r.height)});var f=function(){if(!p)return 1;var{x:t,y:r,width:n,height:a}=c.screenCoordinatesFromLayout(p);t-=o.left,r-=o.top,u.on("update",o=>{e.draw(o,{x:t,y:r,width:n,height:a,zoom:i},l)})};for(var p of t.map(e=>c.layoutFor(e)))f();Object(Kn.autoPlay)(!0),ri.set(this,u);var g=!1;u.on("complete",()=>{g=!0});var v=()=>{n.clearRect(0,0,r.width,r.height),n.drawImage(s,0,0),g||window.requestAnimationFrame(v)};window.requestAnimationFrame(v),u.start()}var ii=Symbol("canvas"),ai=Symbol("state_end"),oi=Symbol("state_start"),si=Symbol("viewer");var li=class{constructor(e,t){this[si]=e,this[ii]=function(e,t){var r=ei.content.cloneNode(!0);r.querySelector("canvas").setAttribute("id",t);var n=e.shadowRoot.querySelector("canvas.highlight_canvas"),i=r.firstElementChild;return n?n.insertAdjacentElement("afterend",i):e.shadowRoot.insertBefore(i,e.shadowRoot.firstElementChild),i}(e,t),this.duration=100,this.draw=()=>{}}get viewer(){return this[si]}get canvas(){return this[ii]}get identifier(){return this.canvas.getAttribute("id")}highlight(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return ni.call(this,e)}setStates(e,t){this[oi]=Object.freeze(e),this[ai]=Object.freeze(t)}get states(){return{start:this[oi],end:this[ai]}}},ci=(0,n.IO)(B),hi={TYPEI:"GlcNAc(b1-3)Gal(b1-3)*",TYPEII:"GlcNAc(b1-3)Gal(b1-4)*",HEPARAN:"GlcA(b1-4)GlcNAc(a1-4)*",CHONDROITIN:"GlcA(b1-3)GalNAc(b1-4)*",MATRIGLYCAN:"GlcA(b1-3)Xyl(a1-3)*",POLYSIA:"NeuAc(a2-8)*"};for(var di of Object.keys(hi)){var ui=hi[di];hi[di]=new ci,hi[di].sequence=ui,hi[di].title=di}var fi=Symbol("pattern"),pi=e=>{var t=Object.values(hi);for(var r of t)for(var n=e.match_sugar_pattern(r,xe.Comparator);n.length>0;){var i=n.shift(),a=i.root.children[0].original,o=i.leaves()[0].original;if(!(a instanceof h.a.Monosaccharide||o instanceof h.a.Monosaccharide))if(a.parent&&a.parent instanceof h.a.Monosaccharide&&0===r.sequence.indexOf(a.parent.repeat.template.sequence)){var s=a.parent.repeat;a.parent.removeChild(a.parent.linkageOf(a),a),s.max=parseInt(s.max)+1,s.identifier=""+s.max}else{var l=h.a.addToSugar(e,a,o,h.a.MODE_EXPAND,1,1);l[fi]=r,l.identifier=""+l.max,n=e.match_sugar_pattern(r,xe.Comparator)}}for(var c of e.repeats)if(!c[fi])for(var d of t)0===d.sequence.indexOf(c.template.sequence)&&(c[fi]=d)};class gi{constructor(e,t){this.repeat=e,this.viewer=t}set number(e){void 0===e&&(e=1),this.repeat.max=e,this.repeat.identifier=""+this.repeat.max,this.viewer.fullRefresh(),this.viewer.sequence=this.viewer.renderer.sugars[0].sequence}get number(){return this.repeat.max}get type(){return this.repeat[fi]?this.repeat[fi].title:"NA"}get expanded(){return this.repeat.mode===h.a.MODE_EXPAND}set expanded(e){e?this.expand():this.collapse()}get collapsed(){return!this.expanded}set collapsed(e){this.expanded=!e}toggleExpanded(){this.expanded=!this.expanded}expand(){this.repeat.mode!==h.a.MODE_EXPAND&&(this.repeat.mode=h.a.MODE_EXPAND,this.viewer.fullRefresh(),this.viewer.sequence=this.viewer.renderer.sugars[0].sequence)}collapse(){this.repeat.mode!==h.a.MODE_MINIMAL&&(this.repeat.mode=h.a.MODE_MINIMAL,this.viewer.fullRefresh(),this.viewer.sequence=this.viewer.renderer.sugars[0].sequence)}}function vi(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function mi(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}function yi(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function bi(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){yi(a,n,i,o,s,"next",e)}function s(e){yi(a,n,i,o,s,"throw",e)}o(void 0)}))}}var wi=vn("sviewer:sviewer"),xi=Vt((0,n.IO)(B)),_i=Symbol("sequence"),ki=Symbol("donors"),Oi=Symbol("repeats"),Si=Symbol("highlighter"),Mi=Symbol("scale_timeout"),Ci=document.createElement("template");Ci.innerHTML="\n<style>\n  :root {\n    --button-color: #000;\n    --drop-shadow-color: rgba(50, 50, 0, 0.5);\n    --drop-shadow-offset: 2px;\n    --drop-shadow-size: 1px;\n  }\n  :host {\n    display: block;\n    position: relative;\n    --palette-background-color: #eee;\n    --palette-icon-size: 32px;\n    --demoted-opacity: 0.5;\n    --sugars-url: inherit;\n  }\n\n  :host([resizeable]) {\n    resize: both;\n    overflow: auto;\n  }\n\n  :host([resizeable]) .widget_contents {\n    width: calc(100% - 5px);\n    height: calc(100% - 5px);\n  }\n\n  :host #output {\n    display: flex;\n    justify-content: center;\n  }\n\n  :host .widget_contents > div > svg {\n    width: 100%;\n    height: 100%;\n    pointer-events: auto;\n    font-family: Helvetica, sans-serif;\n  }\n\n  :host .widget_contents > div > canvas {\n    object-fit: contain;\n    width: 100%;\n    height: 100%;\n  }\n\n  :host .widget_contents > div > svg * {\n    -moz-transition: all 0.1s ease-in-out;\n    -o-transition: all 0.1s ease-in-out;\n    -webkit-transition: all 0.1s ease-in-out;\n    transition: all 0.1s ease-in-out;\n  }\n\n  :host .widget_contents > div > svg {\n    -moz-transition: all 0.5s ease-in-out;\n    -o-transition: all 0.5s ease-in-out;\n    -webkit-transition: all 0.5s ease-in-out;\n    transition: all 0.5s ease-in-out;\n  }\n\n  :host .widget_contents {\n    position: absolute;\n    left: 0px;\n    right: 0px;\n    top: 0px;\n    bottom: 0px;\n    width: 100%;\n    height: 100%;\n  }\n\n  :host .pie_parent {\n    position: fixed;\n    top: 0px;\n    left: 0px;\n    width: 100%;\n    height: 100%;\n    z-index: 1;\n    pointer-events: none;\n  }\n\n  :host .widget_contents > div {\n    position: absolute;\n    top: 0px;\n    left: 0px;\n    height: 100%;\n    width: 100%;\n  }\n\n  :host([editable]) .highlight_canvas {\n    position: absolute;\n    left: 0px;\n    width: 100%;\n    top: var(--palette-height);\n    height: calc( 100% - var(--palette-height));\n  }\n\n  :host([editable]) .widget_contents > div {\n    top: var(--palette-height);\n    height: calc( 100% - var(--palette-height));\n  }\n\n  :host .palette {\n    display: none;\n  }\n\n  :host([editable]) .widget_contents {\n    margin-top: var(--palette-height, 0px);\n    height: calc( 100% - var(--palette-height, 0px));\n  }\n\n  :host([editable]) .palette {\n    display: grid;\n    grid-gap: 5px;\n    grid-template-columns: repeat(auto-fill, calc( var(--palette-icon-size) + 10px ));\n    margin-top: calc(-1 *  var(--palette-height, 0px));\n  }\n\n  :host([editable]) .palette:after {\n    content: \"\";\n    flex: auto;\n  }\n\n\n  :host .palette {\n    position: absolute;\n    top: 0px;\n    left: 0px;\n    right: 0px;\n    background: var(--palette-background-color);\n    pointer-events: auto;\n    overflow: hidden;\n    width: var(--expandedwidth);\n    background: none;\n    height: auto;\n    min-height: calc(var(--palette-icon-size) + 5px);\n    padding-top: 5px;\n    padding-left: 5px;\n    padding-bottom: 5px;\n    padding-right: 2px;\n    border-bottom-right-radius: 5px;\n    border-bottom-left-radius: 5px;\n  }\n\n  :host #palette_closer_wrap {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    filter: drop-shadow(var(--drop-shadow-offset) var(--drop-shadow-offset) var(--drop-shadow-size) var(--drop-shadow-color));\n  }\n\n  :host #palette_closer:hover {\n    --button-default-background-color: var(--selection-color, #ff0000);\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1 1'%3E%3Cstyle%3E* %7B stroke-width: 0.05; stroke: rgba(0,0,0,1); fill: none;%7D line %7B stroke: rgba(255,255,255,1) %7D %3C/style%3E%3Ccircle cx='0.5' cy='0.5' r='0.4' /%3E%3Cline x1='0.5' y1='0.25' x2='0.5' y2='0.75' /%3E%3Cline y1='0.5' x1='0.25' y2='0.5' x2='0.75' /%3E%3C/svg%3E\");\n  }\n\n  :host #palette_closer {\n    background-color: var(--button-default-background-color,#555);\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1 1'%3E%3Cstyle%3E* %7B stroke-width: 0.05; stroke: rgba(0,0,0,1); fill: none;%7D line %7B stroke: rgba(255,255,255,1) %7D %3C/style%3E%3Ccircle cx='0.5' cy='0.5' r='0.4' /%3E %3C/svg%3E\");\n    -webkit-mask: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1 1'%3E%3Ccircle cx='0.5' cy='0.5' r='0.4' /%3E%3Cline x1='0.5' y1='0.25' x2='0.5' y2='0.75' /%3E%3Cline y1='0.5' x1='0.25' y2='0.5' x2='0.75' /%3E%3C/svg%3E\");\n    mask: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1 1'%3E%3Ccircle cx='0.5' cy='0.5' r='0.4' /%3E%3Cline x1='0.5' y1='0.25' x2='0.5' y2='0.75' /%3E%3Cline y1='0.5' x1='0.25' y2='0.5' x2='0.75' /%3E%3C/svg%3E\");\n\n    width: var(--palette-icon-size);\n    height: var(--palette-icon-size);\n    -moz-transition: all 0.5s ease-in-out;\n    -o-transition: all 0.5s ease-in-out;\n    -webkit-transition: all 0.5s ease-in-out;\n    transition: transform 0.5s ease-in-out;\n    background-repeat: no-repeat;\n    position: relative;\n    cursor: pointer;\n  }\n\n\n  :host #palette_closer:after {\n    content: '';\n    display: block;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n    background: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1 1'%3E %3Cline x1='0.5' y1='0.25' x2='0.5' y2='0.75' stroke-width='0.06' stroke='white' /%3E%3Cline stroke-width='0.06' stroke='white' y1='0.5' x1='0.25' y2='0.5' x2='0.75' /%3E%3C/svg%3E\");  \n  }\n\n  @supports (color: oklch(from red l c h)) {\n\n  :host #palette_closer:after {\n    --l-threshold: 0.7;\n    --l: clamp(0, (var(--l-threshold) / l - 1) * infinity, 1);\n    --button-foreground: oklch(from var(--button-default-background-color,#555) var(--l) 0 h);\n    background: var(--button-foreground,white);\n    mask: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1 1'%3E %3Cline x1='0.5' y1='0.25' x2='0.5' y2='0.75' stroke-width='0.06' stroke='black' /%3E%3Cline stroke-width='0.06' stroke='black' y1='0.5' x1='0.25' y2='0.5' x2='0.75' /%3E%3C/svg%3E\");\n  }\n\n  }\n\n  :host(:not(.dragging)) .palette.expanded #palette_closer {\n    transform: rotate(405deg);\n  }\n\n  :host(.dragging) .palette.expanded {\n    pointer-events: none;\n  }\n\n  :host .palette label {\n    transform: translate(calc(-1 * (var(--palette-item-count) + 1) * (var(--palette-icon-size) + 12px) ),0px);\n    transition: transform 0.5s ease-in-out;\n  }\n\n  :host(:not(.dragging)) .palette.expanded label {\n    flex: 1;\n    transform: translate(0px,0px);\n    min-width: var(--palette-icon-size);\n    min-height: var(--palette-icon-size);\n    max-width: var(--palette-icon-size);\n    max-height: var(--palette-icon-size);\n  }\n\n  :host(:not(.dragging)) .palette.expanded {\n    width: var(--expandedwidth);\n    background: var(--palette-background-color);\n  }\n\n  :host #textbox {\n    top: auto;\n    bottom: 0px;\n    height: auto;\n    font-family: sans-serif;\n  }\n\n  :host #textbox {\n    display: none;\n  }\n\n\n  :host([showsequence]) #textbox {\n    display: block;\n  }\n\n  :host * {\n    -webkit-tap-highlight-color: rgba(0,0,0,0);\n  }\n\n  :host ccg-piemenu {\n    position: absolute;\n    top: 0px;\n    left: 0px;\n    pointer-events: none;\n    width: 150px;\n    height: 150px;\n    z-index: 2;\n    --end-angle: 60;\n    --start-angle: -60;\n    --icon-size: 10px;\n  }\n\n  :host ccg-piemenu[active] label {\n    pointer-events: all;\n  }\n\n  :host ccg-piemenu[active] label[data-weight^=\"-\"] {\n    opacity: calc( -1 * var(--weight) * var(--demoted-opacity) );\n  }\n\n  :host ccg-piemenu button, ccg-piemenu label {\n    font-family: sans-serif;\n    font-size: var(--icon-size);\n  }\n\n  @keyframes piemenuselection {\n    0% {\n      background-position: right top;\n      color: #000000;\n    }\n    100% {\n      background-position: left top;\n      color: #ffffff;\n    }\n  }\n\n\n  :host ccg-piemenu label.dragover {\n    background: linear-gradient(var(--slice-background-rotate-angle),var(--selection-color) 50%, var(--palette-background-color) 50%);\n    background-size: 375% 100%;\n    animation: piemenuselection 650ms;\n  }\n\n  :host ccg-piemenu button.hover, ccg-piemenu label.hover, ccg-piemenu button:hover, ccg-piemenu label:hover {\n    background: var(--selection-color);\n    color: #ffffff;\n  }\n\n  :host ccg-piemenu button[data-weight^=\"-\"].hover, ccg-piemenu label[data-weight^=\"-\"].hover, ccg-piemenu button[data-weight^=\"-\"]:hover, ccg-piemenu label[data-weight^=\"-\"]:hover {\n    background: #FFE2E2;\n    opacity: 1;\n    color: #000000;\n  }\n\n\n  :host #icons {\n    display: none;\n  }\n\n  @supports (pointer-events: bounding-box) {\n    :host {\n      --bounding-box-events: true;\n    }\n  }\n\n  @media only screen\n    and (min-device-width: 320px)\n    and (max-device-width: 480px)\n    and (-webkit-min-device-pixel-ratio: 2) {\n    :host {\n      --palette-icon-size: 32px;\n    }\n    :host ccg-piemenu {\n      --end-angle: 135;\n      --start-angle: 35;\n      --icon-position-ratio: 0.1;\n      --icon-size: 24px;\n      width: 200px;\n      height: 200px;\n    }\n\n    :host([editable]) .widget_contents {\n      margin-top: 0px;\n      height: 100%;\n      overflow: hidden;\n    }\n\n    :host([editable]) .palette {\n      margin-top: 0px;\n    }\n\n  }\n  :host .palette label svg {\n    pointer-events: none;\n  }\n  :host .palette label[data-disabled] {\n    opacity: 0.2;\n    pointer-events: none;\n  }\n\n  :host .palette label[data-weight^=\"-\"] {\n    opacity: var(--demoted-opacity);\n  }\n\n  :host #palette_delete {\n    padding: 2px;\n    padding-left: 8px;\n    border-radius: 5px;\n    height: var(--palette-icon-size);\n    cursor: pointer;\n  }\n\n  :host .palette label.checked {\n    background: #faa;\n  }\n\n  :host .palette label[draggable] {\n    display: block;\n\n    cursor: move; /* fallback if grab cursor is unsupported */\n    cursor: grab;\n    cursor: -moz-grab;\n    cursor: -webkit-grab;\n\n    background: rgba(255,255,255,0.8);\n    width: var(--palette-icon-size);\n    height: var(--palette-icon-size);\n\n    -webkit-user-drag: element;\n    border-radius: 5px;\n    box-shadow: 2px 2px 2px rgba(90,90,90,0.6);\n    padding: 0.5px;\n    border: solid rgba(90,90,90,0.5) 0.5px;\n    padding-left: 7px;\n  }\n\n  :host .palette label[draggable]:before {\n    position: absolute;\n    content: '';\n    height: 75%;\n    left: 2px;\n    top: calc(12.5% - 2px);\n    width: 2px;\n    background-image: linear-gradient(0deg, #999, #999 40%, transparent 40%, transparent 100%);\n    background-size: 1px 25%;\n    border: none;\n  }\n\n  :host .palette label[draggable].checked {\n    background: var(--selection-color);\n  }\n\n  :host .palette label input[value=\"delete\"] {\n    display: none;\n  }\n\n  :host .palette label[draggable] input {\n    display: none;\n  }\n\n</style>\n<div class=\"widget_contents\" >\n  <div id=\"icons\"></div>\n  <div id=\"output\"></div>\n  <form id=\"new_linkage\">\n    <div id=\"palette\" class=\"palette expanded\">\n    <div id=\"palette_closer_wrap\">\n    <div id=\"palette_closer\" onclick=\"this.parentNode.parentNode.classList.toggle('expanded')\"></div>\n    </div>\n    <label id=\"palette_delete\">\n    <svg viewBox=\"-100 -100 812 812\">\n      <g>\n      <path d=\"m510.81 85.933c-29.254-14.929-58.367-16.325-59.592-16.375-0.246-0.012-0.492-0.017-0.737-0.017h-46.303c3e-3 -0.139 0.022-0.273 0.022-0.415 0-26.812-12.761-48.09-35.931-59.913-16.138-8.234-31.876-9.122-33.618-9.194-0.244-0.013-0.49-0.019-0.736-0.019h-55.832c-0.246 0-0.492 6e-3 -0.737 0.017-1.741 0.074-17.48 0.96-33.616 9.194-23.172 11.824-35.932 33.102-35.932 59.913 0 0.142 0.017 0.276 0.022 0.415h-46.303c-0.246 0-0.492 6e-3 -0.737 0.017-1.226 0.051-30.337 1.446-59.593 16.375-28.241 14.41-61.905 44.075-61.905 103.55 0 9.581 7.767 17.35 17.35 17.35h15.245l67.087 390.76c1.43 8.328 8.65 14.416 17.099 14.416h299.87c8.449 0 15.67-6.088 17.099-14.416l67.087-390.76h15.245c9.581 0 17.35-7.768 17.35-17.35-1e-3 -59.473-33.666-89.138-61.907-103.55zm-435.41 86.197c4.22-24.493 17.846-42.891 40.665-54.828 21.272-11.123 43.329-12.888 45.936-13.063h288c2.585 0.172 24.08 1.906 45.034 12.6 23.361 11.922 37.29 30.475 41.562 55.29l-461.2 1e-3zm167.1-103c0-13.566 5.156-22.656 16.226-28.599 8.889-4.773 18.372-5.701 19.886-5.825h54.742c1.736 0.142 11.12 1.102 19.92 5.825 11.07 5.944 16.228 15.033 16.228 28.599 0 0.142 0.017 0.276 0.022 0.415h-127.04c2e-3 -0.139 0.02-0.275 0.02-0.415zm198.81 508.18h-270.62l-63.605-370.47h397.83l-63.605 370.47z\"/>\n      <path d=\"m306 519.57c9.581 0 17.35-7.768 17.35-17.35v-244.31c0-9.581-7.768-17.35-17.35-17.35-9.583 0-17.35 7.768-17.35 17.35v244.31c0 9.582 7.769 17.35 17.35 17.35z\"/>\n      <path d=\"m203.78 503.75c0.801 9.022 8.373 15.816 17.261 15.816 0.513 0 1.032-0.023 1.553-0.068 9.545-0.847 16.596-9.273 15.749-18.816l-21.687-244.31c-0.847-9.545-9.265-16.609-18.817-15.749-9.545 0.847-16.595 9.27-15.748 18.816l21.689 244.31z\"/>\n      <path d=\"m389.4 519.5c0.52 0.045 1.04 0.068 1.553 0.068 8.889 0 16.462-6.794 17.263-15.816l21.687-244.31c0.847-9.545-6.202-17.968-15.748-18.816-9.544-0.856-17.968 6.204-18.817 15.749l-21.687 244.31c-0.847 9.544 6.204 17.97 15.749 18.817z\"/>\n      </g>\n    </svg>\n    <input name=\"donor\" value=\"delete\" type=\"radio\"></label>\n    </div>\n    <div class=\"pie_parent\">\n      <ccg-piemenu name=\"anomer\" id=\"anomer_menu\" data-next=\"linkage_menu\">\n        <label><span>α</span><input name=\"anomer\" value=\"a\" type=\"radio\"></label>\n        <label><span>β</span><input name=\"anomer\" value=\"b\" type=\"radio\"></label>\n        <label><span>?</span><input name=\"anomer\" value=\"u\" type=\"radio\"></label>\n      </ccg-piemenu>\n      <ccg-piemenu name=\"linkage\" id=\"linkage_menu\">\n        <label><span>N</span><input name=\"linkage\" value=\"".concat(c.b.LINKAGES.N,'" type="radio"></label>\n        <label><span>O</span><input name="linkage" value="').concat(c.b.LINKAGES.O,'" type="radio"></label>\n        <label><span>?</span><input name="linkage" value="0" type="radio"></label>\n        <label><span>1</span><input name="linkage" value="1" type="radio"></label>\n        <label><span>2</span><input name="linkage" value="2" type="radio"></label>\n        <label><span>3</span><input name="linkage" value="3" type="radio"></label>\n        <label><span>4</span><input name="linkage" value="4" type="radio"></label>\n        <label><span>6</span><input name="linkage" value="6" type="radio"></label>\n        <label><span>8</span><input name="linkage" value="8" type="radio"></label>\n      </ccg-piemenu>\n    </div>\n  </form>\n  <div id="textbox">\n    <slot id="textcontent"> </slot>\n  </div>\n</div>\n');var Ei=document.createElement("template");function Ai(){return Reflect.construct(HTMLElement,[],Object.getPrototypeOf(this).constructor)}Ei.innerHTML='\n  <label draggable="true">\n  <svg width="100%" height="100%" viewBox="0 0 100 100">\n    <use x="0.0" y="0.0" width="100" height="100" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#neuac"></use>\n  </svg>\n  <input name="donor" value="NeuAc" type="radio">\n  </label>\n',Object.setPrototypeOf(Ai.prototype,HTMLElement.prototype),Object.setPrototypeOf(Ai,HTMLElement);var Ti=function(e){if(this.hasAttribute("editable")){var t=parseFloat((window.innerWidth/window.document.documentElement.clientWidth).toFixed(2)),r=window.scrollY,n=window.scrollX,i=this.shadowRoot.querySelector(".palette"),a=this.shadowRoot.querySelector(".pie_parent"),o=i.parentNode.parentNode.getBoundingClientRect();if(o.top<0||o.left<0){var s=o.left<0?-1*o.left:0,l=o.top<0?-1*o.top:0;i.style.position="absolute",i.style.transformOrigin="".concat(s,"px ").concat(l,"px"),i.classList.contains("expanded")&&i.style.setProperty("--expandedwidth",document.documentElement.clientWidth+"px"),i.style.transform="scale(".concat(t,") translate(").concat(s,"px,").concat(l,"px)")}else i.style.position="absolute",i.classList.contains("expanded")&&i.style.setProperty("--expandedwidth",(1/t*100).toFixed(2)+"%"),i.style.transformOrigin="".concat(0,"px ",0,"px"),i.style.transform="scale(".concat(t,") translate(",0,"px,0px)");for(var c=i,h=0;c.parentNode;)h+=c.offsetLeft,c=c.parentNode;n-=h/t,a.style.transformOrigin="".concat(window.scrollX,"px ").concat(r,"px"),a.style.transform="scale(".concat(t,") translate(").concat(n,"px,").concat(r,"px)"),e.ticking=!1}},Li=new Map,Pi=e=>{e.ticking||(window.requestAnimationFrame(Ti.bind(e.owner,e)),e.ticking=!0)},qi=function(){var e=(e=>()=>Pi(e))({ticking:!1,owner:this});window.removeEventListener("scroll",e),window.addEventListener("scroll",e)},Ri=function(e,t){if(this.hasAttribute("editable")){var r=this.shadowRoot.getElementById("anomer_menu"),n=this.form;n&&n.clear&&n.clear(),wi.info("Setting target to",e.identifier),delete n.active_residue,this.highlightResidues(),n.residue=e;var i=new Event("change",{bubbles:!0});n.dispatchEvent(i),r.removeAttribute("active");var a=parseFloat((window.innerWidth/window.document.documentElement.clientWidth).toFixed(2)),o=t.getBoundingClientRect(),s={top:o.top,left:o.left,width:o.width,height:o.height};s.width<5&&(s.width=100*s.width,s.height=100*s.height);var l=r.getBoundingClientRect(),c=r.parentNode.getBoundingClientRect().top/a,h=r.parentNode.getBoundingClientRect().left/a,d=((s.left+.5*s.width-.5*l.width)/a-h).toFixed(2),u=((s.top+.5*s.height-.5*l.height)/a-c).toFixed(2);d=((s.left+.5*s.width-.5*l.width)/a).toFixed(2),r.style.transformOrigin="".concat(d,"px ").concat(u,"px"),r.style.transform="scale(1) translate(".concat(d,"px,").concat(u,"px)"),setTimeout(()=>{1===[...r.querySelectorAll("label:not([data-disabled])")].length?r.querySelector("label:not([data-disabled])").click():setTimeout(()=>{r.setAttribute("active",null)},100)},0),r.clear()}},Ii=function(e,t){if(t.renderer=e,e.rendered.has(t)){var r=e.rendered.get(t).residue.element;if(r){var n="true"===window.getComputedStyle(r).getPropertyValue("--bounding-box-events");if(r.style.pointerEvents!==(n?"bounding-box":"all")){r.style.pointerEvents=n?"bounding-box":"all";var i=this.form;r.addEventListener("dragleave",()=>{delete i.active_residue,i.menu_timeout&&clearTimeout(i.menu_timeout),i.active_center||i.clear(),this.highlightResidues()}),r.addEventListener("click",e=>{if("delete"===i.querySelector('input[name="donor"]:checked').value){var r=t.parent;return r.removeChild(r.linkageOf(t),t),r.balance(),r.renderer.refresh(),this.sequence=this.renderer.sugars[0].sequence,void this.form.reset()}i.querySelector('input[name="donor"]:checked').value&&Ri.bind(this,t)(e.target)}),r.addEventListener("dragenter",e=>{if(this.hasAttribute("editable")&&(i.active_center||this.highlightResidues([t]),i.residue!==t&&i.active_residue!==t)){if(i.active_center){var r=i.active_center;if(r.r<75&&(r.r=75),Math.pow(e.clientX-r.left,2)+Math.pow(e.clientY-r.top,2)<Math.pow(1*r.r,2))return}i.clear(),i.active_residue=t,i.menu_timeout&&clearTimeout(i.menu_timeout),i.menu_timeout=setTimeout(Ri.bind(this,t,e.target),500)}})}}}},Ni=function(){!this.renderer||!this.renderer.sugars||this.renderer.sugars.length<1||this.renderer.sugars[0].sequence!==this.sequence&&(this.renderer.sugars[0].sequence=this.sequence)},Hi=function(){if(this.renderer&&this.renderer.sugars&&!(this.renderer.sugars.length<1))return this.renderer.refresh().then(()=>{if(this.hasAttribute("editable"))for(var e of this.renderer.sugars[0].composition())Ii.call(this,this.renderer,e);this.scaleToFit()})},Fi=function(){var e=this.renderer.element.canvas;this.addEventListener("drag",()=>{this.classList.add("dragging")});var t=this.shadowRoot.querySelector(".widget_contents");t.addEventListener("click",e=>{e.target===t&&this.form&&this.form.clear&&(this.form.reset(),this.form.clear())}),e.addEventListener("click",t=>{t.target===e&&this.form&&this.form.clear&&(this.form.reset(),this.form.clear())}),e.addEventListener("dragleave",t=>{if(t.relatedTarget===e){if(this.form.active_center){var r=this.form.active_center;if(r.r<75&&(r.r=75),Math.pow(t.clientX-r.left,2)+Math.pow(t.clientY-r.top,2)<Math.pow(1*r.r,2))return}return this.form.clear(),delete this.form.active_residue,delete this.form.residue,this.form.menu_timeout&&clearTimeout(this.form.menu_timeout),void this.highlightResidues()}}),this.addEventListener("dragend",()=>{this.classList.remove("dragging"),this.highlightResidues(),setTimeout(()=>{this.form.reset()},100)})},ji=function(e){var t,r=this.renderer.element.canvas,n=this.renderer;(r.addEventListener("dragover",()=>{this.classList.add("dragging")}),document.addEventListener("dragend",()=>{this.classList.remove("dragging")}),e)&&(r.addEventListener("dragover",e=>{if(!(this.shadowRoot.querySelectorAll("ccg-piemenu[active]").length>0)&&this.hasAttribute("editable")){this.LayoutEngine.focus=[e.sugarX,e.sugarY];var r=parseFloat((window.innerWidth/window.document.documentElement.clientWidth).toFixed(2)),i=parseFloat((r*r*3).toFixed(2));this.LayoutEngine.zoom=i<.1?.1:i,this.LayoutEngine.lock_residues=!0,t&&cancelAnimationFrame(t),t=requestAnimationFrame((function(){n.refresh()}))}}),document.addEventListener("dragend",()=>{this.LayoutEngine.focus=[-1e3,-1e3],t&&cancelAnimationFrame(t),t=requestAnimationFrame((function(){n.refresh()}))}))},Di=function(){var e=this.renderer.sugars[0].repeats;this[Oi].length=0,this[Oi].push(...e.map(e=>new gi(e,this)))},Bi=function(){var e=this.renderer.rotate;for(var t of this.shadowRoot.querySelectorAll("#icons symbol text"))e?t.setAttribute("transform","rotate(90,50,50)"):t.removeAttribute("transform")},zi=function(){this.form.addEventListener("change",(function(e){if(e.target&&e.target.parentNode instanceof HTMLLabelElement){var t=e.target;if("donor"!==t.name)return;for(var r of this.querySelectorAll('input[name="'.concat(t.name,'"]')))r===t?r.parentNode.classList.add("checked"):r.parentNode.classList.remove("checked")}})),this.form.addEventListener("reset",(function(){for(var e of(delete this.residue,this.querySelectorAll('input[name="donor"]')))e.parentNode.classList.remove("checked")}))},Gi=e=>{new MutationObserver((function(t){for(var r of t){if(r.target===e)return;if("attributes"==r.type){var n=new Set((e.getAttribute("part")||"").split(", "));n.has("donor-disabled")&&n.delete("donor-disabled"),e.querySelector("input[disabled]")?(e.setAttribute("data-disabled",""),n.add("donor-disabled")):e.removeAttribute("data-disabled"),e.setAttribute("part",[...n].join(", ")),e.querySelector("input[data-weight]")?e.setAttribute("data-weight",e.querySelector("input[data-weight]").getAttribute("data-weight")):e.removeAttribute("data-weight")}}})).observe(e,{attributes:!0,subtree:!0,attributeFilter:["disabled","data-weight"]})},Wi=Symbol("ACTIVE_POPULATION"),Vi=function(e,t){var r,n=t.toLowerCase().replace(/[()\[\]]/g,"_");try{r=e.querySelector("#".concat(n))}catch(e){return console.log(e),Promise.resolve()}if(r)return Promise.resolve();var i=class extends ar{};i.LINKS=!1;var a=new bt.a(e,i),o=new(0,this.SugarClass);return o.sequence=t,a.element.canvas.setAttribute("id",n),a.rotate=!0,a.addSugar(o),a.refresh().then(()=>{var t=document.createElementNS("http://www.w3.org/2000/svg","use");t.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+n),t.style.visibility="hidden",e.parentNode.parentNode.style.display="block",e.parentNode.appendChild(t),a.element.canvas.getBBox=()=>t.getBBox(),a.scaleToFit({side:.25,top:.5}),t.parentNode.removeChild(t),e.parentNode.parentNode.style.display="none",a.element.canvas.setAttribute("preserveAspectRatio","xMidYMid meet")})},Ui=function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["Gal","Glc","Man","GalNAc","GlcNAc","NeuAc","NeuGc","GlcA","IdoA","Xyl","Fuc"],n=e.shadowRoot.getElementById("icons");t.lastElementChild&&"palette_delete"!==t.lastElementChild.getAttribute("id");)t.removeChild(t.lastElementChild);var i=Symbol("ACTIVE");return e[Wi]=i,e[ki]=r,Promise.resolve(e.renderer.constructor.SYMBOLS).then(e=>n.innerHTML=e).then(bi((function*(){if(e[Wi]===i){delete e[Wi];for(var r of e.donors){var a=r.toLowerCase().replace(/[()\[\]]/g,"_");yield Vi.call(e,n.querySelector("defs"),r);var o=Ei.content.cloneNode(!0);o.querySelector("use").setAttribute("xlink:href","#".concat(a)),o.querySelector("input").setAttribute("value",r),o.querySelector("label").setAttribute("data-donor",r.toLowerCase()),o.querySelector("label").setAttribute("part","donor-button"),t.appendChild(o),Gi(t.lastElementChild)}e.setAttribute("exportparts","donor-button, donor-disabled"),t.style.setProperty("--palette-item-count",t.children.length)}})))},Xi=function(e,t,r,n){var i=new(0,this.SugarClass);i.sequence=t;var a=i.root;a.anomer=r,a.parent_linkage=t.match(/Neu(Gc|Ac)/)?2:1;var o="".concat(i.sequence,"(").concat(a.anomer).concat(a.parent_linkage,"-").concat(n,")"),s="".concat(e.identifier,'(u?-?)*+"{').concat(o,'@y2a}"'),l=new(xe.CopyIO(i));l.sequence=s;var c=e.renderer;return e instanceof h.a.Monosaccharide&&e.repeat.mode===h.a.MODE_MINIMAL?((!e.endsRepeat||e.repeat.root.identifier!==a.identifier)&&["Fuc","HSO3"].indexOf(a.identifier)>=0?e.original.addChild(parseInt(n),a):e.addChild(parseInt(n),a),[...i.composition()]):l.execute(c.sugars[0],e)},Yi=function(e,t){t.preventDefault(),t.stopPropagation();var r=(this.querySelector('input[name="donor"]:checked')||{}).value;if(r){var n=[...this.querySelectorAll('input[name="anomer"]:not([disabled])')];this.querySelector('input[name="anomer"]:checked')||1!==n.length||(n[0].checked=!0);var i=[...this.querySelectorAll('input[name="linkage"]:not([disabled])')];this.querySelector('input[name="linkage"]:checked')||1!==i.length||(i[0].checked=!0);var a=this.querySelector('input[name="anomer"]:checked').value,o=this.querySelector('input[name="linkage"]:checked').value,s=this.residue.renderer,l=s.sugars[0].location_for_monosaccharide(this.residue),c=e.extendSugar(this.residue,r,a,o);return this.residue=s.sugars[0].locate_monosaccharide(l),this.residue.balance(),pi(s.sugars[0]),s.refresh().then(()=>{for(var t of c)Ii.call(e,s,t);e.scaleToFit(),e.highlightResidues()}),"requestAnimationFrame"in window?requestAnimationFrame(()=>{e.sequence=s.sugars[0].sequence}):e.sequence=s.sugars[0].sequence,this.reset(),!1}},Zi=function(){this.form.addEventListener("finished",Yi.bind(this.form,this))},Ki=function(){this.hasAttribute("editable")&&(wi.info("Initialising global events"),qi.call(this),zi.call(this),Zi.call(this),"ResizeObserver"in window&&new ResizeObserver(()=>{var e=this.shadowRoot.getElementById("palette");this.style.setProperty("--palette-height",e.offsetHeight-32+"px")}).observe(this.shadowRoot.getElementById("palette")),this.hasAttribute("editable")&&this.shadowRoot.querySelector("#anomer_menu")&&this.shadowRoot.querySelector("#anomer_menu").addEventListener("click",()=>{setTimeout(()=>{var e=this.shadowRoot.querySelector("#linkage_menu");e&&1===[...e.querySelectorAll("label:not([data-disabled])")].length&&(this.form.clear(),e.querySelector("label:not([data-disabled])").click(),this.form.reset())},0)},{capture:!0}),wi.info("Initialised global events"))},$i=function(){if(this.shadowRoot){var e=this.hasAttribute("renderer")&&this.constructor.RegisteredRenderers.get(this.getAttribute("renderer"))||bt.a,t=()=>window.getComputedStyle(this).getPropertyValue("--sugars-url")||this.getAttribute("sugars");if(this.renderer){for(;this.shadowRoot.getElementById("output").firstChild;)this.shadowRoot.getElementById("output").removeChild(this.shadowRoot.getElementById("output").firstChild);this.renderer=null}this.renderer=new class extends e{static get SYMBOLS(){var r=t();return null!==r&&"null"!==r&&r?fetch(r).then(e=>e.text()):e.SYMBOLS}}(this.shadowRoot.getElementById("output"),this.LayoutEngine)}},Qi=function(){if(this.shadowRoot){this.LayoutEngine.LINKS=!!this.hasAttribute("links"),this.renderer.rotate=this.hasAttribute("horizontal"),this.renderer.leftToRight=!1,Bi.call(this),wi.info("Wiring canvas events"),Fi.call(this),ji.call(this),wi.info("Wired canvas events");var e=new(0,this.SugarClass);this.renderer.addSugar(e),(this.sequence||""==this.sequence&&this.renderer.sugars[0].sequence!=this.sequence)&&(Ni.call(this),this._redraw_sugar(),e.repeats.length>0&&pi(e),Di.call(this))}},Ji=function(e){var t=e.map(e=>e.textContent).join("");(t=t.replace(/^\s+/,"").replace(/\s+$/,""))!==this.sequence&&(this[_i]=t),(this.sequence||""==this.sequence)&&Ni.call(this),this._redraw_sugar()};window.ShadyCSS&&ShadyCSS.prepareTemplate(Ci,"ccg-sviewer");var ea=new Map(Object.entries({svg:bt.a,canvas:wt.a})),ta=function(){var e=Object.assign({},this.renderer.constructor.DEFAULT_PADDING||{top:0,side:0}),t=window.getComputedStyle(this).getPropertyValue("--sugar-padding-side"),r=window.getComputedStyle(this).getPropertyValue("--sugar-padding-top");return t&&void 0!==t&&(e.side=parseFloat(t)),r&&void 0!==r&&(e.top=parseFloat(r)),this.renderer.scaleToFit(e)},ra=new WeakMap;class na extends Ai{static get observedAttributes(){return["links","horizontal","linkangles","sugars","renderer"]}static get RegisteredRenderers(){return ea}get SugarClass(){return function(e,t){return e.get(mi(e,t))}(ra,this)}set SugarClass(e){!function(e,t,r){e.set(mi(e,t),r)}(ra,this,e)}constructor(){super(),vi(this,ra,xi),this[Oi]=[],wi("Initiating Sviewer element")}fullRefresh(){return this._redraw_sugar()}_redraw_sugar(){return Hi.call(this)}scaleToFit(){if(!("requestAnimationFrame"in window))return ta.call(this);this[Mi]&&window.cancelAnimationFrame(this[Mi]),this[Mi]=window.requestAnimationFrame(()=>{ta.call(this)})}toDataURL(){var e=arguments,t=this;return bi((function*(){var r=e.length>0&&void 0!==e[0]?e[0]:"image/svg";return"image/svg"==r&&(r="svg"),"image/png"==r&&(r="png"),yield Yn(t,t.renderer.element.canvas,r)}))()}save(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"svg";Zn(this,this.renderer.element.canvas,e,this.sequence)}get LayoutEngine(){if(this.renderer instanceof wt.a)return this.hasAttribute("linkangles")?or:ar;var e,t,r=this.hasAttribute("linkangles")?or:ar;return e=this,t=r,Li.has(t)||Li.set(t,new WeakMap),Li.get(t).has(e)||Li.get(t).set(e,class extends t{}),Li.get(t).get(e)}attributeChangedCallback(e){var t=this;return bi((function*(){if("renderer"===e){if(!t.shadowRoot)return;return $i.call(t),yield t.renderer.constructor.SYMBOLS,void Qi.call(t)}if("links"===e&&(t.hasAttribute("links")?t.LayoutEngine.LINKS=!0:t.LayoutEngine.LINKS=!1,t.renderer&&(t.renderer.refresh(),t.scaleToFit())),"sugars"===e&&t.hasAttribute("sugars")&&t.style.setProperty("--sugars-url",t.getAttribute("sugars")),"horizontal"===e){if(!t.renderer)return;t.hasAttribute("horizontal")?t.renderer.rotate=!0:t.renderer.rotate=!1,Bi.call(t),t.renderer.refresh(),setTimeout(()=>t.scaleToFit(),500)}"linkangles"===e&&(t.LayoutEngine.LINKS=t.renderer.LayoutEngine.LINKS,t.renderer.LayoutEngine=t.LayoutEngine,t.renderer.refresh(),t.scaleToFit())}))()}connectedCallback(){var e=this;return bi((function*(){window.ShadyCSS&&ShadyCSS.styleElement(e);var t=e.attachShadow({mode:"open"}),r=Ci.content.cloneNode(!0);if(!e.hasAttribute("editable")){var n=r.getRootNode().querySelector(".pie_parent");n.parentNode.removeChild(n)}t.appendChild(r),e.form=e.shadowRoot.getElementById("new_linkage"),e.form&&(e.form.style.display="none");var i=e.shadowRoot.getElementById("textcontent");i.assignedNodes({flatten:!0})[0]&&(e[_i]=i.assignedNodes({flatten:!0})[0].textContent),i.addEventListener("slotchange",()=>{var t=i.assignedNodes({flatten:!0}).filter(e=>e.nodeType===Node.TEXT_NODE),r=Ji.bind(e,t);for(var n of t)n.addEventListener("DOMCharacterDataModified",r,!1);Ji.call(e,t)}),e.hasAttribute("sugars")&&e.style.setProperty("--sugars-url",e.getAttribute("sugars")),$i.call(e),yield e.renderer.constructor.SYMBOLS,e.palette_ready_promise=Ui(e,e.shadowRoot.getElementById("palette")).then(()=>{Qi.call(e),Ki.call(e)}),setTimeout(()=>{e.shadowRoot.querySelector("#palette").classList.remove("expanded")},1e3);var a=new li(e,"selection");a.setStates({angle:0,opacity:0},{angle:2*Math.PI,opacity:.3}),a.duration=450,a.draw=(t,r,n)=>{var{angle:i,opacity:a}=t,{x:o,y:s,width:l,height:c,zoom:h}=r;n.beginPath(),n.lineWidth=parseFloat((10/Math.max(h,1)).toFixed(2)),n.strokeStyle=a>=.3?window.getComputedStyle(e).getPropertyValue("--selection-color"):"rgba(0,0,0,".concat(a.toFixed(2),")"),n.arc(o+.5*l,s+.5*c,1.5*l/2,-.5*Math.PI,i-.5*Math.PI,!1),n.stroke()},e[Si]=a}))()}get donors(){return Object.freeze([].concat(this[ki]))}setDonors(e){return Ui(this,this.shadowRoot.getElementById("palette"),[].concat(e))}set donors(e){this.setDonors(e)}set sequence(e){if(this.sequence!==e){var t=this.shadowRoot.getElementById("textcontent");t.assignedNodes({flatten:!0}).filter(e=>e.nodeType===Node.TEXT_NODE)[0].textContent=e,t.dispatchEvent(new Event("slotchange")),pi(this.renderer.sugars[0]),Di.call(this);var r=new Event("change",{bubbles:!0});this.dispatchEvent(r)}return e}get sequence(){return this[_i]}get repeats(){return this[Oi]}extendSugar(e,t,r,n){return Xi.call(this,e,t,r,n)}highlightResidues(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this[Si].highlight(e)}}customElements.define("ccg-sviewer-lite",na);var ia=na,aa=function(){this.form&&(new Gn(this),new qn(this.form))},oa=new Map(Object.entries({svg:bt.a,canvas:wt.a,sketch:gn}));class sa extends ia{static get RegisteredRenderers(){return oa}connectedCallback(){super.connectedCallback(),new Fn(this),aa.call(this),this.form.style.display="block"}}customElements.define("ccg-sviewer",sa);var la=sa;function ca(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function ha(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){ca(a,n,i,o,s,"next",e)}function s(e){ca(a,n,i,o,s,"throw",e)}o(void 0)}))}}var da=n.IO;class ua extends(da(xe)){}var fa=vn("sviewer:builder");function pa(){return Reflect.construct(HTMLElement,[],Object.getPrototypeOf(this).constructor)}Object.setPrototypeOf(pa.prototype,HTMLElement.prototype),Object.setPrototypeOf(pa,HTMLElement);var ga=Symbol("donor_map");customElements.define("ccg-builder",class extends la{extendSugar(e,t,r,n){return ba.call(this,e,t,r,n)}});var va=document.createElement("template");va.innerHTML='\n<style>\n  :host {\n    --demoted-opacity: 0.8;\n  }\n  :host {\n    display: block;\n    position: relative;\n  }\n\n  :host ccg-builder {\n    width: 100%;\n    height: 100%;\n  }\n\n  :host .widget_contents {\n    width: 100%;\n    height: 100%;\n    position: relative;\n  }\n</style>\n<div class="widget_contents" >\n  <ccg-builder editable resizable links id="viewer"><slot></slot></ccg-builder>\n</div>\n';var ma=function(e,t){return this.hasAttribute("strict")?function(e,t){if(t)for(var r of e)r.removeAttribute("data-weight"),t.indexOf(r.value)>=0?r.removeAttribute("disabled"):r.setAttribute("disabled","");else for(var n of e)n.removeAttribute("disabled")}(e,t):function(e,t,r){if(r)for(var n of t)n.removeAttribute("disabled"),r.indexOf(n.value)>=0?n.setAttribute("data-weight",e):n.setAttribute("data-weight","-1");else for(var i of t)i.removeAttribute("data-weight")}(4,e,t)},ya=function(){var e=ha((function*(e){var t=e.reactions.filter(e=>2==e.delta.composition().length).map(e=>[].concat(e.delta.composition()).reverse().shift().identifier).filter((e,t,r)=>r.indexOf(e)===t),r=this.shadowRoot.getElementById("viewer"),n=r.donors.concat(t.filter(e=>r.donors.indexOf(e)<0)),i=e.reactions.filter(e=>e.delta.composition().length>2||"Root"!==e.delta.root.identifier),a=new Map;for(var o of i)for(var s of o.positive){var l=s.delta.sequence.replace(/\([abu]\d+-\d+\)$/,"");if("Root"!==s.delta.root.identifier){var c=s.delta.root.children[0];if(!c)continue;l=c.toSugar(s.delta.constructor).sequence}a.has(l)||a.set(l,new Map),a.get(l).set(s.delta.sequence,s),n.push(l)}r[ga]=a;var h=n.filter((e,t,r)=>r.indexOf(e)===t);return r.setDonors(h)}));return function(t){return e.apply(this,arguments)}}();function ba(e,t,r,n){var i=new xi;i.sequence=t;var a=i.root;a.anomer=r,a.parent_linkage=t.match(/Neu(Gc|Ac)/)?2:1;var o="".concat(i.sequence,"(").concat(a.anomer).concat(a.parent_linkage,"-").concat((e=>{var t=parseInt(e);if(t<0){if(t===c.b.LINKAGES.O)return"O";if(t===c.b.LINKAGES.N)return"N"}return t<=0?"?":""+e})(n),")"),s="".concat(e.identifier,'(u?-?)*+"{').concat(o,'@y2a}"'),l=new ua;l.sequence=s;var d=this[ga];if(d.has(t)){var u=d.get(t);for(var f of u.values()){var p=f.delta.root.children[0],g=f.delta.root.linkageOf(p);p.anomer==r&&g==n&&(l=f)}}var v=e.renderer;return e instanceof h.a.Monosaccharide&&e.repeat.mode===h.a.MODE_MINIMAL?((!e.endsRepeat||e.repeat.root.identifier!==a.identifier)&&["Fuc","HSO3"].indexOf(a.identifier)>=0&&l.execute(v.sugars[0],e),[...i.composition()]):l.execute(v.sugars[0],e)}var wa=function(e,t){if(t.renderer.sugars.length<1)ma.call(e,[...t.form.querySelectorAll('input[name="donor"]')]);else{var r=t.renderer.sugars[0].clone();r.freeze(),t.available.highlight();var n=e.reactiongroup.supportsLinkageAt(r);t.form.querySelector('input[name="donor"]')&&ma.call(e,Array.from(t.form.querySelectorAll('input[name="donor"]')).filter(e=>"delete"!==e.value),n.donor),ma.call(e,[...t.form.querySelectorAll('input[name="anomer"]')]),ma.call(e,[...t.form.querySelectorAll('input[name="linkage"]')])}},xa=function(e){var t=this,r=!1;e.form.addEventListener("change",(function(){e.available.highlight();var n=t.reactiongroup,i=(this.querySelector('input[name="donor"]:checked')||{}).value?this.querySelector('input[name="donor"]:checked').value:void 0,a=(this.querySelector('input[name="linkage"]:checked')||{}).value?parseInt(this.querySelector('input[name="linkage"]:checked').value):void 0,o=this.residue?this.residue:void 0,s=e.renderer.sugars[0].clone();s.freeze(),o&&(o=s.locate_monosaccharide(e.renderer.sugars[0].location_for_monosaccharide(o)));var l=n.supportsLinkageAt(s,i,a,o);if(l.substrate&&e.available.highlight(l.substrate.map(e=>s.location_for_monosaccharide(e)).map(t=>e.renderer.sugars[0].locate_monosaccharide(t))),l.anomerlinks&&(this.querySelector('input[name="anomer"]:checked')||{}).value){var c=[...this.residue.child_linkages.keys()],h=(this.querySelector('input[name="anomer"]:checked')||{}).value;l.linkage=l.anomerlinks.filter(e=>e.match(h)).map(e=>parseInt(e.substr(1))).filter(e=>c.indexOf(e)<0)}ma.call(t,[...e.form.querySelectorAll('input[name="anomer"]')],l.anomer),ma.call(t,[...e.form.querySelectorAll('input[name="linkage"]')],l.linkage.map(e=>""+e)),r=!0})),e.form.addEventListener("reset",(function(){e.available.highlight(),r&&(window.cancelAnimationFrame(wa.timeout),wa.timeout=window.requestAnimationFrame(wa.bind(null,t,e)),r=!1)}))};window.ShadyCSS&&ShadyCSS.prepareTemplate(va,"ccg-sugarbuilder");class _a extends pa{static get observedAttributes(){return["resizable","links","horizontal","strict","linkangles","renderer"]}constructor(){super(),fa("Initiating SugarBuilder element")}connectedCallback(){window.ShadyCSS&&ShadyCSS.styleElement(this);var e=this.attachShadow({mode:"open"}),t=va.content.cloneNode(!0);t.querySelector("ccg-builder").setAttribute("sugars",this.getAttribute("sugars")),e.appendChild(t),xa.call(this,e.getElementById("viewer")),this.attributeChangedCallback("horizontal"),this.attributeChangedCallback("resizeable"),this.attributeChangedCallback("linkangles"),this.attributeChangedCallback("links"),this.attributeChangedCallback("sugars"),this.hasAttribute("reactions-src")&&fetch(this.getAttribute("reactions-src")||"reactions.json").then(e=>e.json()).then(e=>this.reactions=e).then(()=>wa(this,this.shadowRoot.getElementById("viewer"))),this.reactiongroup=ae.groupFromJSON({},xi),this.reactiongroup&&ya.call(this,this.reactiongroup).then(()=>{this.shadowRoot.getElementById("viewer").palette_ready_promise&&this.shadowRoot.getElementById("viewer").palette_ready_promise.then(()=>{wa(this,this.shadowRoot.getElementById("viewer"))})});var r=new li(e.getElementById("viewer"),"available");r.setStates({opacity:0},{opacity:1}),r.duration=10,r.draw=(e,t,r)=>{var{angle:n,opacity:i}=e,{x:a,y:o,width:s,height:l,zoom:c}=t;r.beginPath(),r.setLineDash([5,5]),r.lineWidth=parseFloat((2/Math.max(c,1)).toFixed(2)),r.strokeStyle="rgba(0,0,0,0.5)",r.arc(a+.5*s,o+.5*l,1.2*s/2,-.5*Math.PI,2*Math.PI,!1),r.stroke()},e.getElementById("viewer").available=r,e.getElementById("viewer").addEventListener("change",e=>{var t=new Event("change",{bubbles:!0});this.dispatchEvent(t)})}attributeChangedCallback(e){this.shadowRoot&&(["links","horizontal","resizeable","linkangles"].indexOf(e)>=0&&(this.hasAttribute(e)?this.shadowRoot.getElementById("viewer").setAttribute(e,""):this.shadowRoot.getElementById("viewer").removeAttribute(e)),"linkangles"===e&&this.attributeChangedCallback("links"),"renderer"===e&&(this.hasAttribute(e)?this.shadowRoot.getElementById("viewer").setAttribute(e,this.getAttribute(e)):this.shadowRoot.getElementById("viewer").removeAttribute(e)),"strict"===e&&wa(this,this.shadowRoot.getElementById("viewer")))}savePNG(){this.shadowRoot.getElementById("viewer").save("png")}saveSVG(){this.shadowRoot.getElementById("viewer").save("svg")}toDataURL(e){var t=this;return ha((function*(){return t.shadowRoot.getElementById("viewer").toDataURL(e)}))()}set sequence(e){this.shadowRoot.getElementById("viewer").sequence=e,setTimeout(()=>wa(this,this.shadowRoot.getElementById("viewer")),10)}get sequence(){return this.shadowRoot.getElementById("viewer").sequence}get textContent(){return this.sequence}get sugar(){return this.shadowRoot.getElementById("viewer").renderer.sugars[0]}get repeats(){return this.shadowRoot.getElementById("viewer").repeats}set reactions(e){this.reactiongroup=ae.groupFromJSON(e,xi),ya.call(this,this.reactiongroup).then(()=>{wa(this,this.shadowRoot.getElementById("viewer"))})}get reactions(){return this.reactiongroup}}customElements.define("ccg-sugarbuilder",_a);var ka=_a,Oa=vn("sviewer:sugarframe"),Sa=(0,n.IO)(B);function Ma(){return Reflect.construct(HTMLElement,[],Object.getPrototypeOf(this).constructor)}(new Sa).sequence="Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc(b1-N)Asn",Object.setPrototypeOf(Ma.prototype,HTMLElement.prototype),Object.setPrototypeOf(Ma,HTMLElement);var Ca=Symbol("highlight"),Ea=document.createElement("template");Ea.innerHTML='\n<style>\n  :host {\n    display: block;\n    position: relative;\n    --highlight-stroke: #000;\n    --highlight-stroke-opacity: 1;\n    --highlight-fill-opacity: 1;\n    --highlight-fill: #fff;\n  }\n\n  :host div#styles {\n    display: none;\n  }\n\n\n  #styles {\n    display: none;\n  }\n  #targetsvg {\n    width: 100%;\n    height: 100%;\n  }\n  #output {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    margin: auto;\n    height: 100%;\n    width: 100%;\n  }\n</style>\n\n<div id="styles">\n<slot></slot>\n</div>\n<div id="output">\n</div>\n';var Aa=document.createElement("template");Aa.innerHTML='<object id="targetsvg" type="image/svg+xml"></object>';var Ta=(e,t)=>{var r=(e=>{e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,r,n){return t+t+r+r+n+n}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null})(e.replace(/^\s+/,""));return"0 0 0 0 ".concat((r.r/255).toFixed(1)," 0 0 0 0 ").concat((r.g/255).toFixed(1)," 0 0 0 0 ").concat((r.b/255).toFixed(1)," 0 0 0 ").concat(t," 0")},La=function(){var e=this[Ca],t=window.getComputedStyle(this),r=t.getPropertyValue("--highlight-stroke"),n=t.getPropertyValue("--highlight-fill"),i=t.getPropertyValue("--highlight-stroke-opacity"),a=t.getPropertyValue("--highlight-fill-opacity");e.querySelector('feColorMatrix[result="outeroutline"]').setAttribute("values",Ta(r,i)),e.querySelector('feColorMatrix[result="feather_back"]').setAttribute("values",Ta(n,a))},Pa=function(e){var t=e.createElementNS("http://www.w3.org/2000/svg","filter");t.innerHTML='\n  <feColorMatrix mode="matrix" in="SourceGraphic" values="0 0 0 0 0\n                                                          0 0 0 0 0\n                                                          0 0 0 0 0\n                                                          0 0 0 1 0" result="blacksource"/>\n  <feGaussianBlur in="blacksource" stdDeviation="10" result="blur" />\n  <feColorMatrix mode="matrix" in="blur" values="0 0 0 0 0\n                                                 0 0 0 0 0\n                                                 0 0 0 0 0\n                                                 0 0 0 30 -3" result="contrastup"/>\n  <feMorphology operator="dilate" in="contrastup" radius="3"/>\n  <feColorMatrix mode="matrix"           values="0 0 0 0 1\n                                                 0 0 0 0 1\n                                                 0 0 0 0 1\n                                                 0 0 0 0.3 0" result="feather_back"/>\n  <feMorphology operator="dilate" in="feather_back" radius="5"/>\n  <feColorMatrix mode="matrix" values="0 0 0 0 0.1\n                                       0 0 0 0 0.1\n                                       0 0 0 0 0.1\n                                       0 0 0 1 0" result="outeroutline"/>\n  <feComposite in2="outeroutline" in="feather_back" result="outline"/>\n  <feComposite in2="outline" in="SourceGraphic"/>\n',t.setAttribute("id","highlight"),t.setAttribute("filterUnits","objectBoundingBox"),t.setAttribute("y","-40%"),t.setAttribute("x","-40%"),t.setAttribute("width","180%"),t.setAttribute("height","180%"),this[Ca]=t,e.documentElement.appendChild(t);var r=e.createElementNS("http://www.w3.org/2000/svg","filter");r.innerHTML='\n   <feOffset in="SourceAlpha" dx="0" dy="0" result="offset" />\n  <feFlood flood-color="rgba(255,255,255,0.3)" result="white"/>\n  <feComposite in2="offset" in="white" operator="in" result="matrix"/>\n<feGaussianBlur in="matrix" stdDeviation="4" result="blur"/>\n<feComposite in2="SourceGraphic" in="blur" operator="over"/>\n<feComposite in2="SourceGraphic" operator="in"/>\n',r.setAttribute("id","sugar_glow"),e.documentElement.appendChild(r),La.call(this)},qa=function(){var e=this.shadowRoot.querySelector("object").contentDocument,t=e.createElementNS("http://www.w3.org/2000/svg","style");t.textContent=this.shadowRoot.querySelector("slot").assignedNodes().map(e=>e.textContent).join("\n"),e.documentElement.appendChild(t),Pa.call(this,e)},Ra=function(e){e.addEventListener("load",()=>{if("SVG"===e.contentDocument.documentElement.tagName.toUpperCase()){var[,,t,r]=(e.contentDocument.documentElement.getAttribute("viewBox")||"").split(" ");for(var n of(t&&r&&(this.style.aspectRatio="".concat(t," / ").concat(r),parseFloat(t)/parseFloat(r)>1?this.setAttribute("aspect","landscape"):this.setAttribute("aspect","portrait")),qa.call(this),this.renderer=bt.a.fromSVGElement(e.contentDocument.documentElement,this.constructor.SugarClass),this.renderer.sugars))n.freeze();this.tagSupported(),this.dispatchEvent(new CustomEvent("load",{bubbles:!0}))}else this.dispatchEvent(new CustomEvent("error",{bubbles:!0}))})},Ia=function(){var e=this.shadowRoot.getElementById("targetsvg");e&&e.parentNode.removeChild(e),this.shadowRoot.querySelector("#output").appendChild(Aa.content.cloneNode(!0)),e=this.shadowRoot.getElementById("targetsvg"),Ra.call(this,e),e.setAttribute("data",this.getAttribute("src"))};class Na extends Ma{static get SugarClass(){return Sa}static get observedAttributes(){return["src"]}constructor(){super(),window.ShadyCSS&&ShadyCSS.prepareTemplate(Ea,this.tagName.toLowerCase()),Oa("Initiating SugarFrame element")}connectedCallback(){window.ShadyCSS&&ShadyCSS.styleElement(this),this.attachShadow({mode:"open"}).appendChild(Ea.content.cloneNode(!0)),Ia.call(this)}attributeChangedCallback(e){this.shadowRoot&&([].indexOf(e)>=0&&(this.hasAttribute(e)?this.shadowRoot.getElementById("viewer").setAttribute(e,""):this.shadowRoot.getElementById("viewer").removeAttribute(e)),"src"===e&&Ia.call(this))}save(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"svg";Zn(this,this.renderer.element.canvas,e)}tagSupported(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Symbol("supported"),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.reactions&&(this.renderer.groupTag=e,this.renderer.sugars.forEach(r=>{for(var n of(this.reactions.supportLinkages(r,this.reactions.reactions,e,t),r.root.setTag(e),r.breadth_first_traversal()))n.parent&&(n.parent.getTag(e)||n.setTag(e,null))}),this.renderer.refresh())}set reactions(e){e&&(this.reactiongroup=ae.groupFromJSON(e,Sa),this.renderer&&this.tagSupported())}get reactions(){return this.reactiongroup}}customElements.define("ccg-sugarframe",Na);var Ha=Na;function Fa(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}var ja,Da=new Map,Ba=new Map;class za{constructor(){this.lock=new Promise(e=>{this.done=e})}nextTick(){return new Promise(e=>{requestAnimationFrame(e)})}}class Ga extends ia{_redraw_sugar(){var e,t=()=>super._redraw_sugar,r=this;return(e=function*(){if(""!=r.sequence&&r.renderer){if(yield r.renderer.ready,!ja||!ja.active){if((ja=new za).active=!0,Da.has(r.sequence)&&Ba.get(r.sequence)>1)return ja.done(),ja.active=!1,r.shadowRoot.getElementById("output").innerHTML="<img/>",void r.shadowRoot.getElementById("output").firstChild.setAttribute("src",Da.get(r.sequence));yield t().call(r),yield ja.nextTick();var e=yield r.toDataURL("image/png");return Da.set(r.sequence,e),Ba.set(r.sequence,(Ba.get(r.sequence)||0)+1),ja.done(),void(ja.active=!1)}setTimeout(()=>{r._redraw_sugar()},0)}},function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){Fa(a,n,i,o,s,"next",e)}function s(e){Fa(a,n,i,o,s,"throw",e)}o(void 0)}))})()}}customElements.define("ccg-sviewer-cache",Ga);function Wa(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function Va(e,t,r){return e.set(Xa(e,t),r),r}function Ua(e,t){return e.get(Xa(e,t))}function Xa(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var Ya=vn("sviewer:sugarselect"),Za=xi;function Ka(){return Reflect.construct(HTMLElement,[],Object.getPrototypeOf(this).constructor)}(new Za).sequence="Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc(b1-N)Asn",Object.setPrototypeOf(Ka.prototype,HTMLElement.prototype),Object.setPrototypeOf(Ka,HTMLElement);var $a=document.createElement("template");$a.innerHTML='\n<style>\n  :host {\n    display: block;\n    min-width: calc(22em + 30px);\n    min-height: calc(15em + 30px);\n    --max-select-display: -1;\n    --drop-shadow-color: rgba(90, 90, 90, 0.6);\n    --drop-shadow-offset: 2px;\n    --drop-shadow-size: 2px;\n  }\n\n  :host, :host * {\n    user-select: none;\n    -webkit-user-select: none; /* Safari */\n    -moz-user-select: none;    /* Firefox */\n    -ms-user-select: none;     /* IE 10+ */\n  }\n\n  #output {\n    display: flex;\n    flex-direction: row;\n    top: 0px;\n    left: 0px;\n    width: 100%;\n    height: 100%;\n    min-height: 10em;\n    gap: 5px;\n  }\n  #builder {\n    display: block;\n    width: 50%;\n    height: 100%;\n    flex: 1 0 20em;\n  }\n\n  #options {\n    pointer-events: none;\n  }\n\n  #options label {\n    pointer-events: auto;\n    box-shadow: var(--drop-shadow-offset) var(--drop-shadow-offset) var(--drop-shadow-size) var(--drop-shadow-color);\n  }\n\n  #options label:first-child {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    font-family: Helvetica, Arial, sans-serif;\n  }\n\n  #options label:first-child:hover {\n    color: white;\n  }\n\n  #options label:not(:has(ccg-sviewer-lite)) {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    font-family: Helvetica, Arial, sans-serif;\n  }\n\n  #options label:not(:has(ccg-sviewer-lite)):hover {\n    color: white;\n  }\n\n  #options label[disabled] {\n    display: none;\n  }\n  #options label[checked] {\n    background: var(--selection-color);\n  }\n  #options {\n    margin-top: 10px;\n    display: flex;\n    flex-direction: row;\n    flex-wrap: wrap;\n    align-content: flex-start;\n    max-width: calc(50% - 20px);\n    max-height: calc(100% - 20px);\n    gap: 10px;\n    overflow-y: auto;\n    overflow-x: hidden;\n    background: var(--palette-background-color,#eee);\n    padding: 5px;\n  }\n\n  #options label:hover {\n    background: var(--selection-color);\n  }\n  #options label {\n    cursor: pointer;\n  }\n\n  #options label[hide], #options label[disabled] {\n    display: none;\n  }\n  #options label {\n    aspect-ratio: 1 / 1;\n    flex: 1 1 min(calc(33.33% - 10px),10em);\n    max-width: min(calc(33.33% - 20px),4em);\n    max-height: min(calc(33.33% - 20px),4em);\n    min-width: 3em;\n    min-height: 3em;\n    border-radius: 10px;\n    border: solid 1px var(--main-border-color);\n    background: rgba(255,255,255,0.8);\n    color: black;\n  }\n  #options label input {\n    position: fixed;\n    opacity: 0;\n    pointer-events: none;\n  }\n  #options ccg-sviewer-lite {\n    width: 100%;\n    height: 100%;\n    position: relative;\n  }\n  ::part(donor-disabled) {\n    display: none;\n  }\n</style>\n\n<div id="output">\n  <ccg-sugarbuilder exportparts="donor-button, donor-disabled" strict id="builder"> </ccg-sugarbuilder>\n  <slot id="glycanoptions"> </slot>\n  <form id="options">\n    <label><input type="radio" name="glycan" value=""/>Clear</label>\n  </form>\n</div>\n';var Qa=document.createElement("template");Qa.innerHTML='\n<label><input type="radio" name="glycan" value=""/><ccg-sviewer-lite links renderer="png"></ccg-sviewer-lite></label>\n',document.createElement("template").innerHTML="\n<button>None</button>\n";var Ja={},eo={},to=function(e,t){console.time("sequences_to_reactions");var r=[],n={},i=[];for(var a of e){var o=[];if(Ja[a])o=Ja[a],eo[a]&&i.indexOf(eo[a])<0&&i.push(eo[a]);else{var s=new t;for(var l of(s.sequence=a,s.composition()))if(l!=s.root){var c=s.location_for_monosaccharide(l),h=s.clone(),d=h.locate_monosaccharide(c),u=h.paths(h.root,d).flat();for(var f of h.composition())if(f.parent&&!(u.indexOf(f)>=0)){var p=f.parent,g=p.linkageOf(f);p.removeChild(g,f)}var v=d.parent,m=v.linkageOf(d),y=d.parent_linkage,b=d.anomer,w=h.location_for_monosaccharide(v);v.removeChild(m,d);var x="".concat(h.sequence,'+"{').concat(d.identifier,"(").concat(b).concat(y,"-").concat(m,")}@").concat(w,'"');o.indexOf(x)<0&&o.push(x)}else i.indexOf(l.identifier)<0&&(i.push(l.identifier),eo[a]=l.identifier,l.children.length<1&&e.splice(e.indexOf(a),1));Ja[a]=o}for(var _ of o)n[_]||(r.push([_]),n[_]=1)}var k={ALL:{reactions:r}};return console.timeEnd("sequences_to_reactions"),{reactions:k,new_roots:i}},ro=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;console.time("accept_options");var n=e.assignedNodes({flatten:!0}).filter(e=>e.nodeType===Node.ELEMENT_NODE);if(!(n.length>0&&n[0].accepted)){n.length>0&&(n[0].accepted=!0);var i=t.firstElementChild,a=[i];for(var o of n){var s=Qa.content.cloneNode(!0);s.firstElementChild.querySelector("ccg-sviewer-lite").SugarClass=this.SugarClass,s.firstElementChild.querySelector("ccg-sviewer-lite").textContent=o.textContent,s.firstElementChild.querySelector("input").setAttribute("value",o.textContent),s.firstElementChild.querySelector("input").addEventListener("change",e=>{for(var r of t.querySelectorAll("label[checked]"))r.removeAttribute("checked");e.target.checked&&e.target.parentNode.setAttribute("checked","")}),a.push(s)}var l=[...n].map(e=>e.textContent),{reactions:c,new_roots:h}=to(l,this.SugarClass);for(var d of h)l.splice(0,0,d);return l=l.filter((e,t,r)=>r.indexOf(e)==t),t.replaceChildren(...a.slice(0,r)),this.options=l,console.timeEnd("accept_options"),c}},no=function(){this.shadowRoot.getElementById("options").addEventListener("change",()=>{if(""!=this.shadowRoot.getElementById("options").glycan.value){this.value=this.shadowRoot.getElementById("options").glycan.value;var e=new Event("change",{bubbles:!0});this.dispatchEvent(e)}else{this.reset();var t=new Event("change",{bubbles:!0});this.dispatchEvent(t)}}),this.shadowRoot.getElementById("builder").addEventListener("change",()=>{var e=this.shadowRoot.querySelector("#builder").sequence;if(this.value!==e&&(this.options.indexOf(e)>=0||""==e)){this.value=e;var t=new Event("change",{bubbles:!0});this.dispatchEvent(t)}this.updateDisabled(e)})},io=new WeakMap,ao=new WeakMap;class oo extends Ka{static get observedAttributes(){return[]}static processSequences(e,t){to(e,t)}constructor(){super(),Wa(this,io,Za),Wa(this,ao,[]),Ya("Initiating SugarSelect element")}connectedCallback(){var e=this.attachShadow({mode:"open"});e.appendChild($a.content.cloneNode(!0)),e.getElementById("builder").reactions={},this.SugarClass=this.SugarClass;var t=this.shadowRoot.getElementById("glycanoptions"),r=t.assignedNodes({flatten:!0}).filter(e=>e.nodeType===Node.ELEMENT_NODE);for(var n of(r.length>0&&this.refreshOptions(),t.addEventListener("slotchange",()=>{this.refreshOptions()}),no.call(this),["links","linkangles"]))this.attributeChangedCallback(n)}refreshOptions(){var e=this.shadowRoot.getElementById("glycanoptions"),t=parseInt(window.getComputedStyle(this).getPropertyValue("--max-select-display")),r=ro.call(this,e,this.shadowRoot.getElementById("options"),t);r&&(this.shadowRoot.getElementById("builder").reactions=r,this.updateDisabled(this.value))}get options(){return Ua(ao,this)}set options(e){Va(ao,this,e)}get value(){return this.shadowRoot.querySelector("#options").glycan.value}set value(e){this.options.indexOf(e)<0||(this.shadowRoot.querySelector("#builder").sequence=e,this.shadowRoot.querySelector("#options").glycan.value=e,this.updateDisabled(e))}get SugarClass(){return Ua(io,this)}set SugarClass(e){Va(io,this,e),this.shadowRoot&&(this.shadowRoot.querySelector("#builder").shadowRoot.querySelector("#viewer").SugarClass=e)}reset(){this.shadowRoot.querySelector("#builder").sequence=""}updateDisabled(e){var t=0;console.time("updateDisabled");var r=[...this.shadowRoot.querySelectorAll("label")].filter(e=>"radio"==e.firstElementChild.getAttribute("type")&&e.querySelector("ccg-sviewer-lite")),n=parseInt(window.getComputedStyle(this).getPropertyValue("--max-select-display"));for(var i of(n<0&&(n=r.length),this.options))if(i){var a=this.SugarClass,o=new a;o.sequence=i;var s=e,l=new a;l.sequence=s;var c=o.match_sugar_pattern(l,J),h=""!=s&&c.length<1,d=[...o.composition()].length>1;if(!h||!d){var u=r[t];if(u.removeAttribute("checked"),u.querySelector("input").value=i,u.querySelector("ccg-sviewer-lite").textContent=i,u.querySelector("ccg-sviewer-lite").fullRefresh(),t+=1,l.sequence==o.sequence&&(u.querySelector("input").click(),u.setAttribute("checked","")),u.removeAttribute("disabled"),t+1==n)return}}for(;t+1<n;)r[t].removeAttribute("checked"),r[t].setAttribute("disabled","true"),t+=1;console.timeEnd("updateDisabled")}attributeChangedCallback(e){this.shadowRoot&&["links","linkangles"].indexOf(e)>=0&&(this.hasAttribute(e)?this.shadowRoot.getElementById("builder").setAttribute(e,""):this.shadowRoot.getElementById("builder").removeAttribute(e))}}customElements.define("ccg-sugarselect",oo);var so=oo;window.Glycan=i,window.SViewer=a,window.SugarBuilder=o,window.SugarFrame=s,window.SugarSelect=l}]);